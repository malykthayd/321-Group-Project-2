<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Accessible Quality Education (AQE)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .btn {
            @apply px-4 py-2 rounded-lg font-medium transition-all duration-300 focus:outline-none focus:ring-2 focus:ring-offset-2;
            position: relative;
            overflow: hidden;
        }
        
        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-primary {
            @apply text-white focus:ring-blue-500;
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        
        .btn-primary:hover {
            background: linear-gradient(135deg, #2563eb 0%, #1e40af 100%);
            box-shadow: 0 6px 20px rgba(59, 130, 246, 0.4);
            transform: translateY(-1px);
        }
        
        .btn-secondary {
            @apply text-gray-900 focus:ring-gray-500;
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .btn-secondary:hover {
            background: linear-gradient(135deg, #e5e7eb 0%, #d1d5db 100%);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            transform: translateY(-1px);
        }
        .card {
            @apply bg-white rounded-xl shadow-lg border border-gray-200 p-6;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08), 0 1px 3px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }
        
        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #06b6d4);
            border-radius: 12px 12px 0 0;
        }
        
        .card:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12), 0 2px 8px rgba(0, 0, 0, 0.08);
        }
        .card-header {
            @apply flex items-center justify-between mb-4;
        }
        .card-title {
            @apply text-lg font-semibold text-gray-900;
        }
        .muted {
            @apply text-sm text-gray-600;
        }
        .badge {
            @apply inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium;
        }
        .badge-primary { @apply bg-blue-100 text-blue-800; }
        .badge-secondary { @apply bg-green-100 text-green-800; }
        .badge-gray { @apply bg-gray-100 text-gray-800; }
        
        /* Enhanced Loading States */
        .skeleton {
            @apply animate-pulse bg-gray-200 rounded;
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }
        
        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }
        
        .loading-spinner {
            @apply animate-spin rounded-full border-2 border-gray-300 border-t-blue-600;
            width: 20px;
            height: 20px;
        }
        
        /* Enhanced Dark Mode */
        .dark .card { 
            @apply bg-gray-800 border-gray-700; 
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
        }
        .dark .card-title { @apply text-gray-100; }
        .dark .muted { @apply text-gray-400; }
        .dark body { @apply bg-gray-900; }
        .dark .role-card {
            background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
            border-color: #374151;
        }
        .dark .role-card:hover {
            border-color: #3b82f6;
            background: linear-gradient(135deg, #1e3a8a 0%, #1e40af 100%);
        }
        
        /* Improved Focus States */
        .btn:focus, .tab-btn:focus, .role-card:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.3);
        }
        
        /* Smooth Scrolling */
        html {
            scroll-behavior: smooth;
        }
        
        /* Enhanced Typography */
        .hero-title {
            background: linear-gradient(135deg, #ffffff 0%, #f0f9ff 50%, #e0f2fe 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        /* Enhanced Tab Navigation */
        .tab-btn {
            @apply relative px-4 py-3 rounded-lg font-medium transition-all duration-300;
            background: linear-gradient(135deg, transparent 0%, rgba(59, 130, 246, 0.05) 100%);
        }
        
        .tab-btn:hover {
            background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(59, 130, 246, 0.05) 100%);
            transform: translateY(-1px);
        }
        
        .tab-btn.active {
            background: linear-gradient(135deg, #3b82f6 0%, #1d4ed8 100%);
            color: white;
            box-shadow: 0 4px 15px rgba(59, 130, 246, 0.3);
        }
        
        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 8px solid transparent;
            border-right: 8px solid transparent;
            border-bottom: 8px solid #3b82f6;
            z-index: 10;
        }
        
        /* Animations */
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .slide-up { animation: slideUp 0.4s cubic-bezier(0.4, 0, 0.2, 1); }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        
        .bounce-in { animation: bounceIn 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55); }
        @keyframes bounceIn { from { opacity: 0; transform: scale(0.3); } to { opacity: 1; transform: scale(1); } }
        
        /* Role Selection Cards */
        .role-card {
            @apply border rounded-xl p-6 cursor-pointer transition-all duration-300 hover:shadow-lg;
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 2px solid transparent;
            position: relative;
            overflow: hidden;
        }
        
        .role-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #3b82f6, #8b5cf6, #06b6d4);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }
        
        .role-card:hover::before {
            transform: scaleX(1);
        }
        
        .role-card:hover {
            border-color: #3b82f6;
            transform: translateY(-4px);
            box-shadow: 0 10px 25px rgba(59, 130, 246, 0.15);
        }
        
        .role-card.selected {
            border-color: #3b82f6;
            background: linear-gradient(135deg, #eff6ff 0%, #dbeafe 100%);
            box-shadow: 0 8px 20px rgba(59, 130, 246, 0.2);
        }
        
        .role-card.selected::before {
            transform: scaleX(1);
        }
        
        /* Mobile Menu */
        .mobile-menu { @apply fixed inset-0 z-50 bg-white transform transition-transform duration-300; }
        .mobile-menu.hidden { @apply translate-x-full; }
        
        /* RTL Support */
        [dir="rtl"] .flex {
            flex-direction: row-reverse;
        }
        [dir="rtl"] .space-x-4 > * + * {
            margin-left: 0;
            margin-right: 1rem;
        }
        [dir="rtl"] .space-x-2 > * + * {
            margin-left: 0;
            margin-right: 0.5rem;
        }
        [dir="rtl"] .space-x-3 > * + * {
            margin-left: 0;
            margin-right: 0.75rem;
        }
        [dir="rtl"] .ml-4 {
            margin-left: 0;
            margin-right: 1rem;
        }
        [dir="rtl"] .mr-4 {
            margin-right: 0;
            margin-left: 1rem;
        }
        [dir="rtl"] .text-right {
            text-align: left;
        }
        [dir="rtl"] .text-left {
            text-align: right;
        }
        [dir="rtl"] .justify-between {
            flex-direction: row-reverse;
        }
        [dir="rtl"] .items-center {
            flex-direction: row-reverse;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen antialiased">
    <!-- Header -->
    <header class="bg-gradient-to-r from-blue-50 to-white border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center py-4">
                <div>
                    <h1 class="text-2xl font-bold text-gray-900 flex items-center space-x-2" data-translate="header" data-translate-key="welcome">
                        <span class="text-blue-600">🎓</span>
                        <span>Accessible Quality Education</span>
                    </h1>
                    <p class="text-gray-600" data-translate="header" data-translate-key="welcomeSubtitle">Welcome to your learning platform!</p>
                </div>
                <div class="flex items-center space-x-4">
                    <!-- Search -->
                    <div class="hidden md:block relative">
                        <input type="text" placeholder="Search lessons..." class="w-64 px-4 py-2 border rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500" id="searchInput" data-translate="header" data-translate-key="searchPlaceholder">
                        <svg class="absolute right-3 top-2.5 w-4 h-4 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        <!-- Search Results Dropdown -->
                        <div id="searchResults" class="absolute top-full left-0 right-0 mt-1 bg-white border border-gray-200 rounded-lg shadow-lg z-50 hidden max-h-96 overflow-y-auto">
                            <!-- Search results will be populated here -->
                        </div>
                    </div>
                    
                    <!-- Notifications -->
                    <button onclick="toggleNotifications()" class="relative p-2 text-gray-600 hover:text-gray-900">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"></path>
                        </svg>
                        <span class="absolute -top-1 -right-1 w-3 h-3 bg-red-500 rounded-full text-xs text-white flex items-center justify-center" id="notificationBadge">3</span>
                    </button>
                    
                    <!-- Language Selector -->
                    <div class="relative">
                        <select onchange="changeLanguage(this.value)" class="px-3 py-2 text-sm border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white">
                            <option value="en">🇺🇸 English</option>
                            <option value="es">🇪🇸 Español</option>
                            <option value="fr">🇫🇷 Français</option>
                            <option value="de">🇩🇪 Deutsch</option>
                            <option value="zh">🇨🇳 中文</option>
                            <option value="ar">🇸🇦 العربية</option>
                        </select>
                    </div>
                    
                    <!-- Dark Mode Toggle -->
                    <button onclick="toggleDarkMode()" class="p-2 text-gray-600 hover:text-gray-900 dark:text-gray-300 dark:hover:text-gray-100">
                        <svg class="w-5 h-5 hidden dark:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z"></path>
                        </svg>
                        <svg class="w-5 h-5 dark:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z"></path>
                        </svg>
                    </button>
                    
                    <!-- Mobile Menu Button -->
                    <button onclick="toggleMobileMenu()" class="md:hidden p-2 text-gray-600 hover:text-gray-900">
                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                        </svg>
                    </button>
                    
                    <div class="hidden md:flex items-center space-x-4">
                    <div class="text-right">
                        <p class="text-sm font-medium text-gray-900" id="userFullName" data-translate="user" data-translate-key="guest">Guest User</p>
                        <p class="text-xs text-gray-500" id="userRole" data-translate="user" data-translate-key="role">guest</p>
                    </div>
                    <button onclick="logout()" class="btn btn-secondary text-sm" data-translate="user" data-translate-key="login">
                        Login
                    </button>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="mobile-menu hidden">
        <div class="p-4">
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-lg font-semibold">Menu</h2>
                <button onclick="toggleMobileMenu()" class="p-2">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                    </svg>
                </button>
            </div>
            <nav class="space-y-2">
                <button onclick="goToTab('dashboard'); toggleMobileMenu();" class="w-full text-left p-3 rounded-lg hover:bg-gray-100" data-translate="navigation" data-translate-key="dashboard">Dashboard</button>
                <button onclick="goToTab('lessons'); toggleMobileMenu();" class="w-full text-left p-3 rounded-lg hover:bg-gray-100" data-translate="navigation" data-translate-key="lessons">Let's Get Started</button>
                <button onclick="goToTab('library'); toggleMobileMenu();" class="w-full text-left p-3 rounded-lg hover:bg-gray-100" data-translate="navigation" data-translate-key="library">Digital Library</button>
                <button onclick="goToTab('progress'); toggleMobileMenu();" class="w-full text-left p-3 rounded-lg hover:bg-gray-100" data-translate="navigation" data-translate-key="progress">Progress & Insights</button>
                <button onclick="goToTab('practice'); toggleMobileMenu();" class="w-full text-left p-3 rounded-lg hover:bg-gray-100" data-translate="navigation" data-translate-key="practice">Practice Materials</button>
                <button onclick="goToTab('admin'); toggleMobileMenu();" class="w-full text-left p-3 rounded-lg hover:bg-gray-100 admin-tab hidden" id="adminMobileTab" data-translate="navigation" data-translate-key="admin">Admin Panel</button>
            </nav>
        </div>
    </div>

    <!-- Notification Panel -->
    <div id="notificationPanel" class="fixed top-16 right-4 w-80 bg-white rounded-lg shadow-lg border z-40 hidden">
        <div class="p-4 border-b">
            <h3 class="font-semibold">Notifications</h3>
        </div>
        <div class="p-4 space-y-3">
            <div class="flex items-start space-x-3">
                <div class="w-2 h-2 bg-blue-500 rounded-full mt-2"></div>
                <div>
                    <p class="text-sm font-medium">New assignment posted</p>
                    <p class="text-xs text-gray-500">Math - Fractions Practice</p>
                </div>
            </div>
            <div class="flex items-start space-x-3">
                <div class="w-2 h-2 bg-green-500 rounded-full mt-2"></div>
                <div>
                    <p class="text-sm font-medium">Progress milestone reached</p>
                    <p class="text-xs text-gray-500">Completed 10 lessons this week!</p>
                </div>
            </div>
            <div class="flex items-start space-x-3">
                <div class="w-2 h-2 bg-yellow-500 rounded-full mt-2"></div>
                <div>
                    <p class="text-sm font-medium">Practice reminder</p>
                    <p class="text-xs text-gray-500">Science quiz due tomorrow</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Hero -->
    <section class="relative overflow-hidden bg-gradient-to-br from-blue-600 via-purple-600 to-indigo-700">
        <!-- Animated Background Elements -->
        <div class="absolute inset-0 bg-gradient-to-t from-black/20 to-transparent"></div>
        <div class="absolute top-20 left-10 w-20 h-20 bg-white/10 rounded-full blur-xl animate-pulse"></div>
        <div class="absolute top-40 right-20 w-32 h-32 bg-blue-400/20 rounded-full blur-2xl animate-pulse delay-1000"></div>
        <div class="absolute bottom-20 left-1/4 w-24 h-24 bg-purple-400/20 rounded-full blur-xl animate-pulse delay-2000"></div>
        
        <div class="relative max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
                <div class="text-white">
                    <div class="inline-flex items-center px-4 py-2 bg-white/10 backdrop-blur-sm rounded-full text-white/90 text-sm font-medium mb-6 slide-up">
                        <span class="w-2 h-2 bg-green-400 rounded-full mr-2 animate-pulse"></span>
                        Now Available in 6 Languages
                    </div>
                    <h2 class="text-3xl md:text-4xl font-bold leading-tight hero-title slide-up" data-translate="hero" data-translate-key="heroTitle">Learn better with a platform designed for every learner</h2>
                    <p class="mt-3 text-white/90 hero-subtitle slide-up" data-translate="hero" data-translate-key="heroSubtitle">Personalized lessons, a rich digital library, and insights that help you grow—online and offline.</p>
                    <div class="mt-6 flex flex-wrap gap-3 bounce-in">
                        <button onclick="goToTab('lessons')" class="btn bg-white/10 text-white border border-white/20 hover:bg-white/20 backdrop-blur-sm shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105" data-translate="hero" data-translate-key="getStarted">Get Started</button>
                        <button onclick="goToTab('library')" class="btn bg-white/10 text-white border border-white/20 hover:bg-white/20 backdrop-blur-sm shadow-xl hover:shadow-2xl transition-all duration-300 hover:scale-105" data-translate="hero" data-translate-key="learnMore">Explore Library</button>
                    </div>
                </div>
                <div class="hidden md:block">
                    <div class="rounded-xl border shadow-lg bg-white/10 backdrop-blur-sm p-6 border-white/20 slide-up">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-white/20 rounded-lg p-4 backdrop-blur-sm">
                                <p class="text-sm font-medium text-white">Adaptive Lessons</p>
                                <p class="text-xs text-white/80">Tailored to your level</p>
                            </div>
                            <div class="bg-white/20 rounded-lg p-4 backdrop-blur-sm">
                                <p class="text-sm font-medium text-white">Offline Ready</p>
                                <p class="text-xs text-white/80">Keep learning anywhere</p>
                            </div>
                            <div class="bg-white/20 rounded-lg p-4 backdrop-blur-sm">
                                <p class="text-sm font-medium text-white">Parent Insights</p>
                                <p class="text-xs text-white/80">Support and track progress</p>
                            </div>
                            <div class="bg-white/20 rounded-lg p-4 backdrop-blur-sm">
                                <p class="text-sm font-medium text-white">Achievements</p>
                                <p class="text-xs text-white/80">Stay motivated</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <!-- Stats Overview -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            <div class="card transition-all duration-300 hover:scale-105 group">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600" data-translate="stats" data-translate-key="lessons">Lessons</p>
                        <p class="text-2xl font-bold text-gray-900">0/24</p>
                    </div>
                </div>
            </div>

            <div class="card transition-all duration-300 hover:scale-105 group">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-gradient-to-br from-green-500 to-green-600 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600" data-translate="stats" data-translate-key="books">Books</p>
                        <p class="text-2xl font-bold text-gray-900">0/12</p>
                    </div>
                </div>
            </div>

            <div class="card transition-all duration-300 hover:scale-105 group">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600" data-translate="stats" data-translate-key="badges">Badges</p>
                        <p class="text-2xl font-bold text-gray-900">0</p>
                    </div>
                </div>
            </div>

            <div class="card transition-all duration-300 hover:scale-105 group">
                <div class="flex items-center">
                    <div class="w-12 h-12 bg-gradient-to-br from-orange-500 to-orange-600 rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-300">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7h8m0 0v8m0-8l-8 8-4-4-6 6"></path>
                        </svg>
                    </div>
                    <div class="ml-4">
                        <p class="text-sm font-medium text-gray-600" data-translate="stats" data-translate-key="streak">Streak</p>
                        <p class="text-2xl font-bold text-gray-900">0 days</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="mb-8">
            <nav class="flex space-x-8 bg-white rounded-xl shadow px-4 py-2 sticky top-0 z-10 overflow-visible">
                <button onclick="switchTab('dashboard')" class="tab-btn active flex items-center space-x-2 py-2 px-1 border-b-2 border-blue-500 text-blue-600 font-medium text-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2-2z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"></path>
                    </svg>
                    <span data-translate="navigation" data-translate-key="dashboard">Dashboard</span>
                </button>
                <button onclick="switchTab('lessons')" class="tab-btn flex items-center space-x-2 py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                    </svg>
                    <span data-translate="navigation" data-translate-key="lessons">Let's Get Started</span> <!-- Updated tab name -->
                </button>
                <button onclick="switchTab('library')" class="tab-btn flex items-center space-x-2 py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                    </svg>
                    <span data-translate="navigation" data-translate-key="library">Digital Library</span>
                </button>
                <button onclick="switchTab('progress')" class="tab-btn flex items-center space-x-2 py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path>
                    </svg>
                    <span data-translate="navigation" data-translate-key="progress">Progress & Insights</span>
                </button>
                <button onclick="switchTab('practice')" class="tab-btn flex items-center space-x-2 py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4M7.835 4.697a3.42 3.42 0 001.946-.806 3.42 3.42 0 014.438 0 3.42 3.42 0 001.946.806 3.42 3.42 0 013.138 3.138 3.42 3.42 0 00.806 1.946 3.42 3.42 0 010 4.438 3.42 3.42 0 00-.806 1.946 3.42 3.42 0 01-3.138 3.138 3.42 3.42 0 00-1.946.806 3.42 3.42 0 01-4.438 0 3.42 3.42 0 00-1.946-.806 3.42 3.42 0 01-3.138-3.138 3.42 3.42 0 00-.806-1.946 3.42 3.42 0 010-4.438 3.42 3.42 0 00.806-1.946 3.42 3.42 0 013.138-3.138z"></path>
                    </svg>
                    <span data-translate="navigation" data-translate-key="practice">Practice Materials</span>
                </button>
                <button onclick="switchTab('admin')" class="tab-btn admin-tab hidden flex items-center space-x-2 py-2 px-1 border-b-2 border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300 font-medium text-sm" id="adminTab">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                    </svg>
                    <span data-translate="navigation" data-translate-key="admin">Admin Panel</span>
                </button>
            </nav>
        </div>

        <!-- Tab Content -->
        <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
            <!-- Main Content -->
            <div class="lg:col-span-2">
                <!-- Dashboard Tab -->
                <div id="dashboard-content" class="tab-content">
                    <div class="space-y-6">
            <div class="card border-l-4 border-blue-500 transition-shadow hover:shadow-md">
                            <div class="card-header">
                                <h3 class="card-title" data-translate="gettingStarted" data-translate-key="gettingStarted">Getting Started</h3>
                            </div>
                            <div class="space-y-3">
                                <button onclick="goToTab('lessons')" class="w-full text-left flex items-center space-x-3 hover:bg-blue-50 rounded-lg p-3 transition">
                                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                        <span class="text-blue-600 font-semibold text-sm">1</span>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-900" data-translate="gettingStarted" data-translate-key="step1">Choose Your Role</p>
                                        <p class="text-sm text-gray-600" data-translate="gettingStarted" data-translate-key="step1Desc">Go to "Let's Get Started" tab and select your role</p>
                                    </div>
                                </button>
                                <button onclick="goToTab('library')" class="w-full text-left flex items-center space-x-3 hover:bg-blue-50 rounded-lg p-3 transition">
                                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                        <span class="text-blue-600 font-semibold text-sm">2</span>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-900" data-translate="gettingStarted" data-translate-key="step2">Access Content</p>
                                        <p class="text-sm text-gray-600" data-translate="gettingStarted" data-translate-key="step2Desc">Browse lessons, books, and practice materials</p>
                                    </div>
                                </button>
                                <button onclick="goToTab('progress')" class="w-full text-left flex items-center space-x-3 hover:bg-blue-50 rounded-lg p-3 transition">
                                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                        <span class="text-blue-600 font-semibold text-sm">3</span>
                                    </div>
                                    <div>
                                        <p class="font-medium text-gray-900" data-translate="gettingStarted" data-translate-key="step3">Track Progress</p>
                                        <p class="text-sm text-gray-600" data-translate="gettingStarted" data-translate-key="step3Desc">Monitor your learning journey and achievements</p>
                                    </div>
                                </button>
                            </div>
                        </div>

                        <div class="card transition-shadow hover:shadow-md">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4" data-translate="dashboard" data-translate-key="welcome">Accessible Quality Education</h3>
                            <p class="text-gray-600 mb-4" data-translate="dashboard" data-translate-key="welcomeDesc">
                                Accessible Quality Education is your gateway to personalized learning experiences. 
                                Choose your role in the "Let's Get Started" tab to begin your educational journey.
                            </p>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                <div class="bg-blue-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-blue-900 mb-2" data-translate="dashboard" data-translate-key="forStudents">For Students</h4>
                                    <p class="text-blue-700 text-sm" data-translate="dashboard" data-translate-key="forStudentsDesc">Access lessons, track progress, and earn badges as you learn.</p>
                                </div>
                                <div class="bg-green-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-green-900 mb-2" data-translate="dashboard" data-translate-key="forTeachers">For Teachers</h4>
                                    <p class="text-green-700 text-sm" data-translate="dashboard" data-translate-key="forTeachersDesc">Create assignments and monitor student progress effectively.</p>
                                </div>
                                <div class="bg-purple-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-purple-900 mb-2" data-translate="dashboard" data-translate-key="forParents">For Parents</h4>
                                    <p class="text-purple-700 text-sm" data-translate="dashboard" data-translate-key="forParentsDesc">Support your child's learning journey with progress insights.</p>
                                </div>
                                <div class="bg-orange-50 p-4 rounded-lg">
                                    <h4 class="font-semibold text-orange-900 mb-2" data-translate="dashboard" data-translate-key="forAdmins">For Admins</h4>
                                    <p class="text-orange-700 text-sm" data-translate="dashboard" data-translate-key="forAdminsDesc">Manage content, users, and system settings.</p>
                                </div>
                            </div>
                        </div>

                        <!-- Role Dashboards (dynamic) -->
                        <div id="role-dashboards" class="card hidden">
                            <div class="card-header">
                                <h3 class="card-title">Your Dashboard</h3>
                            </div>
                            <div id="role-dashboards-content" class="space-y-4"></div>
                            
                            <!-- Gamification Section -->
                            <div class="mt-6">
                                <h3 class="text-lg font-semibold text-gray-900 mb-4">Learning Challenges</h3>
                            <div class="space-y-3">
                                    <div class="flex items-center justify-between p-3 bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg">
                                <div class="flex items-center space-x-3">
                                            <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm font-bold">1</div>
                                    <div>
                                                <p class="text-sm font-medium">Math Master Challenge</p>
                                                <p class="text-xs text-gray-500">Complete 5 math lessons</p>
                                    </div>
                                </div>
                                        <div class="text-right">
                                            <p class="text-sm font-bold text-blue-600">3/5</p>
                                            <p class="text-xs text-gray-500">+50 pts</p>
                                    </div>
                                    </div>
                                    
                                    <div class="flex items-center justify-between p-3 bg-gradient-to-r from-green-50 to-teal-50 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white text-sm font-bold">2</div>
                                    <div>
                                                <p class="text-sm font-medium">Science Explorer</p>
                                                <p class="text-xs text-gray-500">Try 3 science experiments</p>
                                    </div>
                                </div>
                                        <div class="text-right">
                                            <p class="text-sm font-bold text-green-600">1/3</p>
                                            <p class="text-xs text-gray-500">+75 pts</p>
                                    </div>
                                    </div>
                                    
                                    <div class="flex items-center justify-between p-3 bg-gradient-to-r from-yellow-50 to-orange-50 rounded-lg">
                                        <div class="flex items-center space-x-3">
                                            <div class="w-8 h-8 bg-yellow-500 rounded-full flex items-center justify-center text-white text-sm font-bold">3</div>
                                    <div>
                                                <p class="text-sm font-medium">Streak Keeper</p>
                                                <p class="text-xs text-gray-500">Learn for 7 days straight</p>
                                    </div>
                                </div>
                                        <div class="text-right">
                                            <p class="text-sm font-bold text-yellow-600">5/7</p>
                                            <p class="text-xs text-gray-500">+100 pts</p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mt-4 p-3 bg-gray-50 rounded-lg">
                                    <div class="flex items-center justify-between mb-2">
                                        <span class="text-sm font-medium">Total Points</span>
                                        <span class="text-sm font-bold text-blue-600">1,250</span>
                                    </div>
                                    <div class="w-full bg-gray-200 rounded-full h-2">
                                        <div class="bg-blue-600 h-2 rounded-full" style="width: 62%"></div>
                                    </div>
                                    <p class="text-xs text-gray-500 mt-1">Next level: 2,000 points</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Start Lessons Tab (Role Selection) -->
                <div id="lessons-content" class="tab-content hidden">
                    <div class="space-y-6">
                        <div class="card">
                            <h3 class="text-lg font-semibold text-gray-900 mb-4" data-translate="role" data-translate-key="chooseRole">Choose Your Role</h3>
                            <p class="text-gray-600 mb-6" data-translate="role" data-translate-key="roleDesc">Select your role to access personalized learning experiences</p>
                            
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <!-- Student Role -->
                                <button onclick="selectRole('student')" class="role-card p-6 rounded-xl border-2 border-gray-200 bg-white hover:border-gray-300 hover:shadow-md transition-all duration-200 text-left">
                                    <div class="flex items-start space-x-4">
                                        <div class="p-3 rounded-lg bg-blue-500 text-white">
                                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                            </svg>
                                        </div>
                                        <div class="flex-1">
                                            <h3 class="text-lg font-semibold text-gray-900 mb-2" data-translate="role" data-translate-key="student">Student</h3>
                                            <p class="text-gray-600 text-sm" data-translate="role" data-translate-key="studentDesc">Access lessons, readings, and track your progress</p>
                                        </div>
                                    </div>
                                </button>

                                <!-- Teacher Role -->
                                <button onclick="selectRole('teacher')" class="role-card p-6 rounded-xl border-2 border-gray-200 bg-white hover:border-gray-300 hover:shadow-md transition-all duration-200 text-left">
                                    <div class="flex items-start space-x-4">
                                        <div class="p-3 rounded-lg bg-green-500 text-white">
                                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path>
                                            </svg>
                                        </div>
                                        <div class="flex-1">
                                            <h3 class="text-lg font-semibold text-gray-900 mb-2" data-translate="role" data-translate-key="teacher">Teacher</h3>
                                            <p class="text-gray-600 text-sm" data-translate="role" data-translate-key="teacherDesc">Create assignments and monitor student progress</p>
                                        </div>
                                    </div>
                                </button>

                                <!-- Parent Role -->
                                <button onclick="selectRole('parent')" class="role-card p-6 rounded-xl border-2 border-gray-200 bg-white hover:border-gray-300 hover:shadow-md transition-all duration-200 text-left">
                                    <div class="flex items-start space-x-4">
                                        <div class="p-3 rounded-lg bg-purple-500 text-white">
                                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                                            </svg>
                                        </div>
                                        <div class="flex-1">
                                            <h3 class="text-lg font-semibold text-gray-900 mb-2" data-translate="role" data-translate-key="parent">Parent/Guardian</h3>
                                            <p class="text-gray-600 text-sm" data-translate="role" data-translate-key="parentDesc">View your child's progress and support their learning</p>
                                        </div>
                                    </div>
                                </button>

                                <!-- Admin Role -->
                                <button onclick="selectRole('admin')" class="role-card p-6 rounded-xl border-2 border-gray-200 bg-white hover:border-gray-300 hover:shadow-md transition-all duration-200 text-left">
                                    <div class="flex items-start space-x-4">
                                        <div class="p-3 rounded-lg bg-orange-500 text-white">
                                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
                                            </svg>
                                        </div>
                                        <div class="flex-1">
                                            <h3 class="text-lg font-semibold text-gray-900 mb-2" data-translate="role" data-translate-key="admin">Administrator</h3>
                                            <p class="text-gray-600 text-sm" data-translate="role" data-translate-key="adminDesc">Manage content, users, and system settings</p>
                                        </div>
                                    </div>
                                </button>
                            </div>

                            <div class="mt-6 text-center">
                                <button id="continueBtn" onclick="continueToRole()" disabled class="btn btn-primary px-8 py-3 text-lg disabled:opacity-50 disabled:cursor-not-allowed">
                                    Continue
                                </button>
                            </div>

                            <div class="mt-4 text-center text-sm text-gray-500">
                                <p>Demo credentials will be used for each role</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Library Tab -->
                <div id="library-content" class="tab-content hidden">
                    <div class="space-y-6">
                        <!-- Library Header -->
                        <div class="card">
                            <div class="flex items-center justify-between mb-6">
                                <div>
                                    <h3 class="text-xl font-bold text-gray-900">📚 Digital Library</h3>
                                    <p class="text-gray-600">Explore our collection of educational books and resources</p>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-blue-600" id="totalBooks">0</div>
                                        <div class="text-sm text-gray-500">Total Books</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-green-600" id="booksRead">0</div>
                                        <div class="text-sm text-gray-500">Books Read</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-purple-600" id="readingTime">0h</div>
                                        <div class="text-sm text-gray-500">Reading Time</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Search and Filters -->
                            <div class="flex flex-col md:flex-row gap-4 mb-6">
                                <div class="flex-1">
                                    <div class="relative">
                                        <input type="text" id="librarySearch" placeholder="Search books by title, author, or subject..." 
                                               class="w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                                        <svg class="absolute left-3 top-2.5 w-5 h-5 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                                        </svg>
                                    </div>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <select id="gradeFilter" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                        <option value="">All Grades</option>
                                        <option value="1st">1st Grade</option>
                                        <option value="2nd">2nd Grade</option>
                                        <option value="3rd">3rd Grade</option>
                                        <option value="4th">4th Grade</option>
                                        <option value="5th">5th Grade</option>
                                    </select>
                                    <select id="subjectFilter" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                        <option value="">All Subjects</option>
                                        <option value="math">Mathematics</option>
                                        <option value="reading">Reading</option>
                                        <option value="science">Science</option>
                                        <option value="geography">Geography</option>
                                    </select>
                                    <select id="difficultyFilter" class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                                        <option value="">All Levels</option>
                                        <option value="beginner">Beginner</option>
                                        <option value="intermediate">Intermediate</option>
                                        <option value="advanced">Advanced</option>
                                    </select>
                                </div>
                            </div>
                            
                            <!-- Quick Filter Buttons -->
                            <div class="flex items-center space-x-2 mb-4">
                                <button onclick="filterBooks('all')" class="filter-btn px-3 py-1 text-sm rounded-full border border-gray-300 hover:bg-gray-50 active">All Books</button>
                                <button onclick="filterBooks('available')" class="filter-btn px-3 py-1 text-sm rounded-full border border-gray-300 hover:bg-gray-50">Available</button>
                                <button onclick="filterBooks('checked-out')" class="filter-btn px-3 py-1 text-sm rounded-full border border-gray-300 hover:bg-gray-50">Checked Out</button>
                                <button onclick="filterBooks('favorites')" class="filter-btn px-3 py-1 text-sm rounded-full border border-gray-300 hover:bg-gray-50">Favorites</button>
                                <button onclick="filterBooks('recent')" class="filter-btn px-3 py-1 text-sm rounded-full border border-gray-300 hover:bg-gray-50">Recently Added</button>
                            </div>
                        </div>

                        <!-- Books Grid -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="booksGrid">
                            <!-- Books will be dynamically inserted here -->
                        </div>

                        <!-- Book Details Modal -->
                        <div id="bookModal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
                            <div class="bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                                <div class="flex items-start justify-between mb-4">
                                    <h3 class="text-xl font-bold text-gray-900" id="modalBookTitle">Book Title</h3>
                                    <button onclick="closeBookModal()" class="text-gray-400 hover:text-gray-600">
                                        <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                                        </svg>
                                    </button>
                                </div>
                                
                                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-6">
                                    <div class="md:col-span-1">
                                        <div class="w-full h-64 bg-gray-200 rounded-lg flex items-center justify-center mb-4">
                                            <span class="text-6xl">📚</span>
                                        </div>
                                        <div class="text-center">
                                            <button id="modalCheckoutBtn" onclick="checkoutBook()" class="btn btn-primary w-full mb-2">
                                                Check Out Book
                                            </button>
                                            <button id="modalReturnBtn" onclick="returnBook()" class="btn btn-secondary w-full mb-2 hidden">
                                                Return Book
                                            </button>
                                            <button onclick="toggleFavorite()" class="btn btn-secondary w-full">
                                                <span id="favoriteText">Add to Favorites</span>
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <div class="md:col-span-2">
                                        <div class="space-y-4">
                                            <div>
                                                <h4 class="font-semibold text-gray-900">Author</h4>
                                                <p class="text-gray-600" id="modalBookAuthor">Author Name</p>
                                            </div>
                                            <div>
                                                <h4 class="font-semibold text-gray-900">Description</h4>
                                                <p class="text-gray-600" id="modalBookDescription">Book description will appear here...</p>
                                            </div>
                                            <div class="grid grid-cols-2 gap-4">
                                                <div>
                                                    <h4 class="font-semibold text-gray-900">Grade Level</h4>
                                                    <p class="text-gray-600" id="modalBookGrade">3rd Grade</p>
                                                </div>
                                                <div>
                                                    <h4 class="font-semibold text-gray-900">Subject</h4>
                                                    <p class="text-gray-600" id="modalBookSubject">Reading</p>
                                                </div>
                                                <div>
                                                    <h4 class="font-semibold text-gray-900">Pages</h4>
                                                    <p class="text-gray-600" id="modalBookPages">120</p>
                                                </div>
                                                <div>
                                                    <h4 class="font-semibold text-gray-900">Reading Time</h4>
                                                    <p class="text-gray-600" id="modalBookTime">45 minutes</p>
                                                </div>
                                            </div>
                                            <div>
                                                <h4 class="font-semibold text-gray-900">Rating</h4>
                                                <div class="flex items-center space-x-2">
                                                    <div class="flex" id="modalBookRating">
                                                        <!-- Stars will be inserted here -->
                                                    </div>
                                                    <span class="text-sm text-gray-600" id="modalBookRatingText">4.5 (23 reviews)</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Reading Progress -->
                                <div class="border-t pt-4">
                                    <h4 class="font-semibold text-gray-900 mb-3">Reading Progress</h4>
                                    <div class="space-y-2">
                                        <div class="flex items-center justify-between">
                                            <span class="text-sm text-gray-600">Pages Read</span>
                                            <span class="text-sm font-semibold text-gray-900" id="modalPagesRead">0 / 120</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-2">
                                            <div class="bg-blue-600 h-2 rounded-full transition-all duration-300" id="modalProgressBar" style="width: 0%"></div>
                                        </div>
                                        <div class="flex items-center justify-between">
                                            <span class="text-sm text-gray-600">Time Spent</span>
                                            <span class="text-sm font-semibold text-gray-900" id="modalTimeSpent">0 minutes</span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Reading List -->
                        <div class="card">
                            <div class="flex items-center justify-between mb-4">
                                <h4 class="text-lg font-semibold text-gray-900">My Reading List</h4>
                                <button onclick="createReadingList()" class="btn btn-primary text-sm">
                                    Create New List
                                </button>
                            </div>
                            <div id="readingLists" class="space-y-3">
                                <!-- Reading lists will be dynamically inserted here -->
                            </div>
                        </div>

                        <!-- Reading Statistics -->
                        <div class="card">
                            <h4 class="text-lg font-semibold text-gray-900 mb-4">Reading Statistics</h4>
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                                <div class="text-center">
                                    <div class="text-3xl font-bold text-blue-600" id="booksThisMonth">0</div>
                                    <div class="text-sm text-gray-500">Books This Month</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-3xl font-bold text-green-600" id="pagesReadToday">0</div>
                                    <div class="text-sm text-gray-500">Pages Read Today</div>
                                </div>
                                <div class="text-center">
                                    <div class="text-3xl font-bold text-purple-600" id="averageRating">0.0</div>
                                    <div class="text-sm text-gray-500">Average Rating Given</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Progress Tab -->
                <div id="progress-content" class="tab-content hidden">
                    <div class="space-y-6">
                        <!-- Progress Header -->
                        <div class="card">
                            <div class="flex items-center justify-between mb-6">
                                <div>
                                    <h3 class="text-xl font-bold text-gray-900">Progress & Insights</h3>
                                    <p class="text-gray-600">Track your learning journey and discover insights</p>
                                </div>
                                <div class="flex items-center space-x-4">
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-blue-600" id="totalLessonsCompleted">0</div>
                                        <div class="text-sm text-gray-500">Lessons Completed</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-green-600" id="studyStreak">0</div>
                                        <div class="text-sm text-gray-500">Day Streak</div>
                                    </div>
                                    <div class="text-center">
                                        <div class="text-2xl font-bold text-purple-600" id="totalTimeSpent">0h</div>
                                        <div class="text-sm text-gray-500">Study Time</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Progress Overview Cards -->
                        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
                            <!-- Subject Mastery -->
                            <div class="card">
                                <div class="flex items-center justify-between mb-4">
                                    <h4 class="text-lg font-semibold text-gray-900">Subject Mastery</h4>
                                    <div class="text-2xl">📚</div>
                                </div>
                                <div class="space-y-3">
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm text-gray-600">Mathematics</span>
                                        <div class="flex items-center space-x-2">
                                            <div class="w-16 bg-gray-200 rounded-full h-2">
                                                <div class="bg-blue-600 h-2 rounded-full" style="width: 75%"></div>
                                            </div>
                                            <span class="text-sm font-semibold text-gray-900">75%</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm text-gray-600">Reading</span>
                                        <div class="flex items-center space-x-2">
                                            <div class="w-16 bg-gray-200 rounded-full h-2">
                                                <div class="bg-green-600 h-2 rounded-full" style="width: 60%"></div>
                                            </div>
                                            <span class="text-sm font-semibold text-gray-900">60%</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm text-gray-600">Science</span>
                                        <div class="flex items-center space-x-2">
                                            <div class="w-16 bg-gray-200 rounded-full h-2">
                                                <div class="bg-purple-600 h-2 rounded-full" style="width: 85%"></div>
                                            </div>
                                            <span class="text-sm font-semibold text-gray-900">85%</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Learning Goals -->
                            <div class="card">
                                <div class="flex items-center justify-between mb-4">
                                    <h4 class="text-lg font-semibold text-gray-900">Learning Goals</h4>
                                    <div class="text-2xl">🎯</div>
                                </div>
                                <div class="space-y-3">
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm text-gray-600">Daily Practice</span>
                                        <div class="flex items-center space-x-2">
                                            <div class="w-16 bg-gray-200 rounded-full h-2">
                                                <div class="bg-green-600 h-2 rounded-full" style="width: 80%"></div>
                                            </div>
                                            <span class="text-sm font-semibold text-gray-900">8/10</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm text-gray-600">Weekly Lessons</span>
                                        <div class="flex items-center space-x-2">
                                            <div class="w-16 bg-gray-200 rounded-full h-2">
                                                <div class="bg-blue-600 h-2 rounded-full" style="width: 60%"></div>
                                            </div>
                                            <span class="text-sm font-semibold text-gray-900">6/10</span>
                                        </div>
                                    </div>
                                    <div class="flex items-center justify-between">
                                        <span class="text-sm text-gray-600">Reading Time</span>
                                        <div class="flex items-center space-x-2">
                                            <div class="w-16 bg-gray-200 rounded-full h-2">
                                                <div class="bg-purple-600 h-2 rounded-full" style="width: 40%"></div>
                                            </div>
                                            <span class="text-sm font-semibold text-gray-900">2/5h</span>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Recent Achievements -->
                            <div class="card">
                                <div class="flex items-center justify-between mb-4">
                                    <h4 class="text-lg font-semibold text-gray-900">Recent Achievements</h4>
                                    <div class="text-2xl">🏆</div>
                                </div>
                                <div class="space-y-3">
                                    <div class="flex items-center space-x-3">
                                        <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center">
                                            <span class="text-yellow-600 text-sm">🥇</span>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-gray-900">Math Master</p>
                                            <p class="text-xs text-gray-500">Completed 10 math lessons</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-3">
                                        <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                                            <span class="text-blue-600 text-sm">📖</span>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-gray-900">Bookworm</p>
                                            <p class="text-xs text-gray-500">Read 5 books this month</p>
                                        </div>
                                    </div>
                                    <div class="flex items-center space-x-3">
                                        <div class="w-8 h-8 bg-green-100 rounded-full flex items-center justify-center">
                                            <span class="text-green-600 text-sm">⚡</span>
                                        </div>
                                        <div>
                                            <p class="text-sm font-medium text-gray-900">Streak Master</p>
                                            <p class="text-xs text-gray-500">7-day study streak</p>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Study Insights -->
                            <div class="card">
                                <div class="flex items-center justify-between mb-4">
                                    <h4 class="text-lg font-semibold text-gray-900">Study Insights</h4>
                                    <div class="text-2xl">💡</div>
                                </div>
                                <div class="space-y-3">
                                    <div class="p-3 bg-blue-50 rounded-lg">
                                        <p class="text-sm font-medium text-blue-900">Peak Performance Time</p>
                                        <p class="text-xs text-blue-700">2:00 PM - 4:00 PM</p>
                                    </div>
                                    <div class="p-3 bg-green-50 rounded-lg">
                                        <p class="text-sm font-medium text-green-900">Strongest Subject</p>
                                        <p class="text-xs text-green-700">Science (85% accuracy)</p>
                                    </div>
                                    <div class="p-3 bg-yellow-50 rounded-lg">
                                        <p class="text-sm font-medium text-yellow-900">Focus Area</p>
                                        <p class="text-xs text-yellow-700">Reading Comprehension</p>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Detailed Analytics -->
                        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                            <!-- Learning Progress Chart -->
                            <div class="card">
                                <div class="flex items-center justify-between mb-4">
                                    <h4 class="text-lg font-semibold text-gray-900">Learning Progress</h4>
                                    <div class="flex items-center space-x-2">
                                        <button onclick="updateChartPeriod('week')" class="chart-period-btn px-3 py-1 text-xs rounded-full border border-gray-300 hover:bg-gray-50">Week</button>
                                        <button onclick="updateChartPeriod('month')" class="chart-period-btn px-3 py-1 text-xs rounded-full border border-gray-300 hover:bg-gray-50">Month</button>
                                        <button onclick="updateChartPeriod('year')" class="chart-period-btn px-3 py-1 text-xs rounded-full border border-gray-300 hover:bg-gray-50">Year</button>
                                    </div>
                                </div>
                                <canvas id="learningProgressChart" width="400" height="200"></canvas>
                            </div>

                            <!-- Subject Performance -->
                            <div class="card">
                                <h4 class="text-lg font-semibold text-gray-900 mb-4">Subject Performance</h4>
                                <canvas id="subjectPerformanceChart" width="400" height="200"></canvas>
                            </div>

                            <!-- Study Time Distribution -->
                            <div class="card">
                                <h4 class="text-lg font-semibold text-gray-900 mb-4">Study Time Distribution</h4>
                                <canvas id="studyTimeChart" width="400" height="200"></canvas>
                            </div>

                            <!-- Learning Velocity -->
                            <div class="card">
                                <h4 class="text-lg font-semibold text-gray-900 mb-4">Learning Velocity</h4>
                                <canvas id="learningVelocityChart" width="400" height="200"></canvas>
                            </div>
                        </div>

                        <!-- Detailed Progress Table -->
                        <div class="card">
                            <div class="flex items-center justify-between mb-4">
                                <h4 class="text-lg font-semibold text-gray-900">Detailed Progress</h4>
                                <div class="flex items-center space-x-2">
                                    <button onclick="exportProgress()" class="btn btn-secondary text-sm">
                                        Export Data
                                    </button>
                                    <button onclick="refreshProgress()" class="btn btn-primary text-sm">
                                        Refresh
                                    </button>
                                </div>
                            </div>
                            
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead>
                                        <tr class="border-b border-gray-200">
                                            <th class="text-left py-3 px-4 font-semibold text-gray-900">Subject</th>
                                            <th class="text-left py-3 px-4 font-semibold text-gray-900">Lessons</th>
                                            <th class="text-left py-3 px-4 font-semibold text-gray-900">Practice</th>
                                            <th class="text-left py-3 px-4 font-semibold text-gray-900">Accuracy</th>
                                            <th class="text-left py-3 px-4 font-semibold text-gray-900">Time Spent</th>
                                            <th class="text-left py-3 px-4 font-semibold text-gray-900">Last Activity</th>
                                        </tr>
                                    </thead>
                                    <tbody id="progressTableBody">
                                        <!-- Progress data will be dynamically inserted here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Recommendations -->
                        <div class="card">
                            <h4 class="text-lg font-semibold text-gray-900 mb-4">Personalized Recommendations</h4>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="recommendationsContainer">
                                <!-- Recommendations will be dynamically inserted here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Admin Tab -->
                <div id="admin-content" class="tab-content hidden">
                    <div class="space-y-6">
                        <!-- Admin Login -->
                        <div id="adminLogin" class="card">
                            <h3 class="card-title">Admin Access</h3>
                            <p class="muted">Enter admin password to access offline accessibility controls</p>
                            <div class="mt-4">
                                <input type="password" id="adminPassword" placeholder="Enter admin password" class="w-full px-3 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <button onclick="verifyAdminAccess()" class="btn btn-primary w-full mt-3">Access Admin Panel</button>
                            </div>
                        </div>
                        
                        <!-- Admin Panel (Hidden by default) -->
                        <div id="adminPanel" class="hidden space-y-6">
                            <!-- Offline Accessibility Controls -->
                            <div class="card">
                                <h3 class="card-title">Offline Accessibility Controls</h3>
                                <p class="muted">Manage offline access for children without internet connectivity</p>
                                
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                                    <!-- Offline Content Management -->
                                    <div class="space-y-4">
                                        <h4 class="font-semibold text-gray-900">Content Management</h4>
                                        <div class="space-y-3">
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <div>
                                                    <p class="text-sm font-medium">Download All Lessons</p>
                                                    <p class="text-xs text-gray-500">Make lessons available offline</p>
                                                </div>
                                                <button onclick="downloadAllLessons()" class="btn btn-secondary text-sm">Download</button>
                                            </div>
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <div>
                                                    <p class="text-sm font-medium">Sync Progress Data</p>
                                                    <p class="text-xs text-gray-500">Upload offline progress when online</p>
                                                </div>
                                                <button onclick="syncOfflineProgress()" class="btn btn-secondary text-sm">Sync</button>
                                            </div>
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <div>
                                                    <p class="text-sm font-medium">Generate Offline Package</p>
                                                    <p class="text-xs text-gray-500">Create USB/SD card package</p>
                                                </div>
                                                <button onclick="generateOfflinePackage()" class="btn btn-secondary text-sm">Generate</button>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Access Control -->
                                    <div class="space-y-4">
                                        <h4 class="font-semibold text-gray-900">Access Control</h4>
                                        <div class="space-y-3">
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <div>
                                                    <p class="text-sm font-medium">Offline Mode Status</p>
                                                    <p class="text-xs text-gray-500">Current offline access status</p>
                                                </div>
                                                <span class="badge badge-secondary" id="offlineStatus">Active</span>
                                            </div>
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <div>
                                                    <p class="text-sm font-medium">Offline Users</p>
                                                    <p class="text-xs text-gray-500">Children using offline access</p>
                                                </div>
                                                <span class="text-sm font-bold text-blue-600" id="offlineUserCount">12</span>
                                            </div>
                                            <div class="flex items-center justify-between p-3 bg-gray-50 rounded-lg">
                                                <div>
                                                    <p class="text-sm font-medium">Last Sync</p>
                                                    <p class="text-xs text-gray-500">When data was last synchronized</p>
                                                </div>
                                                <span class="text-sm text-gray-600" id="lastSyncTime">2 hours ago</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Offline Content Library -->
                            <div class="card">
                                <h3 class="card-title">Offline Content Library</h3>
                                <p class="muted">Manage content available for offline access</p>
                                
                                <div class="mt-6 grid grid-cols-1 md:grid-cols-3 gap-4">
                                    <div class="border rounded-lg p-4">
                                        <h4 class="font-semibold text-gray-900 mb-2">Math Lessons</h4>
                                        <p class="text-sm text-gray-600 mb-3">Basic arithmetic and problem solving</p>
                                        <div class="flex items-center justify-between">
                                            <span class="text-xs text-gray-500">24 lessons</span>
                                            <button onclick="toggleOfflineContent('math')" class="btn btn-primary text-xs">Enable Offline</button>
                                        </div>
                                    </div>
                                    
                                    <div class="border rounded-lg p-4">
                                        <h4 class="font-semibold text-gray-900 mb-2">Science Lessons</h4>
                                        <p class="text-sm text-gray-600 mb-3">Basic science concepts and experiments</p>
                                        <div class="flex items-center justify-between">
                                            <span class="text-xs text-gray-500">18 lessons</span>
                                            <button onclick="toggleOfflineContent('science')" class="btn btn-primary text-xs">Enable Offline</button>
                                        </div>
                                    </div>
                                    
                                    <div class="border rounded-lg p-4">
                                        <h4 class="font-semibold text-gray-900 mb-2">Reading Materials</h4>
                                        <p class="text-sm text-gray-600 mb-3">Stories and comprehension exercises</p>
                                        <div class="flex items-center justify-between">
                                            <span class="text-xs text-gray-500">32 books</span>
                                            <button onclick="toggleOfflineContent('reading')" class="btn btn-primary text-xs">Enable Offline</button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- System Settings -->
                            <div class="card">
                                <h3 class="card-title">System Settings</h3>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-6">
                                    <div>
                                        <h4 class="font-semibold text-gray-900 mb-4">Offline Settings</h4>
                                        <div class="space-y-3">
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm">Auto-sync when online</span>
                                                <input type="checkbox" checked class="rounded">
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm">Compress offline content</span>
                                                <input type="checkbox" checked class="rounded">
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm">Enable offline analytics</span>
                                                <input type="checkbox" class="rounded">
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <h4 class="font-semibold text-gray-900 mb-4">Accessibility Settings</h4>
                                        <div class="space-y-3">
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm">High contrast mode</span>
                                                <input type="checkbox" class="rounded">
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm">Large text size</span>
                                                <input type="checkbox" class="rounded">
                                            </div>
                                            <div class="flex items-center justify-between">
                                                <span class="text-sm">Audio descriptions</span>
                                                <input type="checkbox" checked class="rounded">
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Practice Tab -->
                <div id="practice-content" class="tab-content hidden">
                    <div class="card">
                        <h3 class="text-lg font-semibold text-gray-900 mb-4" data-translate="practice" data-translate-key="practiceMaterials">Practice Materials</h3>
                        <p class="text-gray-600 mb-4" data-translate="practice" data-translate-key="practiceDesc">Please select your role in the "Let's Get Started" tab to access practice materials.</p>
                        <div class="space-y-4">
                            <div class="border rounded-lg p-4 opacity-50">
                                <h4 class="font-semibold text-gray-900" data-translate="practice" data-translate-key="mathPracticeQuiz">Math Practice Quiz</h4>
                                <p class="text-sm text-gray-600" data-translate="practice" data-translate-key="mathQuizDesc">Addition and Subtraction</p>
                                <button class="btn btn-primary text-sm mt-2" disabled data-translate="practice" data-translate-key="startQuiz">Start Quiz</button>
                            </div>
                            <div class="border rounded-lg p-4 opacity-50">
                                <h4 class="font-semibold text-gray-900" data-translate="practice" data-translate-key="readingComprehension">Reading Comprehension</h4>
                                <p class="text-sm text-gray-600" data-translate="practice" data-translate-key="readingDesc2">Understanding Stories</p>
                                <button class="btn btn-primary text-sm mt-2" disabled data-translate="practice" data-translate-key="startPractice">Start Practice</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Sidebar -->
            <div class="space-y-6">
                

                <div class="card">
                    <h3 class="text-lg font-semibold text-gray-900 mb-4" data-translate="platform" data-translate-key="platformFeatures">Platform Features</h3>
                    <div class="space-y-3">
                        <div class="flex items-center space-x-3">
                            <svg class="w-5 h-5 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                            </svg>
                            <div>
                                <p class="font-medium text-gray-900" data-translate="platform" data-translate-key="adaptiveLearning">Adaptive Learning</p>
                                <p class="text-sm text-gray-500" data-translate="platform" data-translate-key="adaptiveLearningDesc">Personalized difficulty adjustment</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <svg class="w-5 h-5 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                            </svg>
                            <div>
                                <p class="font-medium text-gray-900" data-translate="platform" data-translate-key="offlineSupport">Offline Support</p>
                                <p class="text-sm text-gray-500" data-translate="platform" data-translate-key="offlineSupportDesc">Learn without internet connection</p>
                            </div>
                        </div>
                        <div class="flex items-center space-x-3">
                            <svg class="w-5 h-5 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"></path>
                            </svg>
                            <div>
                                <p class="font-medium text-gray-900" data-translate="platform" data-translate-key="smsLearning">SMS Learning</p>
                                <p class="text-sm text-gray-500" data-translate="platform" data-translate-key="smsLearningDesc">Learn via text messages</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="mt-10 border-t bg-white/60 backdrop-blur">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6">
            <div class="flex flex-col sm:flex-row items-center justify-between gap-3">
                <p class="text-xs text-gray-500">© <span id="year"></span> Accessible Quality Education</p>
                <div class="flex items-center gap-4 text-xs text-gray-500">
                    <a href="#" class="hover:text-gray-700">Privacy</a>
                    <a href="#" class="hover:text-gray-700">Terms</a>
                    <a href="#" class="hover:text-gray-700">Support</a>
                </div>
            </div>
        </div>
    </footer>

    <script>
        let selectedRole = '';
        let currentUser = null;

        // Load user data and initialize library on page load
        document.addEventListener('DOMContentLoaded', function() {
            currentUser = JSON.parse(localStorage.getItem('currentUser') || 'null');
            updateUserDisplay();
            renderGradeSelect();
            const y = document.getElementById('year');
            if (y) y.textContent = new Date().getFullYear();
            
            // Initialize comprehensive systems with a delay to ensure Chart.js is loaded
            setTimeout(() => {
                try {
                    progressAnalytics.init();
                    console.log('Progress analytics initialized successfully');
                } catch (error) {
                    console.error('Error initializing progress analytics:', error);
                }
                
                try {
                    digitalLibrary.init();
                    console.log('Digital library initialized successfully');
                } catch (error) {
                    console.error('Error initializing digital library:', error);
                }
            }, 100);
        });

        function updateUserDisplay() {
            if (currentUser) {
                document.getElementById('userFullName').textContent = currentUser.name || 'User';
                document.getElementById('userRole').textContent = currentUser.role || 'user';
                document.querySelector('button[onclick="logout()"]').textContent = 'Logout';
            } else {
                document.getElementById('userFullName').textContent = 'Guest User';
                document.getElementById('userRole').textContent = 'guest';
                document.querySelector('button[onclick="logout()"]').textContent = 'Login';
            }
        }

        // Tab switching functionality
        function switchTab(tabName) {
            // Hide all tab contents with fade out
            document.querySelectorAll('.tab-content').forEach(content => {
                content.style.opacity = '0';
                content.style.transform = 'translateY(10px)';
                setTimeout(() => {
                    content.classList.add('hidden');
                }, 150);
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.remove('border-blue-500', 'text-blue-600', 'active');
                btn.classList.add('border-transparent', 'text-gray-500');
            });
            
            // Show selected tab content with fade in
            setTimeout(() => {
                const targetContent = document.getElementById(tabName + '-content');
                if (targetContent) {
                    targetContent.classList.remove('hidden');
                    targetContent.style.opacity = '0';
                    targetContent.style.transform = 'translateY(10px)';
                    setTimeout(() => {
                        targetContent.style.transition = 'all 0.3s ease';
                        targetContent.style.opacity = '1';
                        targetContent.style.transform = 'translateY(0)';
                    }, 50);
                }
                
                // Add active class to selected tab
                const targetTab = document.querySelector(`[onclick="switchTab('${tabName}')"]`);
                if (targetTab) {
                    targetTab.classList.remove('border-transparent', 'text-gray-500');
                    targetTab.classList.add('border-blue-500', 'text-blue-600', 'active');
                }
            }, 150);
            
            // Ensure language is maintained after tab switch
            if (window.currentLanguage) {
                setTimeout(() => {
                    translateDynamicContent();
                }, 200);
            }
        }

        // Programmatic tab navigation used by Getting Started buttons
        function goToTab(tabName) {
            // Find the corresponding tab button and click it to ensure active state updates
            const btn = Array.from(document.querySelectorAll('.tab-btn')).find(b => b.getAttribute('onclick') && b.getAttribute('onclick').includes(`switchTab('${tabName}')`));
            if (btn) {
                btn.click();
            } else {
                // fallback: directly switch if button not found
                switchTab(tabName);
            }
            if (tabName === 'progress') {
                renderProgressForRole();
            }
        }

        // Role selection functionality
        function selectRole(role) {
            selectedRole = role;
            
            // Remove previous selections
            document.querySelectorAll('.role-card').forEach(card => {
                card.classList.remove('border-blue-500', 'bg-blue-50', 'shadow-lg');
                card.classList.add('border-gray-200', 'bg-white');
            });
            
            // Highlight selected role
            event.target.closest('.role-card').classList.remove('border-gray-200', 'bg-white');
            event.target.closest('.role-card').classList.add('border-blue-500', 'bg-blue-50', 'shadow-lg');
            
            // Enable continue button
            document.getElementById('continueBtn').disabled = false;

            // Render role-specific dashboards preview
            renderRoleDashboards(role);
            
            // Ensure language is maintained after role selection
            if (window.currentLanguage) {
                setTimeout(() => {
                    translateDynamicContent();
                }, 100);
            }
        }

        function renderRoleDashboards(role) {
            const wrap = document.getElementById('role-dashboards');
            const container = document.getElementById('role-dashboards-content');
            if (!wrap || !container) return;

            let html = '';
            if (role === 'admin') {
                html = `
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="border rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900">Site Controls</h4>
                            <p class="text-sm text-gray-600">Manage users, content, and settings</p>
                        </div>
                        <div class="border rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900">Access Dashboards</h4>
                            <p class="text-sm text-gray-600">View Teacher, Parent, and Student dashboards</p>
                        </div>
                        <div class="border rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900">Audit & Logs</h4>
                            <p class="text-sm text-gray-600">Monitor activity and system health</p>
                        </div>
                    </div>
                `;
            } else if (role === 'teacher') {
                html = `
                    <div class="space-y-3">
                        <div class="border rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900">Class Overview</h4>
                            <p class="text-sm text-gray-600">Track progress, assignments, and insights</p>
                        </div>
                        <div class="border rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900">Student Progress</h4>
                            <p class="text-sm text-gray-600">Identify struggling students and provide support</p>
                        </div>
                    </div>
                `;
            } else if (role === 'parent') {
                html = `
                    <div class="space-y-3">
                        <div class="border rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900">Child's Progress</h4>
                            <p class="text-sm text-gray-600">View achievements and areas for improvement</p>
                        </div>
                        <div class="border rounded-lg p-4">
                            <h4 class="font-semibold text-gray-900">Insights</h4>
                            <p class="text-sm text-gray-600">See topics needing extra practice</p>
                        </div>
                    </div>
                `;
            } else {
                html = `
                    <div class="border rounded-lg p-4">
                        <h4 class="font-semibold text-gray-900">Student Dashboard</h4>
                        <p class="text-sm text-gray-600">Resume lessons, view badges, and check streak</p>
                    </div>
                `;
            }

            container.innerHTML = html;
            wrap.classList.remove('hidden');
        }
        // -----------------------------
        // Digital Library (Demo)
        // -----------------------------
        const grades = [
            'Pre-K', 'Kindergarten', '1st Grade', '2nd Grade', '3rd Grade', '4th Grade', '5th Grade',
            '6th Grade', '7th Grade', '8th Grade', '9th Grade', '10th Grade', '11th Grade', '12th Grade'
        ];
        const subjects = [
            { key: 'science', label: 'Science' },
            { key: 'technology', label: 'Technology' },
            { key: 'english', label: 'English' },
            { key: 'math', label: 'Math' },
            { key: 'geography', label: 'Geography' }
        ];

        let selectedGradeIndex = null;
        let selectedSubjectKey = '';

        function renderGradeSelect() {
            const select = document.getElementById('gradeSelect');
            if (!select) return;
            grades.forEach((grade, index) => {
                const opt = document.createElement('option');
                opt.value = String(index);
                opt.textContent = grade;
                select.appendChild(opt);
            });
        }

        function applySelectedGrade() {
            const select = document.getElementById('gradeSelect');
            const value = select ? select.value : '';
            selectedGradeIndex = value === '' ? null : parseInt(value, 10);
            // reset subject when grade changes
            selectedSubjectKey = '';
            // reset show-all states
            for (const k in subjectShowAllState) delete subjectShowAllState[k];
            renderLibrarySections();
            
            // Ensure language is maintained after grade selection
            if (window.currentLanguage) {
                setTimeout(() => {
                    translateDynamicContent();
                }, 100);
            }
        }

        function renderLibrarySections() {
            const container = document.getElementById('librarySections');
            if (!container) return;

            if (selectedGradeIndex === null) {
                container.innerHTML = '<div class="rounded-md border border-dashed border-gray-300 p-6 text-center text-gray-500">Please select a grade level above to view lessons.</div>';
                return;
            }

            const gradeLabel = grades[selectedGradeIndex];

            // Subject selector
            let html = `
                <div class="mb-4">
                    <div class="flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3">
                        <div>
                            <h4 class="font-semibold text-gray-900">${gradeLabel}</h4>
                            <p class="text-xs text-gray-500">Choose a subject to practice</p>
                        </div>
                        <div class="flex gap-2 flex-wrap">
                            ${subjects.map(s => `
                                <button type="button" onclick="selectSubject('${s.key}')" class="px-3 py-2 text-sm rounded-md ${selectedSubjectKey===s.key ? 'bg-blue-600 text-white' : 'bg-white border hover:bg-gray-50'}">${s.label}</button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;

            // Content depending on subject selected
            if (!selectedSubjectKey) {
                html += '<div class="rounded-md border border-dashed border-gray-300 p-6 text-center text-gray-500">Select a subject above to view demo lessons.</div>';
            } else {
                const showAll = subjectShowAllState[selectedSubjectKey] === true;
                html += `
                        <div class="mb-4 border rounded-xl">
                        <div class="flex items-center justify-between px-4 py-3">
                            <h4 class="font-semibold text-gray-900">${gradeLabel} • ${subjectLabel(selectedSubjectKey)} Lessons</h4>
                            <div class="text-xs text-gray-500">${showAll ? 'Showing all 20' : 'Showing 4 of 20'}</div>
                        </div>
                        <div class="px-4 pb-4">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                ${generateDemoLessons(selectedSubjectKey, showAll).join('')}
                            </div>
                            <div class="mt-3 text-right">
                                <button onclick="toggleShowAll('${selectedSubjectKey}')" class="text-sm text-blue-600 hover:underline">
                                    ${showAll ? 'Show less' : 'Show all 20'}
                                </button>
                            </div>
                        </div>
                    </div>
                `;
            }

            container.innerHTML = html;
        }

        const subjectShowAllState = {};

        function selectSubject(subjectKey) {
            selectedSubjectKey = subjectKey;
            renderLibrarySections();
            
            // Ensure language is maintained after subject selection
            if (window.currentLanguage) {
                setTimeout(() => {
                    translateDynamicContent();
                }, 100);
            }
        }

        function toggleShowAll(subjectKey) {
            subjectShowAllState[subjectKey] = !subjectShowAllState[subjectKey];
            renderLibrarySections();
            
            // Ensure language is maintained after toggle
            if (window.currentLanguage) {
                setTimeout(() => {
                    translateDynamicContent();
                }, 100);
            }
        }

        function generateDemoLessons(subjectKey, showAll) {
            const lessons = [];
            const total = 20;
            const limit = showAll ? total : 4;
            for (let i = 1; i <= limit; i++) {
                lessons.push(`
                    <div class="border rounded-lg p-4 hover:shadow-sm transition-shadow fade-in" draggable="true" ondragstart="dragStart(event)" data-lesson-id="${subjectKey}-${i}">
                        <div class="flex items-start justify-between gap-3">
                            <div class="flex-1">
                                <h4 class="font-semibold text-gray-900">${capitalize(subjectKey)} Demo Lesson ${i}</h4>
                                <p class="text-sm text-gray-600">${subjectLabel(subjectKey)} • Gamified Demo</p>
                            </div>
                            <div class="flex items-center gap-2">
                                <span class="badge badge-primary">Demo</span>
                                <button onclick="toggleBookmark('${subjectKey}-${i}')" class="p-1 text-gray-400 hover:text-yellow-500" title="Bookmark">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <p class="text-xs text-gray-500 mt-2">Interactive placeholder: mini-games, hints, and progress hooks will be added here.</p>
                        
                        <!-- Progress Bar -->
                        <div class="mt-3">
                            <div class="flex justify-between text-xs text-gray-500 mb-1">
                                <span>Progress</span>
                                <span>${Math.floor(Math.random() * 100)}%</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                <div class="bg-blue-600 h-2 rounded-full" style="width: ${Math.floor(Math.random() * 100)}%"></div>
                            </div>
                        </div>
                        
                        <!-- Star Rating -->
                        <div class="mt-3 flex items-center gap-1">
                            <span class="text-xs text-gray-500">Rating:</span>
                            <div class="flex">
                                ${[1,2,3,4,5].map(star => `
                                    <button onclick="rateLesson('${subjectKey}-${i}', ${star})" class="text-yellow-400 hover:text-yellow-500">
                                        <svg class="w-4 h-4 ${star <= Math.floor(Math.random() * 5) + 1 ? 'fill-current' : ''}" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"></path>
                                        </svg>
                                    </button>
                                `).join('')}
                            </div>
                        </div>
                        
                        <div class="mt-3 grid grid-cols-3 gap-2">
                            <button class="btn btn-primary text-xs py-2" disabled>Play</button>
                            <button onclick="previewLesson('${subjectKey}-${i}')" class="btn btn-secondary text-xs py-2">Preview</button>
                            <button onclick="showLessonInfo('${subjectKey}-${i}')" class="btn btn-secondary text-xs py-2">Info</button>
                        </div>
                    </div>
                `);
            }
            return lessons;
        }

        function subjectLabel(key) {
            const found = subjects.find(s => s.key === key);
            return found ? found.label : key;
        }

        function capitalize(str) {
            return str.charAt(0).toUpperCase() + str.slice(1);
        }

        function continueToRole() {
            if (selectedRole) {
                // Demo login credentials
                const demoUsers = {
                    student: { email: 'student@demo.com', password: 'demo123', name: 'Alex Johnson' },
                    teacher: { email: 'teacher@demo.com', password: 'demo123', name: 'Sarah Williams' },
                    parent: { email: 'parent@demo.com', password: 'demo123', name: 'Michael Johnson' },
                    admin: { email: 'admin@demo.com', password: 'demo123', name: 'Admin User' }
                };

                const demoUser = demoUsers[selectedRole];
                
                // Store user info
                currentUser = {
                    role: selectedRole,
                    email: demoUser.email,
                    name: demoUser.name
                };
                localStorage.setItem('currentUser', JSON.stringify(currentUser));
                
                // Update display
                updateUserDisplay();
                
                // Update stats based on role
                updateStatsForRole(selectedRole);
                
                // Switch to dashboard
                switchTab('dashboard');
                
                // Show success message
                alert(`Welcome, ${demoUser.name}! You are now logged in as a ${selectedRole}.`);
                
                // Ensure language is maintained after role continuation
                if (window.currentLanguage) {
                    setTimeout(() => {
                        translateDynamicContent();
                    }, 200);
                }
            }
        }

        function updateStatsForRole(role) {
            const stats = {
                student: { lessons: '18/24', books: '3/12', badges: '8', streak: '7' },
                teacher: { lessons: '24/24', books: '12/12', badges: '12', streak: '15' },
                parent: { lessons: '0/0', books: '0/0', badges: '0', streak: '0' },
                admin: { lessons: '24/24', books: '12/12', badges: '15', streak: '30' }
            };

            const roleStats = stats[role];
            document.querySelector('.card:nth-child(1) .text-2xl').textContent = roleStats.lessons;
            document.querySelector('.card:nth-child(2) .text-2xl').textContent = roleStats.books;
            document.querySelector('.card:nth-child(3) .text-2xl').textContent = roleStats.badges;
            document.querySelector('.card:nth-child(4) .text-2xl').textContent = roleStats.streak + ' days';
        }

        // -----------------------------
        // Progress & Insights (Demo)
        // -----------------------------
        function renderProgressForRole() {
            const container = document.getElementById('progress-role-container');
            if (!container) return;

            const role = (currentUser && currentUser.role) || selectedRole || 'student';

            if (role === 'teacher' || role === 'parent') {
                container.innerHTML = `
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Progress & Insights</h3>
                        </div>
                        <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-4">
                            <p class="muted">Overview of students registered to your care. Demo charts.</p>
                            <div class="flex items-center gap-2">
                                <label for="studentSelect" class="text-sm text-gray-600">Student</label>
                                <select id="studentSelect" class="border rounded-lg px-3 py-2 bg-white text-sm"></select>
                            </div>
                        </div>
                        <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                            <div class="border rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 mb-2">Mastery by Subject</h4>
                                <canvas id="chartMastery" height="200"></canvas>
                            </div>
                            <div class="border rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 mb-2">Struggle Areas</h4>
                                <canvas id="chartStruggle" height="200"></canvas>
                            </div>
                            <div class="border rounded-lg p-4">
                                <h4 class="font-semibold text-gray-900 mb-2">Practice Recommendations</h4>
                                <ul class="text-sm text-gray-700 list-disc pl-5 space-y-1">
                                    <li id="rec1">—</li>
                                    <li id="rec2">—</li>
                                    <li id="rec3">—</li>
                                </ul>
                            </div>
                        </div>
                        <div class="mt-6">
                            <h4 class="font-semibold text-gray-900 mb-2">Students</h4>
                            <div class="overflow-x-auto">
                                <table class="min-w-full text-sm">
                                    <thead>
                                        <tr class="text-left text-gray-600">
                                            <th class="py-2 pr-4">Student</th>
                                            <th class="py-2 pr-4">Current Focus</th>
                                            <th class="py-2 pr-4">Struggling</th>
                                            <th class="py-2 pr-4">Mastery</th>
                                        </tr>
                                    </thead>
                                    <tbody class="text-gray-900">
                                        <tr class="border-t">
                                            <td class="py-2 pr-4">Alex Johnson</td>
                                            <td class="py-2 pr-4">Fractions</td>
                                            <td class="py-2 pr-4">Word Problems</td>
                                            <td class="py-2 pr-4">62%</td>
                                        </tr>
                                        <tr class="border-t">
                                            <td class="py-2 pr-4">Mia Chen</td>
                                            <td class="py-2 pr-4">Reading Comprehension</td>
                                            <td class="py-2 pr-4">Inference</td>
                                            <td class="py-2 pr-4">74%</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                `;

                // Demo students and chart rendering
                setTimeout(() => {
                    const studentSelect = document.getElementById('studentSelect');
                    const students = [
                        { id: 'alex', name: 'Alex Johnson', mastery: [62, 68, 55, 61, 50], struggles: [8, 6, 5, 4, 3], recs: ['Fractions (G5) - 15 min/day','Word Problems (G5) - 10 min/day','Ecosystems Review (G5) - 10 min/day'] },
                        { id: 'mia', name: 'Mia Chen', mastery: [78, 72, 60, 66, 58], struggles: [5, 7, 4, 3, 2], recs: ['Inference (G4) - 10 min/day','Summarizing (G4) - 10 min/day','Maps & Coordinates (G4) - 10 min/day'] },
                        { id: 'sam', name: 'Sam Rivera', mastery: [55, 65, 70, 62, 60], struggles: [6, 4, 3, 5, 4], recs: ['Decimals (G5) - 10 min/day','Main Idea (G5) - 10 min/day','Algorithms Basics (G5) - 10 min/day'] }
                    ];

                    // populate select
                    students.forEach(s => {
                        const opt = document.createElement('option');
                        opt.value = s.id;
                        opt.textContent = s.name;
                        studentSelect.appendChild(opt);
                    });

                    let chartMasteryInstance = null;
                    let chartStruggleInstance = null;

                    function renderChartsFor(student) {
                        const masteryEl = document.getElementById('chartMastery');
                        const struggleEl = document.getElementById('chartStruggle');
                        const rec1 = document.getElementById('rec1');
                        const rec2 = document.getElementById('rec2');
                        const rec3 = document.getElementById('rec3');
                        if (rec1 && rec2 && rec3) {
                            rec1.textContent = student.recs[0];
                            rec2.textContent = student.recs[1];
                            rec3.textContent = student.recs[2];
                        }

                        const masteryData = {
                            labels: ['Math', 'English', 'Science', 'Technology', 'Geography'],
                            datasets: [{ data: student.mastery, backgroundColor: ['#2563eb','#16a34a','#a855f7','#f59e0b','#64748b'] }]
                        };
                        const struggleData = {
                            labels: ['Fractions','Inference','Ecosystems','Algorithms','Maps'],
                            datasets: [{ label: 'Difficulty', data: student.struggles, backgroundColor: '#ef4444' }]
                        };

                        if (masteryEl && window.Chart) {
                            if (chartMasteryInstance) chartMasteryInstance.destroy();
                            chartMasteryInstance = new Chart(masteryEl, {
                                type: 'doughnut',
                                data: masteryData,
                                options: { responsive: true, plugins: { legend: { position: 'bottom' } } }
                            });
                        }
                        if (struggleEl && window.Chart) {
                            if (chartStruggleInstance) chartStruggleInstance.destroy();
                            chartStruggleInstance = new Chart(struggleEl, {
                                type: 'bar',
                                data: struggleData,
                                options: { responsive: true, scales: { y: { beginAtZero: true, max: 10 } } }
                            });
                        }
                    }

                    // initial render
                    renderChartsFor(students[0]);
                    studentSelect.value = students[0].id;
                    studentSelect.addEventListener('change', () => {
                        const s = students.find(st => st.id === studentSelect.value);
                        if (s) renderChartsFor(s);
                    });
                }, 0);
            } else {
                container.innerHTML = `
                    <div class="card">
                        <div class="card-header">
                            <h3 class="card-title">Progress & Insights</h3>
                        </div>
                        <p class="muted">Please select your role or log in to view detailed insights.</p>
                    </div>
                `;
            }
        }

        // Logout functionality
        // Advanced Analytics Charts
        function initializeAdvancedCharts() {
            // Learning Velocity Chart
            const velocityCtx = document.getElementById('velocityChart');
            if (velocityCtx) {
                new Chart(velocityCtx, {
                    type: 'line',
                    data: {
                        labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4', 'Week 5', 'Week 6'],
                        datasets: [{
                            label: 'Lessons Completed',
                            data: [3, 5, 7, 4, 8, 6],
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }

            // Time-of-Day Performance Chart
            const timeCtx = document.getElementById('timeChart');
            if (timeCtx) {
                new Chart(timeCtx, {
                    type: 'bar',
                    data: {
                        labels: ['6AM', '9AM', '12PM', '3PM', '6PM', '9PM'],
                        datasets: [{
                            label: 'Performance Score',
                            data: [65, 78, 85, 92, 88, 72],
                            backgroundColor: 'rgba(34, 197, 94, 0.8)',
                            borderColor: 'rgb(34, 197, 94)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100
                            }
                        }
                    }
                });
            }

            // Subject Correlation Chart
            const correlationCtx = document.getElementById('correlationChart');
            if (correlationCtx) {
                new Chart(correlationCtx, {
                    type: 'radar',
                    data: {
                        labels: ['Math', 'Science', 'English', 'Technology', 'Geography'],
                        datasets: [{
                            label: 'Current Performance',
                            data: [85, 78, 92, 65, 88],
                            borderColor: 'rgb(168, 85, 247)',
                            backgroundColor: 'rgba(168, 85, 247, 0.2)',
                            pointBackgroundColor: 'rgb(168, 85, 247)'
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100
                            }
                        }
                    }
                });
            }
        }

        // Initialize charts when page loads
        document.addEventListener('DOMContentLoaded', function() {
            initializeAdvancedCharts();
        });

        // Admin Functions
        function verifyAdminAccess() {
            const password = document.getElementById('adminPassword').value;
            const adminPassword = 'admin123'; // In production, this should be securely stored
            
            if (password === adminPassword) {
                document.getElementById('adminLogin').classList.add('hidden');
                document.getElementById('adminPanel').classList.remove('hidden');
                showAdminTab();
                alert('Admin access granted!');
                
                // Ensure language is maintained after admin access
                if (window.currentLanguage) {
                    setTimeout(() => {
                        translateDynamicContent();
                    }, 100);
                }
            } else {
                alert('Invalid admin password. Please try again.');
                document.getElementById('adminPassword').value = '';
            }
        }

        function showAdminTab() {
            document.getElementById('adminTab').classList.remove('hidden');
            document.getElementById('adminMobileTab').classList.remove('hidden');
        }

        function downloadAllLessons() {
            alert('Downloading all lessons for offline access...\n\nThis would typically:\n- Download lesson content\n- Cache media files\n- Create offline database\n- Generate offline package');
        }

        function syncOfflineProgress() {
            alert('Syncing offline progress data...\n\nThis would:\n- Upload completed lessons\n- Sync progress tracking\n- Update analytics\n- Merge offline data');
        }

        function generateOfflinePackage() {
            alert('Generating offline package...\n\nThis would create:\n- USB/SD card installer\n- Offline lesson packages\n- Progress tracking files\n- Installation instructions');
        }

        function toggleOfflineContent(subject) {
            alert(`Toggling offline access for ${subject} content...\n\nThis would enable/disable offline availability for ${subject} lessons.`);
        }

        // Language Translation Functions
        const translations = {
            en: {
                // Header & Navigation
                welcome: "Accessible Quality Education",
                welcomeSubtitle: "Welcome to your learning platform!",
                dashboard: "Dashboard",
                lessons: "Let's Get Started",
                library: "Digital Library",
                progress: "Progress & Insights",
                practice: "Practice Materials",
                admin: "Admin Panel",
                searchPlaceholder: "Search lessons...",
                login: "Login",
                guest: "Guest User",
                role: "guest",
                
                // Hero Section
                heroTitle: "Learn better with a platform designed for every learner",
                heroSubtitle: "Accessible Quality Education provides personalized learning experiences for students, teachers, and parents.",
                getStarted: "Get Started",
                learnMore: "Learn More",
                
                // Getting Started
                gettingStarted: "Getting Started",
                step1: "Choose Your Role",
                step1Desc: "Go to \"Let's Get Started\" tab and select your role",
                step2: "Access Content",
                step2Desc: "Browse lessons, books, and practice materials",
                step3: "Track Progress",
                step3Desc: "Monitor your learning journey and achievements",
                
                // Role Selection
                chooseRole: "Choose Your Role",
                roleDesc: "Select your role to access personalized learning experiences",
                student: "Student",
                studentDesc: "Access lessons, readings, and track your progress",
                teacher: "Teacher",
                teacherDesc: "Create assignments and monitor student progress effectively",
                parent: "Parent/Guardian",
                parentDesc: "Track your child's progress and support their learning",
                admin: "Admin",
                adminDesc: "Manage content, users, and system settings.",
                
                // Dashboard Content
                yourDashboard: "Your Dashboard",
                resumeLearning: "Resume Learning",
                resumeDesc: "Continue where you left off",
                achievements: "Achievements",
                achievementsDesc: "Your learning badges",
                learningStreak: "Learning Streak",
                streakDesc: "Keep your momentum going!",
                daysInRow: "days in a row",
                mathMaster: "Math Master",
                starStudent: "Star Student",
                hotStreak: "Hot Streak",
                continueLesson: "Continue Lesson",
                
                // Dashboard Welcome Section
                welcome: "Accessible Quality Education",
                welcomeDesc: "Accessible Quality Education is your gateway to personalized learning experiences. Choose your role in the \"Let's Get Started\" tab to begin your educational journey.",
                forStudents: "For Students",
                forStudentsDesc: "Access lessons, track progress, and earn badges as you learn.",
                forTeachers: "For Teachers",
                forTeachersDesc: "Create assignments and monitor student progress effectively.",
                forParents: "For Parents",
                forParentsDesc: "Support your child's learning journey with progress insights.",
                forAdmins: "For Admins",
                forAdminsDesc: "Manage content, users, and system settings.",
                
                // Learning Challenges
                learningChallenges: "Learning Challenges",
                challengesDesc: "Complete challenges to earn points and badges",
                mathMasterChallenge: "Math Master Challenge",
                mathChallengeDesc: "Complete 5 math lessons",
                scienceExplorer: "Science Explorer",
                scienceChallengeDesc: "Try 3 science experiments",
                streakKeeper: "Streak Keeper",
                streakChallengeDesc: "Learn for 7 days straight",
                totalPoints: "Total Points",
                nextLevel: "Next level: 2,000 points",
                
                // Digital Library
                selectGrade: "Select Grade Level",
                selectSubject: "Select Subject",
                showAll: "Show all 20",
                showLess: "Show less",
                gamifiedDemo: "Gamified Demo",
                interactivePlaceholder: "Interactive placeholder: mini-games, hints, and progress hooks will be added here.",
                progress: "Progress",
                rating: "Rating:",
                play: "Play",
                preview: "Preview",
                info: "Info",
                chooseGradeLevel: "Choose Grade Level",
                gradeRange: "Pre-K through 12th",
                apply: "Apply",
                
                // Progress & Insights
                learningAnalytics: "Learning Analytics",
                analyticsDesc: "Track your progress and identify areas for improvement",
                learningVelocity: "Learning Velocity",
                performanceByTime: "Performance by Time",
                subjectCorrelation: "Subject Correlation",
                learningPatterns: "Learning Patterns",
                peakLearningTime: "Peak Learning Time",
                peakDesc: "When you learn best",
                averageSession: "Average Session",
                sessionDesc: "Typical study duration",
                retentionRate: "Retention Rate",
                retentionDesc: "How well you remember",
                
                // Admin Panel
                adminAccess: "Admin Access",
                adminDesc: "Enter admin password to access offline accessibility controls",
                enterPassword: "Enter admin password",
                accessAdminPanel: "Access Admin Panel",
                offlineAccessibilityControls: "Offline Accessibility Controls",
                offlineDesc: "Manage offline access for children without internet connectivity",
                contentManagement: "Content Management",
                downloadAllLessons: "Download All Lessons",
                downloadDesc: "Make lessons available offline",
                syncProgressData: "Sync Progress Data",
                syncDesc: "Upload offline progress when online",
                generateOfflinePackage: "Generate Offline Package",
                generateDesc: "Create USB/SD card package",
                accessControl: "Access Control",
                offlineModeStatus: "Offline Mode Status",
                statusDesc: "Current offline access status",
                offlineUsers: "Offline Users",
                usersDesc: "Children using offline access",
                lastSync: "Last Sync",
                syncDesc2: "When data was last synchronized",
                active: "Active",
                offlineContentLibrary: "Offline Content Library",
                libraryDesc: "Manage content available for offline access",
                mathLessons: "Math Lessons",
                mathLessonsDesc: "Basic arithmetic and problem solving",
                scienceLessons: "Science Lessons",
                scienceLessonsDesc: "Basic science concepts and experiments",
                readingMaterials: "Reading Materials",
                readingDesc: "Stories and comprehension exercises",
                enableOffline: "Enable Offline",
                lessons: "lessons",
                books: "books",
                systemSettings: "System Settings",
                offlineSettings: "Offline Settings",
                autoSyncOnline: "Auto-sync when online",
                compressOfflineContent: "Compress offline content",
                enableOfflineAnalytics: "Enable offline analytics",
                accessibilitySettings: "Accessibility Settings",
                highContrastMode: "High contrast mode",
                largeTextSize: "Large text size",
                audioDescriptions: "Audio descriptions",
                
                // Practice Materials
                practiceMaterials: "Practice Materials",
                practiceDesc: "Please select your role in the \"Let's Get Started\" tab to access practice materials.",
                mathPracticeQuiz: "Math Practice Quiz",
                mathQuizDesc: "Addition and Subtraction",
                readingComprehension: "Reading Comprehension",
                readingDesc2: "Understanding Stories",
                startQuiz: "Start Quiz",
                startPractice: "Start Practice",
                
                // Notifications
                notifications: "Notifications",
                newAssignment: "New assignment posted",
                assignmentDesc: "Math - Fractions Practice",
                progressMilestone: "Progress milestone reached",
                milestoneDesc: "Completed 10 lessons this week!",
                practiceReminder: "Practice reminder",
                reminderDesc: "Science quiz due tomorrow",
                
                // Common Actions
                download: "Download",
                sync: "Sync",
                generate: "Generate",
                toggle: "Toggle",
                enable: "Enable",
                disable: "Disable",
                save: "Save",
                cancel: "Cancel",
                confirm: "Confirm",
                close: "Close",
                
                // Platform Features
                platformFeatures: "Platform Features",
                adaptiveLearning: "Adaptive Learning",
                adaptiveLearningDesc: "Personalized difficulty adjustment",
                offlineSupport: "Offline Support",
                offlineSupportDesc: "Learn without internet connection",
                smsLearning: "SMS Learning",
                smsLearningDesc: "Learn via text messages",
                
                // Stats
                lessons: "Lessons",
                books: "Books",
                badges: "Badges",
                streak: "Streak",
                
                // User
                guest: "Guest User",
                role: "guest",
                login: "Login",
                
                // Practice Materials
                practiceMaterials: "Practice Materials",
                practiceDesc: "Please select your role in the \"Let's Get Started\" tab to access practice materials.",
                mathPracticeQuiz: "Math Practice Quiz",
                mathQuizDesc: "Addition and Subtraction",
                readingComprehension: "Reading Comprehension",
                readingDesc2: "Understanding Stories",
                startQuiz: "Start Quiz",
                startPractice: "Start Practice"
            },
            es: {
                // Header & Navigation
                welcome: "Educación de Calidad Accesible",
                welcomeSubtitle: "¡Bienvenido a tu plataforma de aprendizaje!",
                dashboard: "Panel de Control",
                lessons: "¡Empecemos!",
                library: "Biblioteca Digital",
                progress: "Progreso e Información",
                practice: "Materiales de Práctica",
                admin: "Panel de Administración",
                searchPlaceholder: "Buscar lecciones...",
                login: "Iniciar Sesión",
                guest: "Usuario Invitado",
                role: "invitado",
                
                // Hero Section
                heroTitle: "Aprende mejor con una plataforma diseñada para cada estudiante",
                heroSubtitle: "Educación de Calidad Accesible proporciona experiencias de aprendizaje personalizadas para estudiantes, maestros y padres.",
                getStarted: "Comenzar",
                learnMore: "Saber Más",
                
                // Getting Started
                gettingStarted: "Comenzando",
                step1: "Elige Tu Rol",
                step1Desc: "Ve a la pestaña \"¡Empecemos!\" y selecciona tu rol",
                step2: "Acceder al Contenido",
                step2Desc: "Explora lecciones, libros y materiales de práctica",
                step3: "Seguir el Progreso",
                step3Desc: "Monitorea tu viaje de aprendizaje y logros",
                
                // Role Selection
                chooseRole: "Elige Tu Rol",
                roleDesc: "Selecciona tu rol para acceder a experiencias de aprendizaje personalizadas",
                student: "Estudiante",
                studentDesc: "Accede a lecciones, lecturas y sigue tu progreso",
                teacher: "Maestro",
                teacherDesc: "Crea tareas y monitorea el progreso de los estudiantes efectivamente",
                parent: "Padre/Tutor",
                parentDesc: "Sigue el progreso de tu hijo y apoya su aprendizaje",
                admin: "Administrador",
                adminDesc: "Gestiona contenido, usuarios y configuraciones del sistema.",
                
                // Dashboard Content
                yourDashboard: "Tu Panel de Control",
                resumeLearning: "Reanudar Aprendizaje",
                resumeDesc: "Continúa donde lo dejaste",
                achievements: "Logros",
                achievementsDesc: "Tus insignias de aprendizaje",
                learningStreak: "Racha de Aprendizaje",
                streakDesc: "¡Mantén tu impulso!",
                daysInRow: "días seguidos",
                mathMaster: "Maestro de Matemáticas",
                starStudent: "Estudiante Estrella",
                hotStreak: "Racha Caliente",
                continueLesson: "Continuar Lección",
                
                // Dashboard Welcome Section
                welcome: "Educación de Calidad Accesible",
                welcomeDesc: "Educación de Calidad Accesible es tu puerta de entrada a experiencias de aprendizaje personalizadas. Elige tu rol en la pestaña \"¡Empecemos!\" para comenzar tu viaje educativo.",
                forStudents: "Para Estudiantes",
                forStudentsDesc: "Accede a lecciones, sigue tu progreso y gana insignias mientras aprendes.",
                forTeachers: "Para Maestros",
                forTeachersDesc: "Crea tareas y monitorea el progreso de los estudiantes efectivamente.",
                forParents: "Para Padres",
                forParentsDesc: "Apoya el viaje de aprendizaje de tu hijo con información de progreso.",
                forAdmins: "Para Administradores",
                forAdminsDesc: "Gestiona contenido, usuarios y configuraciones del sistema.",
                
                // Learning Challenges
                learningChallenges: "Desafíos de Aprendizaje",
                challengesDesc: "Completa desafíos para ganar puntos e insignias",
                mathMasterChallenge: "Desafío Maestro de Matemáticas",
                mathChallengeDesc: "Completa 5 lecciones de matemáticas",
                scienceExplorer: "Explorador de Ciencias",
                scienceChallengeDesc: "Prueba 3 experimentos de ciencias",
                streakKeeper: "Mantenedor de Racha",
                streakChallengeDesc: "Aprende por 7 días seguidos",
                totalPoints: "Puntos Totales",
                nextLevel: "Siguiente nivel: 2,000 puntos",
                
                // Digital Library
                selectGrade: "Seleccionar Nivel de Grado",
                selectSubject: "Seleccionar Materia",
                showAll: "Mostrar todos los 20",
                showLess: "Mostrar menos",
                gamifiedDemo: "Demo Gamificado",
                interactivePlaceholder: "Marcador de posición interactivo: mini-juegos, pistas y ganchos de progreso se agregarán aquí.",
                progress: "Progreso",
                rating: "Calificación:",
                play: "Jugar",
                preview: "Vista Previa",
                info: "Información",
                
                // Progress & Insights
                learningAnalytics: "Análisis de Aprendizaje",
                analyticsDesc: "Sigue tu progreso e identifica áreas de mejora",
                learningVelocity: "Velocidad de Aprendizaje",
                performanceByTime: "Rendimiento por Tiempo",
                subjectCorrelation: "Correlación de Materias",
                learningPatterns: "Patrones de Aprendizaje",
                peakLearningTime: "Hora Pico de Aprendizaje",
                peakDesc: "Cuándo aprendes mejor",
                averageSession: "Sesión Promedio",
                sessionDesc: "Duración típica de estudio",
                retentionRate: "Tasa de Retención",
                retentionDesc: "Qué tan bien recuerdas",
                
                // Admin Panel
                adminAccess: "Acceso de Administrador",
                adminDesc: "Ingresa la contraseña de administrador para acceder a los controles de accesibilidad sin conexión",
                enterPassword: "Ingresa la contraseña de administrador",
                accessAdminPanel: "Acceder al Panel de Administración",
                offlineAccessibilityControls: "Controles de Accesibilidad Sin Conexión",
                offlineDesc: "Gestiona el acceso sin conexión para niños sin conectividad a internet",
                contentManagement: "Gestión de Contenido",
                downloadAllLessons: "Descargar Todas las Lecciones",
                downloadDesc: "Hacer lecciones disponibles sin conexión",
                syncProgressData: "Sincronizar Datos de Progreso",
                syncDesc: "Subir progreso sin conexión cuando esté en línea",
                generateOfflinePackage: "Generar Paquete Sin Conexión",
                generateDesc: "Crear paquete USB/tarjeta SD",
                accessControl: "Control de Acceso",
                offlineModeStatus: "Estado del Modo Sin Conexión",
                statusDesc: "Estado actual del acceso sin conexión",
                offlineUsers: "Usuarios Sin Conexión",
                usersDesc: "Niños usando acceso sin conexión",
                lastSync: "Última Sincronización",
                syncDesc2: "Cuándo se sincronizaron los datos por última vez",
                active: "Activo",
                offlineContentLibrary: "Biblioteca de Contenido Sin Conexión",
                libraryDesc: "Gestiona contenido disponible para acceso sin conexión",
                mathLessons: "Lecciones de Matemáticas",
                mathLessonsDesc: "Aritmética básica y resolución de problemas",
                scienceLessons: "Lecciones de Ciencias",
                scienceLessonsDesc: "Conceptos básicos de ciencias y experimentos",
                readingMaterials: "Materiales de Lectura",
                readingDesc: "Historias y ejercicios de comprensión",
                enableOffline: "Habilitar Sin Conexión",
                lessons: "lecciones",
                books: "libros",
                systemSettings: "Configuraciones del Sistema",
                offlineSettings: "Configuraciones Sin Conexión",
                autoSyncOnline: "Auto-sincronizar cuando esté en línea",
                compressOfflineContent: "Comprimir contenido sin conexión",
                enableOfflineAnalytics: "Habilitar análisis sin conexión",
                accessibilitySettings: "Configuraciones de Accesibilidad",
                highContrastMode: "Modo de alto contraste",
                largeTextSize: "Tamaño de texto grande",
                audioDescriptions: "Descripciones de audio",
                
                // Practice Materials
                practiceMaterials: "Materiales de Práctica",
                practiceDesc: "Por favor selecciona tu rol en la pestaña \"¡Empecemos!\" para acceder a materiales de práctica.",
                mathPracticeQuiz: "Cuestionario de Práctica de Matemáticas",
                mathQuizDesc: "Suma y Resta",
                readingComprehension: "Comprensión de Lectura",
                readingDesc2: "Entendiendo Historias",
                startQuiz: "Comenzar Cuestionario",
                startPractice: "Comenzar Práctica",
                
                // Notifications
                notifications: "Notificaciones",
                newAssignment: "Nueva tarea publicada",
                assignmentDesc: "Matemáticas - Práctica de Fracciones",
                progressMilestone: "Hito de progreso alcanzado",
                milestoneDesc: "¡Completaste 10 lecciones esta semana!",
                practiceReminder: "Recordatorio de práctica",
                reminderDesc: "Cuestionario de ciencias debido mañana",
                
                // Common Actions
                download: "Descargar",
                sync: "Sincronizar",
                generate: "Generar",
                toggle: "Alternar",
                enable: "Habilitar",
                disable: "Deshabilitar",
                save: "Guardar",
                cancel: "Cancelar",
                confirm: "Confirmar",
                close: "Cerrar",
                
                // Platform Features
                platformFeatures: "Características de la Plataforma",
                adaptiveLearning: "Aprendizaje Adaptativo",
                adaptiveLearningDesc: "Ajuste personalizado de dificultad",
                offlineSupport: "Soporte Sin Conexión",
                offlineSupportDesc: "Aprende sin conexión a internet",
                smsLearning: "Aprendizaje por SMS",
                smsLearningDesc: "Aprende por mensajes de texto",
                
                // Stats
                lessons: "Lecciones",
                books: "Libros",
                badges: "Insignias",
                streak: "Racha",
                
                // User
                guest: "Usuario Invitado",
                role: "invitado",
                login: "Iniciar Sesión",
                
                // Practice Materials
                practiceMaterials: "Materiales de Práctica",
                practiceDesc: "Por favor selecciona tu rol en la pestaña \"¡Empecemos!\" para acceder a materiales de práctica.",
                mathPracticeQuiz: "Cuestionario de Práctica de Matemáticas",
                mathQuizDesc: "Suma y Resta",
                readingComprehension: "Comprensión de Lectura",
                readingDesc2: "Entendiendo Historias",
                startQuiz: "Comenzar Cuestionario",
                startPractice: "Comenzar Práctica"
            },
            fr: {
                // Header & Navigation
                welcome: "Éducation de Qualité Accessible",
                welcomeSubtitle: "Bienvenue sur votre plateforme d'apprentissage!",
                dashboard: "Tableau de Bord",
                lessons: "Commençons !",
                library: "Bibliothèque Numérique",
                progress: "Progrès et Informations",
                practice: "Matériaux de Pratique",
                admin: "Panneau d'Administration",
                searchPlaceholder: "Rechercher des leçons...",
                login: "Connexion",
                guest: "Utilisateur Invité",
                role: "invité",
                
                // Hero Section
                heroTitle: "Apprenez mieux avec une plateforme conçue pour chaque apprenant",
                heroSubtitle: "L'Éducation de Qualité Accessible fournit des expériences d'apprentissage personnalisées pour les étudiants, enseignants et parents.",
                getStarted: "Commencer",
                learnMore: "En Savoir Plus",
                
                // Getting Started
                gettingStarted: "Commencer",
                step1: "Choisir Votre Rôle",
                step1Desc: "Allez à l'onglet \"Commençons!\" et sélectionnez votre rôle",
                step2: "Accéder au Contenu",
                step2Desc: "Parcourez les leçons, livres et matériaux de pratique",
                step3: "Suivre les Progrès",
                step3Desc: "Surveillez votre parcours d'apprentissage et vos réalisations",
                
                // Role Selection
                chooseRole: "Choisir Votre Rôle",
                roleDesc: "Sélectionnez votre rôle pour accéder à des expériences d'apprentissage personnalisées",
                student: "Étudiant",
                studentDesc: "Accédez aux leçons, lectures et suivez vos progrès",
                teacher: "Enseignant",
                teacherDesc: "Créez des devoirs et surveillez efficacement les progrès des étudiants",
                parent: "Parent/Tuteur",
                parentDesc: "Suivez les progrès de votre enfant et soutenez son apprentissage",
                admin: "Administrateur",
                adminDesc: "Gérez le contenu, les utilisateurs et les paramètres du système.",
                
                // Dashboard Content
                yourDashboard: "Votre Tableau de Bord",
                resumeLearning: "Reprendre l'Apprentissage",
                resumeDesc: "Continuez où vous vous êtes arrêté",
                achievements: "Réalisations",
                achievementsDesc: "Vos badges d'apprentissage",
                learningStreak: "Série d'Apprentissage",
                streakDesc: "Gardez votre élan!",
                daysInRow: "jours consécutifs",
                mathMaster: "Maître des Mathématiques",
                starStudent: "Étudiant Étoile",
                hotStreak: "Série Chaude",
                continueLesson: "Continuer la Leçon",
                
                // Learning Challenges
                learningChallenges: "Défis d'Apprentissage",
                challengesDesc: "Complétez des défis pour gagner des points et des badges",
                mathMasterChallenge: "Défi Maître des Mathématiques",
                mathChallengeDesc: "Complétez 5 leçons de mathématiques",
                scienceExplorer: "Explorateur des Sciences",
                scienceChallengeDesc: "Essayez 3 expériences scientifiques",
                streakKeeper: "Gardien de Série",
                streakChallengeDesc: "Apprenez pendant 7 jours consécutifs",
                totalPoints: "Points Totaux",
                nextLevel: "Niveau suivant: 2,000 points",
                
                // Digital Library
                selectGrade: "Sélectionner le Niveau",
                selectSubject: "Sélectionner la Matière",
                showAll: "Afficher tous les 20",
                showLess: "Afficher moins",
                gamifiedDemo: "Démo Gamifiée",
                interactivePlaceholder: "Espace réservé interactif: mini-jeux, indices et crochets de progression seront ajoutés ici.",
                progress: "Progrès",
                rating: "Note:",
                play: "Jouer",
                preview: "Aperçu",
                info: "Info",
                
                // Progress & Insights
                learningAnalytics: "Analyses d'Apprentissage",
                analyticsDesc: "Suivez vos progrès et identifiez les domaines d'amélioration",
                learningVelocity: "Vélocité d'Apprentissage",
                performanceByTime: "Performance par Temps",
                subjectCorrelation: "Corrélation des Matières",
                learningPatterns: "Modèles d'Apprentissage",
                peakLearningTime: "Heure de Pointe d'Apprentissage",
                peakDesc: "Quand vous apprenez le mieux",
                averageSession: "Session Moyenne",
                sessionDesc: "Durée typique d'étude",
                retentionRate: "Taux de Rétention",
                retentionDesc: "À quel point vous vous souvenez",
                
                // Admin Panel
                adminAccess: "Accès Administrateur",
                adminDesc: "Entrez le mot de passe administrateur pour accéder aux contrôles d'accessibilité hors ligne",
                enterPassword: "Entrez le mot de passe administrateur",
                accessAdminPanel: "Accéder au Panneau d'Administration",
                offlineAccessibilityControls: "Contrôles d'Accessibilité Hors Ligne",
                offlineDesc: "Gérez l'accès hors ligne pour les enfants sans connectivité internet",
                contentManagement: "Gestion du Contenu",
                downloadAllLessons: "Télécharger Toutes les Leçons",
                downloadDesc: "Rendre les leçons disponibles hors ligne",
                syncProgressData: "Synchroniser les Données de Progrès",
                syncDesc: "Télécharger le progrès hors ligne quand en ligne",
                generateOfflinePackage: "Générer un Paquet Hors Ligne",
                generateDesc: "Créer un paquet USB/carte SD",
                accessControl: "Contrôle d'Accès",
                offlineModeStatus: "Statut du Mode Hors Ligne",
                statusDesc: "Statut actuel de l'accès hors ligne",
                offlineUsers: "Utilisateurs Hors Ligne",
                usersDesc: "Enfants utilisant l'accès hors ligne",
                lastSync: "Dernière Synchronisation",
                syncDesc2: "Quand les données ont été synchronisées pour la dernière fois",
                active: "Actif",
                offlineContentLibrary: "Bibliothèque de Contenu Hors Ligne",
                libraryDesc: "Gérez le contenu disponible pour l'accès hors ligne",
                mathLessons: "Leçons de Mathématiques",
                mathLessonsDesc: "Arithmétique de base et résolution de problèmes",
                scienceLessons: "Leçons de Sciences",
                scienceLessonsDesc: "Concepts scientifiques de base et expériences",
                readingMaterials: "Matériaux de Lecture",
                readingDesc: "Histoires et exercices de compréhension",
                enableOffline: "Activer Hors Ligne",
                lessons: "leçons",
                books: "livres",
                systemSettings: "Paramètres du Système",
                offlineSettings: "Paramètres Hors Ligne",
                autoSyncOnline: "Auto-synchroniser quand en ligne",
                compressOfflineContent: "Compresser le contenu hors ligne",
                enableOfflineAnalytics: "Activer les analyses hors ligne",
                accessibilitySettings: "Paramètres d'Accessibilité",
                highContrastMode: "Mode haut contraste",
                largeTextSize: "Taille de texte grande",
                audioDescriptions: "Descriptions audio",
                
                // Practice Materials
                practiceMaterials: "Matériaux de Pratique",
                practiceDesc: "Veuillez sélectionner votre rôle dans l'onglet \"Commençons!\" pour accéder aux matériaux de pratique.",
                mathPracticeQuiz: "Quiz de Pratique de Mathématiques",
                mathQuizDesc: "Addition et Soustraction",
                readingComprehension: "Compréhension de Lecture",
                readingDesc2: "Comprendre les Histoires",
                startQuiz: "Commencer le Quiz",
                startPractice: "Commencer la Pratique",
                
                // Notifications
                notifications: "Notifications",
                newAssignment: "Nouveau devoir publié",
                assignmentDesc: "Mathématiques - Pratique des Fractions",
                progressMilestone: "Jalon de progrès atteint",
                milestoneDesc: "Complété 10 leçons cette semaine!",
                practiceReminder: "Rappel de pratique",
                reminderDesc: "Quiz de sciences dû demain",
                
                // Common Actions
                download: "Télécharger",
                sync: "Synchroniser",
                generate: "Générer",
                toggle: "Basculer",
                enable: "Activer",
                disable: "Désactiver",
                save: "Sauvegarder",
                cancel: "Annuler",
                confirm: "Confirmer",
                close: "Fermer",
                
                // Dashboard Welcome Section
                welcome: "Éducation de Qualité Accessible",
                welcomeDesc: "L'Éducation de Qualité Accessible est votre passerelle vers des expériences d'apprentissage personnalisées. Choisissez votre rôle dans l'onglet \"Commençons!\" pour commencer votre parcours éducatif.",
                forStudents: "Pour les Étudiants",
                forStudentsDesc: "Accédez aux leçons, suivez vos progrès et gagnez des badges en apprenant.",
                forTeachers: "Pour les Enseignants",
                forTeachersDesc: "Créez des devoirs et surveillez efficacement les progrès des étudiants.",
                forParents: "Pour les Parents",
                forParentsDesc: "Soutenez le parcours d'apprentissage de votre enfant avec des informations de progrès.",
                forAdmins: "Pour les Administrateurs",
                forAdminsDesc: "Gérez le contenu, les utilisateurs et les paramètres du système.",
                
                // Platform Features
                platformFeatures: "Fonctionnalités de la Plateforme",
                adaptiveLearning: "Apprentissage Adaptatif",
                adaptiveLearningDesc: "Ajustement personnalisé de la difficulté",
                offlineSupport: "Support Hors Ligne",
                offlineSupportDesc: "Apprenez sans connexion internet",
                smsLearning: "Apprentissage par SMS",
                smsLearningDesc: "Apprenez par messages texte",
                
                // Stats
                lessons: "Leçons",
                books: "Livres",
                badges: "Badges",
                streak: "Série",
                
                // User
                guest: "Utilisateur Invité",
                role: "invité",
                login: "Connexion",
                
                // Practice Materials
                practiceMaterials: "Matériaux de Pratique",
                practiceDesc: "Veuillez sélectionner votre rôle dans l'onglet \"Commençons!\" pour accéder aux matériaux de pratique.",
                mathPracticeQuiz: "Quiz de Pratique de Mathématiques",
                mathQuizDesc: "Addition et Soustraction",
                readingComprehension: "Compréhension de Lecture",
                readingDesc2: "Comprendre les Histoires",
                startQuiz: "Commencer le Quiz",
                startPractice: "Commencer la Pratique"
            },
            de: {
                // Header & Navigation
                welcome: "Zugängliche Qualitätsbildung",
                welcomeSubtitle: "Willkommen auf Ihrer Lernplattform!",
                dashboard: "Dashboard",
                lessons: "Lass uns anfangen!",
                library: "Digitale Bibliothek",
                progress: "Fortschritt & Einblicke",
                practice: "Übungsmaterialien",
                admin: "Admin-Panel",
                searchPlaceholder: "Lektionen suchen...",
                login: "Anmelden",
                guest: "Gastbenutzer",
                role: "gast",
                
                // Hero Section
                heroTitle: "Lernen Sie besser mit einer Plattform, die für jeden Lernenden entwickelt wurde",
                heroSubtitle: "Zugängliche Qualitätsbildung bietet personalisierte Lernerfahrungen für Schüler, Lehrer und Eltern.",
                getStarted: "Loslegen",
                learnMore: "Mehr Erfahren",
                
                // Getting Started
                gettingStarted: "Erste Schritte",
                step1: "Wählen Sie Ihre Rolle",
                step1Desc: "Gehen Sie zum Tab \"Lass uns anfangen!\" und wählen Sie Ihre Rolle",
                step2: "Auf Inhalte Zugreifen",
                step2Desc: "Durchsuchen Sie Lektionen, Bücher und Übungsmaterialien",
                step3: "Fortschritt Verfolgen",
                step3Desc: "Überwachen Sie Ihre Lernreise und Erfolge",
                
                // Role Selection
                chooseRole: "Wählen Sie Ihre Rolle",
                roleDesc: "Wählen Sie Ihre Rolle, um auf personalisierte Lernerfahrungen zuzugreifen",
                student: "Schüler",
                studentDesc: "Zugriff auf Lektionen, Lektüren und Verfolgung Ihres Fortschritts",
                teacher: "Lehrer",
                teacherDesc: "Erstellen Sie Aufgaben und überwachen Sie den Schülerfortschritt effektiv",
                parent: "Eltern/Betreuer",
                parentDesc: "Verfolgen Sie den Fortschritt Ihres Kindes und unterstützen Sie sein Lernen",
                admin: "Administrator",
                adminDesc: "Verwalten Sie Inhalte, Benutzer und Systemeinstellungen.",
                
                // Dashboard Content
                yourDashboard: "Ihr Dashboard",
                resumeLearning: "Lernen Fortsetzen",
                resumeDesc: "Setzen Sie dort fort, wo Sie aufgehört haben",
                achievements: "Erfolge",
                achievementsDesc: "Ihre Lernabzeichen",
                learningStreak: "Lernserie",
                streakDesc: "Behalten Sie Ihren Schwung bei!",
                daysInRow: "Tage hintereinander",
                mathMaster: "Mathe-Meister",
                starStudent: "Star-Schüler",
                hotStreak: "Heiße Serie",
                continueLesson: "Lektion Fortsetzen",
                
                // Learning Challenges
                learningChallenges: "Lernherausforderungen",
                challengesDesc: "Vervollständigen Sie Herausforderungen, um Punkte und Abzeichen zu verdienen",
                mathMasterChallenge: "Mathe-Meister-Herausforderung",
                mathChallengeDesc: "Vervollständigen Sie 5 Mathe-Lektionen",
                scienceExplorer: "Wissenschafts-Entdecker",
                scienceChallengeDesc: "Versuchen Sie 3 Wissenschaftsexperimente",
                streakKeeper: "Serien-Hüter",
                streakChallengeDesc: "Lernen Sie 7 Tage hintereinander",
                totalPoints: "Gesamtpunkte",
                nextLevel: "Nächstes Level: 2.000 Punkte",
                
                // Digital Library
                selectGrade: "Klassenstufe Auswählen",
                selectSubject: "Fach Auswählen",
                showAll: "Alle 20 anzeigen",
                showLess: "Weniger anzeigen",
                gamifiedDemo: "Gamifizierte Demo",
                interactivePlaceholder: "Interaktiver Platzhalter: Mini-Spiele, Hinweise und Fortschritts-Hooks werden hier hinzugefügt.",
                progress: "Fortschritt",
                rating: "Bewertung:",
                play: "Spielen",
                preview: "Vorschau",
                info: "Info",
                
                // Progress & Insights
                learningAnalytics: "Lernanalysen",
                analyticsDesc: "Verfolgen Sie Ihren Fortschritt und identifizieren Sie Verbesserungsbereiche",
                learningVelocity: "Lerngeschwindigkeit",
                performanceByTime: "Leistung nach Zeit",
                subjectCorrelation: "Fach-Korrelation",
                learningPatterns: "Lernmuster",
                peakLearningTime: "Hauptlernzeit",
                peakDesc: "Wann Sie am besten lernen",
                averageSession: "Durchschnittliche Sitzung",
                sessionDesc: "Typische Studienzeit",
                retentionRate: "Behaltensrate",
                retentionDesc: "Wie gut Sie sich erinnern",
                
                // Admin Panel
                adminAccess: "Admin-Zugang",
                adminDesc: "Geben Sie das Admin-Passwort ein, um auf Offline-Zugänglichkeitssteuerungen zuzugreifen",
                enterPassword: "Admin-Passwort eingeben",
                accessAdminPanel: "Auf Admin-Panel Zugreifen",
                offlineAccessibilityControls: "Offline-Zugänglichkeitssteuerungen",
                offlineDesc: "Verwalten Sie Offline-Zugang für Kinder ohne Internetverbindung",
                contentManagement: "Inhaltsverwaltung",
                downloadAllLessons: "Alle Lektionen Herunterladen",
                downloadDesc: "Lektionen offline verfügbar machen",
                syncProgressData: "Fortschrittsdaten Synchronisieren",
                syncDesc: "Offline-Fortschritt hochladen, wenn online",
                generateOfflinePackage: "Offline-Paket Generieren",
                generateDesc: "USB/SD-Karten-Paket erstellen",
                accessControl: "Zugangskontrolle",
                offlineModeStatus: "Offline-Modus-Status",
                statusDesc: "Aktueller Offline-Zugangsstatus",
                offlineUsers: "Offline-Benutzer",
                usersDesc: "Kinder, die Offline-Zugang nutzen",
                lastSync: "Letzte Synchronisation",
                syncDesc2: "Wann Daten zuletzt synchronisiert wurden",
                active: "Aktiv",
                offlineContentLibrary: "Offline-Inhaltsbibliothek",
                libraryDesc: "Verwalten Sie Inhalte, die für Offline-Zugang verfügbar sind",
                mathLessons: "Mathe-Lektionen",
                mathLessonsDesc: "Grundrechenarten und Problemlösung",
                scienceLessons: "Wissenschafts-Lektionen",
                scienceLessonsDesc: "Grundlegende Wissenschaftskonzepte und Experimente",
                readingMaterials: "Lese-Materialien",
                readingDesc: "Geschichten und Verständnisübungen",
                enableOffline: "Offline Aktivieren",
                lessons: "Lektionen",
                books: "Bücher",
                systemSettings: "Systemeinstellungen",
                offlineSettings: "Offline-Einstellungen",
                autoSyncOnline: "Auto-Sync wenn online",
                compressOfflineContent: "Offline-Inhalt komprimieren",
                enableOfflineAnalytics: "Offline-Analysen aktivieren",
                accessibilitySettings: "Zugänglichkeitseinstellungen",
                highContrastMode: "Hoher Kontrast-Modus",
                largeTextSize: "Große Textgröße",
                audioDescriptions: "Audio-Beschreibungen",
                
                // Practice Materials
                practiceMaterials: "Übungsmaterialien",
                practiceDesc: "Bitte wählen Sie Ihre Rolle im Tab \"Lass uns anfangen!\", um auf Übungsmaterialien zuzugreifen.",
                mathPracticeQuiz: "Mathe-Übungsquiz",
                mathQuizDesc: "Addition und Subtraktion",
                readingComprehension: "Leseverständnis",
                readingDesc2: "Geschichten Verstehen",
                startQuiz: "Quiz Starten",
                startPractice: "Übung Starten",
                
                // Notifications
                notifications: "Benachrichtigungen",
                newAssignment: "Neue Aufgabe veröffentlicht",
                assignmentDesc: "Mathe - Bruchrechnung",
                progressMilestone: "Fortschritts-Meilenstein erreicht",
                milestoneDesc: "10 Lektionen diese Woche abgeschlossen!",
                practiceReminder: "Übungserinnerung",
                reminderDesc: "Wissenschafts-Quiz morgen fällig",
                
                // Common Actions
                download: "Herunterladen",
                sync: "Synchronisieren",
                generate: "Generieren",
                toggle: "Umschalten",
                enable: "Aktivieren",
                disable: "Deaktivieren",
                save: "Speichern",
                cancel: "Abbrechen",
                confirm: "Bestätigen",
                close: "Schließen",
                
                // Dashboard Welcome Section
                welcome: "Zugängliche Qualitätsbildung",
                welcomeDesc: "Zugängliche Qualitätsbildung ist Ihr Tor zu personalisierten Lernerfahrungen. Wählen Sie Ihre Rolle im Tab \"Lass uns anfangen!\", um Ihre Bildungsreise zu beginnen.",
                forStudents: "Für Studenten",
                forStudentsDesc: "Greifen Sie auf Lektionen zu, verfolgen Sie Ihren Fortschritt und verdienen Sie Abzeichen beim Lernen.",
                forTeachers: "Für Lehrer",
                forTeachersDesc: "Erstellen Sie Aufgaben und überwachen Sie den Fortschritt der Studenten effektiv.",
                forParents: "Für Eltern",
                forParentsDesc: "Unterstützen Sie die Lernreise Ihres Kindes mit Fortschrittsinformationen.",
                forAdmins: "Für Administratoren",
                forAdminsDesc: "Verwalten Sie Inhalte, Benutzer und Systemeinstellungen.",
                
                // Platform Features
                platformFeatures: "Plattform-Funktionen",
                adaptiveLearning: "Adaptives Lernen",
                adaptiveLearningDesc: "Personalisierte Schwierigkeitsanpassung",
                offlineSupport: "Offline-Unterstützung",
                offlineSupportDesc: "Lernen ohne Internetverbindung",
                smsLearning: "SMS-Lernen",
                smsLearningDesc: "Lernen per Textnachrichten",
                
                // Stats
                lessons: "Lektionen",
                books: "Bücher",
                badges: "Abzeichen",
                streak: "Serie",
                
                // User
                guest: "Gastbenutzer",
                role: "gast",
                login: "Anmelden",
                
                // Practice Materials
                practiceMaterials: "Übungsmaterialien",
                practiceDesc: "Bitte wählen Sie Ihre Rolle im Tab \"Lass uns anfangen!\", um auf Übungsmaterialien zuzugreifen.",
                mathPracticeQuiz: "Mathe-Übungsquiz",
                mathQuizDesc: "Addition und Subtraktion",
                readingComprehension: "Leseverständnis",
                readingDesc2: "Geschichten Verstehen",
                startQuiz: "Quiz Starten",
                startPractice: "Übung Starten"
            },
            zh: {
                // Header & Navigation
                welcome: "无障碍优质教育",
                welcomeSubtitle: "欢迎来到您的学习平台！",
                dashboard: "仪表板",
                lessons: "让我们开始吧！",
                library: "数字图书馆",
                progress: "进度与洞察",
                practice: "练习材料",
                admin: "管理面板",
                searchPlaceholder: "搜索课程...",
                login: "登录",
                guest: "访客用户",
                role: "访客",
                
                // Hero Section
                heroTitle: "通过为每个学习者设计的平台更好地学习",
                heroSubtitle: "无障碍优质教育为学生、教师和家长提供个性化学习体验。",
                getStarted: "开始",
                learnMore: "了解更多",
                
                // Getting Started
                gettingStarted: "开始使用",
                step1: "选择您的角色",
                step1Desc: "转到\"让我们开始\"标签并选择您的角色",
                step2: "访问内容",
                step2Desc: "浏览课程、书籍和练习材料",
                step3: "跟踪进度",
                step3Desc: "监控您的学习之旅和成就",
                
                // Role Selection
                chooseRole: "选择您的角色",
                roleDesc: "选择您的角色以访问个性化学习体验",
                student: "学生",
                studentDesc: "访问课程、阅读材料并跟踪您的进度",
                teacher: "教师",
                teacherDesc: "创建作业并有效监控学生进度",
                parent: "家长/监护人",
                parentDesc: "跟踪您孩子的进度并支持他们的学习",
                admin: "管理员",
                adminDesc: "管理内容、用户和系统设置。",
                
                // Dashboard Content
                yourDashboard: "您的仪表板",
                resumeLearning: "继续学习",
                resumeDesc: "从您离开的地方继续",
                achievements: "成就",
                achievementsDesc: "您的学习徽章",
                learningStreak: "学习连胜",
                streakDesc: "保持您的动力！",
                daysInRow: "连续天数",
                mathMaster: "数学大师",
                starStudent: "明星学生",
                hotStreak: "火热连胜",
                continueLesson: "继续课程",
                
                // Learning Challenges
                learningChallenges: "学习挑战",
                challengesDesc: "完成挑战以赚取积分和徽章",
                mathMasterChallenge: "数学大师挑战",
                mathChallengeDesc: "完成5节数学课",
                scienceExplorer: "科学探索者",
                scienceChallengeDesc: "尝试3个科学实验",
                streakKeeper: "连胜保持者",
                streakChallengeDesc: "连续学习7天",
                totalPoints: "总积分",
                nextLevel: "下一级：2,000积分",
                
                // Digital Library
                selectGrade: "选择年级",
                selectSubject: "选择科目",
                showAll: "显示全部20个",
                showLess: "显示较少",
                gamifiedDemo: "游戏化演示",
                interactivePlaceholder: "交互式占位符：将在此处添加迷你游戏、提示和进度钩子。",
                progress: "进度",
                rating: "评分：",
                play: "播放",
                preview: "预览",
                info: "信息",
                
                // Progress & Insights
                learningAnalytics: "学习分析",
                analyticsDesc: "跟踪您的进度并识别改进领域",
                learningVelocity: "学习速度",
                performanceByTime: "按时间表现",
                subjectCorrelation: "科目相关性",
                learningPatterns: "学习模式",
                peakLearningTime: "最佳学习时间",
                peakDesc: "您学习最好的时候",
                averageSession: "平均会话",
                sessionDesc: "典型学习时长",
                retentionRate: "记忆率",
                retentionDesc: "您记忆的程度",
                
                // Admin Panel
                adminAccess: "管理员访问",
                adminDesc: "输入管理员密码以访问离线可访问性控制",
                enterPassword: "输入管理员密码",
                accessAdminPanel: "访问管理面板",
                offlineAccessibilityControls: "离线可访问性控制",
                offlineDesc: "管理无互联网连接儿童的离线访问",
                contentManagement: "内容管理",
                downloadAllLessons: "下载所有课程",
                downloadDesc: "使课程离线可用",
                syncProgressData: "同步进度数据",
                syncDesc: "在线时上传离线进度",
                generateOfflinePackage: "生成离线包",
                generateDesc: "创建USB/SD卡包",
                accessControl: "访问控制",
                offlineModeStatus: "离线模式状态",
                statusDesc: "当前离线访问状态",
                offlineUsers: "离线用户",
                usersDesc: "使用离线访问的儿童",
                lastSync: "最后同步",
                syncDesc2: "数据最后同步时间",
                active: "活跃",
                offlineContentLibrary: "离线内容库",
                libraryDesc: "管理可用于离线访问的内容",
                mathLessons: "数学课程",
                mathLessonsDesc: "基础算术和问题解决",
                scienceLessons: "科学课程",
                scienceLessonsDesc: "基础科学概念和实验",
                readingMaterials: "阅读材料",
                readingDesc: "故事和理解练习",
                enableOffline: "启用离线",
                lessons: "课程",
                books: "书籍",
                systemSettings: "系统设置",
                offlineSettings: "离线设置",
                autoSyncOnline: "在线时自动同步",
                compressOfflineContent: "压缩离线内容",
                enableOfflineAnalytics: "启用离线分析",
                accessibilitySettings: "可访问性设置",
                highContrastMode: "高对比度模式",
                largeTextSize: "大文本大小",
                audioDescriptions: "音频描述",
                
                // Practice Materials
                practiceMaterials: "练习材料",
                practiceDesc: "请在\"让我们开始\"标签中选择您的角色以访问练习材料。",
                mathPracticeQuiz: "数学练习测验",
                mathQuizDesc: "加法和减法",
                readingComprehension: "阅读理解",
                readingDesc2: "理解故事",
                startQuiz: "开始测验",
                startPractice: "开始练习",
                
                // Notifications
                notifications: "通知",
                newAssignment: "新作业发布",
                assignmentDesc: "数学 - 分数练习",
                progressMilestone: "进度里程碑达成",
                milestoneDesc: "本周完成了10节课！",
                practiceReminder: "练习提醒",
                reminderDesc: "科学测验明天到期",
                
                // Common Actions
                download: "下载",
                sync: "同步",
                generate: "生成",
                toggle: "切换",
                enable: "启用",
                disable: "禁用",
                save: "保存",
                cancel: "取消",
                confirm: "确认",
                close: "关闭",
                
                // Dashboard Welcome Section
                welcome: "无障碍优质教育",
                welcomeDesc: "无障碍优质教育是您通往个性化学习体验的门户。在\"让我们开始\"标签中选择您的角色，开始您的教育之旅。",
                forStudents: "为学生",
                forStudentsDesc: "访问课程，跟踪进度，在学习中获得徽章。",
                forTeachers: "为教师",
                forTeachersDesc: "创建作业并有效监控学生进度。",
                forParents: "为家长",
                forParentsDesc: "通过进度洞察支持您孩子的学习之旅。",
                forAdmins: "为管理员",
                forAdminsDesc: "管理内容、用户和系统设置。",
                
                // Platform Features
                platformFeatures: "平台功能",
                adaptiveLearning: "自适应学习",
                adaptiveLearningDesc: "个性化难度调整",
                offlineSupport: "离线支持",
                offlineSupportDesc: "无需网络连接即可学习",
                smsLearning: "短信学习",
                smsLearningDesc: "通过短信学习",
                
                // Stats
                lessons: "课程",
                books: "书籍",
                badges: "徽章",
                streak: "连续",
                
                // User
                guest: "访客用户",
                role: "访客",
                login: "登录",
                
                // Practice Materials
                practiceMaterials: "练习材料",
                practiceDesc: "请在\"让我们开始\"标签中选择您的角色以访问练习材料。",
                mathPracticeQuiz: "数学练习测验",
                mathQuizDesc: "加法和减法",
                readingComprehension: "阅读理解",
                readingDesc2: "理解故事",
                startQuiz: "开始测验",
                startPractice: "开始练习"
            },
            ar: {
                // Header & Navigation
                welcome: "التعليم الجيد الميسر",
                welcomeSubtitle: "مرحباً بك في منصة التعلم الخاصة بك!",
                dashboard: "لوحة التحكم",
                lessons: "دعنا نبدأ!",
                library: "المكتبة الرقمية",
                progress: "التقدم والرؤى",
                practice: "مواد التدريب",
                admin: "لوحة الإدارة",
                searchPlaceholder: "البحث في الدروس...",
                login: "تسجيل الدخول",
                guest: "مستخدم ضيف",
                role: "ضيف",
                
                // Hero Section
                heroTitle: "تعلم بشكل أفضل مع منصة مصممة لكل متعلم",
                heroSubtitle: "التعليم الجيد المتاح يوفر تجارب تعلم مخصصة للطلاب والمعلمين وأولياء الأمور.",
                getStarted: "ابدأ",
                learnMore: "اعرف المزيد",
                
                // Getting Started
                gettingStarted: "البدء",
                step1: "اختر دورك",
                step1Desc: "اذهب إلى تبويب \"دعنا نبدأ\" واختر دورك",
                step2: "الوصول للمحتوى",
                step2Desc: "تصفح الدروس والكتب ومواد التدريب",
                step3: "تتبع التقدم",
                step3Desc: "راقب رحلة التعلم وإنجازاتك",
                
                // Role Selection
                chooseRole: "اختر دورك",
                roleDesc: "اختر دورك للوصول إلى تجارب تعلم مخصصة",
                student: "طالب",
                studentDesc: "الوصول إلى الدروس والقراءات وتتبع تقدمك",
                teacher: "معلم",
                teacherDesc: "إنشاء المهام ومراقبة تقدم الطلاب بفعالية",
                parent: "ولي أمر/وصي",
                parentDesc: "تتبع تقدم طفلك ودعم تعلمه",
                admin: "مدير",
                adminDesc: "إدارة المحتوى والمستخدمين وإعدادات النظام.",
                
                // Dashboard Content
                yourDashboard: "لوحة التحكم الخاصة بك",
                resumeLearning: "استئناف التعلم",
                resumeDesc: "استمر من حيث توقفت",
                achievements: "الإنجازات",
                achievementsDesc: "شارات التعلم الخاصة بك",
                learningStreak: "سلسلة التعلم",
                streakDesc: "حافظ على زخمك!",
                daysInRow: "أيام متتالية",
                mathMaster: "سيد الرياضيات",
                starStudent: "الطالب المتميز",
                hotStreak: "السلسلة الساخنة",
                continueLesson: "متابعة الدرس",
                
                // Learning Challenges
                learningChallenges: "تحديات التعلم",
                challengesDesc: "أكمل التحديات لكسب النقاط والشارات",
                mathMasterChallenge: "تحدي سيد الرياضيات",
                mathChallengeDesc: "أكمل 5 دروس رياضيات",
                scienceExplorer: "مستكشف العلوم",
                scienceChallengeDesc: "جرب 3 تجارب علمية",
                streakKeeper: "حافظ السلسلة",
                streakChallengeDesc: "تعلم لمدة 7 أيام متتالية",
                totalPoints: "إجمالي النقاط",
                nextLevel: "المستوى التالي: 2,000 نقطة",
                
                // Digital Library
                selectGrade: "اختر مستوى الصف",
                selectSubject: "اختر المادة",
                showAll: "إظهار جميع الـ20",
                showLess: "إظهار أقل",
                gamifiedDemo: "عرض تجريبي ممتع",
                interactivePlaceholder: "عنصر نائب تفاعلي: ستتم إضافة ألعاب مصغرة وتلميحات وخطافات التقدم هنا.",
                progress: "التقدم",
                rating: "التقييم:",
                play: "تشغيل",
                preview: "معاينة",
                info: "معلومات",
                
                // Progress & Insights
                learningAnalytics: "تحليلات التعلم",
                analyticsDesc: "تتبع تقدمك وتحديد مجالات التحسين",
                learningVelocity: "سرعة التعلم",
                performanceByTime: "الأداء حسب الوقت",
                subjectCorrelation: "ارتباط المواد",
                learningPatterns: "أنماط التعلم",
                peakLearningTime: "وقت الذروة للتعلم",
                peakDesc: "متى تتعلم بشكل أفضل",
                averageSession: "الجلسة المتوسطة",
                sessionDesc: "مدة الدراسة النموذجية",
                retentionRate: "معدل الاستبقاء",
                retentionDesc: "مدى تذكرك",
                
                // Admin Panel
                adminAccess: "وصول الإدارة",
                adminDesc: "أدخل كلمة مرور الإدارة للوصول إلى عناصر التحكم في إمكانية الوصول دون اتصال",
                enterPassword: "أدخل كلمة مرور الإدارة",
                accessAdminPanel: "الوصول إلى لوحة الإدارة",
                offlineAccessibilityControls: "عناصر التحكم في إمكانية الوصول دون اتصال",
                offlineDesc: "إدارة الوصول دون اتصال للأطفال بدون اتصال بالإنترنت",
                contentManagement: "إدارة المحتوى",
                downloadAllLessons: "تحميل جميع الدروس",
                downloadDesc: "جعل الدروس متاحة دون اتصال",
                syncProgressData: "مزامنة بيانات التقدم",
                syncDesc: "رفع التقدم دون اتصال عند الاتصال",
                generateOfflinePackage: "إنشاء حزمة دون اتصال",
                generateDesc: "إنشاء حزمة USB/بطاقة SD",
                accessControl: "التحكم في الوصول",
                offlineModeStatus: "حالة الوضع دون اتصال",
                statusDesc: "حالة الوصول دون اتصال الحالية",
                offlineUsers: "المستخدمون دون اتصال",
                usersDesc: "الأطفال الذين يستخدمون الوصول دون اتصال",
                lastSync: "آخر مزامنة",
                syncDesc2: "متى تمت آخر مزامنة للبيانات",
                active: "نشط",
                offlineContentLibrary: "مكتبة المحتوى دون اتصال",
                libraryDesc: "إدارة المحتوى المتاح للوصول دون اتصال",
                mathLessons: "دروس الرياضيات",
                mathLessonsDesc: "الحساب الأساسي وحل المشكلات",
                scienceLessons: "دروس العلوم",
                scienceLessonsDesc: "مفاهيم العلوم الأساسية والتجارب",
                readingMaterials: "مواد القراءة",
                readingDesc: "القصص وتمارين الفهم",
                enableOffline: "تفعيل دون اتصال",
                lessons: "دروس",
                books: "كتب",
                systemSettings: "إعدادات النظام",
                offlineSettings: "إعدادات دون اتصال",
                autoSyncOnline: "المزامنة التلقائية عند الاتصال",
                compressOfflineContent: "ضغط المحتوى دون اتصال",
                enableOfflineAnalytics: "تفعيل التحليلات دون اتصال",
                accessibilitySettings: "إعدادات إمكانية الوصول",
                highContrastMode: "وضع التباين العالي",
                largeTextSize: "حجم نص كبير",
                audioDescriptions: "الوصف الصوتي",
                
                // Practice Materials
                practiceMaterials: "مواد التدريب",
                practiceDesc: "يرجى اختيار دورك في تبويب \"دعنا نبدأ\" للوصول إلى مواد التدريب.",
                mathPracticeQuiz: "اختبار تدريب الرياضيات",
                mathQuizDesc: "الجمع والطرح",
                readingComprehension: "فهم القراءة",
                readingDesc2: "فهم القصص",
                startQuiz: "بدء الاختبار",
                startPractice: "بدء التدريب",
                
                // Notifications
                notifications: "الإشعارات",
                newAssignment: "تم نشر مهمة جديدة",
                assignmentDesc: "الرياضيات - تدريب الكسور",
                progressMilestone: "تم الوصول إلى معلم التقدم",
                milestoneDesc: "أكملت 10 دروس هذا الأسبوع!",
                practiceReminder: "تذكير التدريب",
                reminderDesc: "اختبار العلوم مستحق غداً",
                
                // Common Actions
                download: "تحميل",
                sync: "مزامنة",
                generate: "إنشاء",
                toggle: "تبديل",
                enable: "تفعيل",
                disable: "إلغاء التفعيل",
                save: "حفظ",
                cancel: "إلغاء",
                confirm: "تأكيد",
                close: "إغلاق",
                
                // Dashboard Welcome Section
                welcome: "التعليم الجيد الميسر",
                welcomeDesc: "التعليم الجيد الميسر هو بوابتك لتجارب التعلم الشخصية. اختر دورك في تبويب \"دعنا نبدأ\" لبدء رحلتك التعليمية.",
                forStudents: "للطلاب",
                forStudentsDesc: "الوصول إلى الدروس، تتبع التقدم، وكسب الشارات أثناء التعلم.",
                forTeachers: "للمعلمين",
                forTeachersDesc: "إنشاء المهام ومراقبة تقدم الطلاب بفعالية.",
                forParents: "للأهل",
                forParentsDesc: "دعم رحلة تعلم طفلك مع رؤى التقدم.",
                forAdmins: "للمديرين",
                forAdminsDesc: "إدارة المحتوى والمستخدمين وإعدادات النظام.",
                
                // Platform Features
                platformFeatures: "ميزات المنصة",
                adaptiveLearning: "التعلم التكيفي",
                adaptiveLearningDesc: "تعديل صعوبة مخصص",
                offlineSupport: "الدعم بدون اتصال",
                offlineSupportDesc: "تعلم بدون اتصال بالإنترنت",
                smsLearning: "التعلم عبر الرسائل",
                smsLearningDesc: "تعلم عبر الرسائل النصية",
                
                // Stats
                lessons: "الدروس",
                books: "الكتب",
                badges: "الشارات",
                streak: "السلسلة",
                
                // User
                guest: "مستخدم ضيف",
                role: "ضيف",
                login: "تسجيل الدخول",
                
                // Practice Materials
                practiceMaterials: "مواد التدريب",
                practiceDesc: "يرجى اختيار دورك في تبويب \"دعنا نبدأ\" للوصول إلى مواد التدريب.",
                mathPracticeQuiz: "اختبار تدريبي في الرياضيات",
                mathQuizDesc: "الجمع والطرح",
                readingComprehension: "فهم القراءة",
                readingDesc2: "فهم القصص",
                startQuiz: "بدء الاختبار",
                startPractice: "بدء التدريب"
            }
        };

        function changeLanguage(lang) {
            const currentLang = translations[lang] || translations.en;
            
            // Store current language globally
            window.currentLanguage = lang;
            
            // Comprehensive translation function that catches EVERYTHING
            function translateElement(element) {
                // Handle elements with data-translate attributes
                if (element.hasAttribute('data-translate')) {
                    const key = element.getAttribute('data-translate-key');
                    if (key && currentLang[key]) {
                        element.textContent = currentLang[key];
                    }
                    return;
                }
                
                // Handle input placeholders
                if (element.tagName === 'INPUT' && element.placeholder) {
                    const placeholderMap = {
                        'Search lessons...': 'searchPlaceholder',
                        'Enter admin password': 'enterPassword'
                    };
                    const key = placeholderMap[element.placeholder];
                    if (key && currentLang[key]) {
                        element.placeholder = currentLang[key];
                    }
                }
                
                // Handle button text
                if (element.tagName === 'BUTTON') {
                    const buttonMap = {
                        'Get Started': 'getStarted',
                        'Learn More': 'learnMore',
                        'Explore Library': 'learnMore',
                        'Continue': 'continueLesson',
                        'Download': 'download',
                        'Sync': 'sync',
                        'Generate': 'generate',
                        'Enable Offline': 'enableOffline',
                        'Start Quiz': 'startQuiz',
                        'Start Practice': 'startPractice',
                        'Play': 'play',
                        'Preview': 'preview',
                        'Info': 'info',
                        'Show all 20': 'showAll',
                        'Show less': 'showLess',
                        'Access Admin Panel': 'accessAdminPanel',
                        'Login': 'login'
                    };
                    const key = buttonMap[element.textContent.trim()];
                    if (key && currentLang[key]) {
                        element.textContent = currentLang[key];
                    }
                }
                
                // Handle headings and text content
                const textMap = {
                    'Accessible Quality Education': 'welcome',
                    'Welcome to your learning platform!': 'welcomeSubtitle',
                    'Learn better with a platform designed for every learner': 'heroTitle',
                    'Personalized lessons, a rich digital library, and insights that help you grow—online and offline.': 'heroSubtitle',
                    'Getting Started': 'gettingStarted',
                    'Choose Your Role': 'step1',
                    'Go to "Let\'s Get Started" tab and select your role': 'step1Desc',
                    'Access Content': 'step2',
                    'Browse lessons, books, and practice materials': 'step2Desc',
                    'Track Progress': 'step3',
                    'Monitor your learning journey and achievements': 'step3Desc',
                    'Select your role to access personalized learning experiences': 'roleDesc',
                    'Student': 'student',
                    'Access lessons, readings, and track your progress': 'studentDesc',
                    'Teacher': 'teacher',
                    'Create assignments and monitor student progress': 'teacherDesc',
                    'Parent/Guardian': 'parent',
                    'View your child\'s progress and support their learning': 'parentDesc',
                    'Administrator': 'admin',
                    'Manage content, users, and system settings': 'adminDesc',
                    'Your Dashboard': 'yourDashboard',
                    'Resume Learning': 'resumeLearning',
                    'Continue where you left off': 'resumeDesc',
                    'Achievements': 'achievements',
                    'Your learning badges': 'achievementsDesc',
                    'Learning Streak': 'learningStreak',
                    'Keep your momentum going!': 'streakDesc',
                    'days in a row': 'daysInRow',
                    'Math Master': 'mathMaster',
                    'Star Student': 'starStudent',
                    'Hot Streak': 'hotStreak',
                    'Continue Lesson': 'continueLesson',
                    'Learning Challenges': 'learningChallenges',
                    'Complete challenges to earn points and badges': 'challengesDesc',
                    'Math Master Challenge': 'mathMasterChallenge',
                    'Complete 5 math lessons': 'mathChallengeDesc',
                    'Science Explorer': 'scienceExplorer',
                    'Try 3 science experiments': 'scienceChallengeDesc',
                    'Streak Keeper': 'streakKeeper',
                    'Learn for 7 days straight': 'streakChallengeDesc',
                    'Total Points': 'totalPoints',
                    'Next level: 2,000 points': 'nextLevel',
                    'Select Grade Level': 'selectGrade',
                    'Select Subject': 'selectSubject',
                    'Gamified Demo': 'gamifiedDemo',
                    'Interactive placeholder: mini-games, hints, and progress hooks will be added here.': 'interactivePlaceholder',
                    'Progress': 'progress',
                    'Rating:': 'rating',
                    'Learning Analytics': 'learningAnalytics',
                    'Track your progress and identify areas for improvement': 'analyticsDesc',
                    'Learning Velocity': 'learningVelocity',
                    'Performance by Time': 'performanceByTime',
                    'Subject Correlation': 'subjectCorrelation',
                    'Learning Patterns': 'learningPatterns',
                    'Peak Learning Time': 'peakLearningTime',
                    'When you learn best': 'peakDesc',
                    'Average Session': 'averageSession',
                    'Typical study duration': 'sessionDesc',
                    'Retention Rate': 'retentionRate',
                    'How well you remember': 'retentionDesc',
                    'Admin Access': 'adminAccess',
                    'Enter admin password to access offline accessibility controls': 'adminDesc',
                    'Offline Accessibility Controls': 'offlineAccessibilityControls',
                    'Manage offline access for children without internet connectivity': 'offlineDesc',
                    'Content Management': 'contentManagement',
                    'Download All Lessons': 'downloadAllLessons',
                    'Make lessons available offline': 'downloadDesc',
                    'Sync Progress Data': 'syncProgressData',
                    'Upload offline progress when online': 'syncDesc',
                    'Generate Offline Package': 'generateOfflinePackage',
                    'Create USB/SD card package': 'generateDesc',
                    'Access Control': 'accessControl',
                    'Offline Mode Status': 'offlineModeStatus',
                    'Current offline access status': 'statusDesc',
                    'Offline Users': 'offlineUsers',
                    'Children using offline access': 'usersDesc',
                    'Last Sync': 'lastSync',
                    'When data was last synchronized': 'syncDesc2',
                    'Active': 'active',
                    'Offline Content Library': 'offlineContentLibrary',
                    'Manage content available for offline access': 'libraryDesc',
                    'Math Lessons': 'mathLessons',
                    'Basic arithmetic and problem solving': 'mathLessonsDesc',
                    'Science Lessons': 'scienceLessons',
                    'Basic science concepts and experiments': 'scienceLessonsDesc',
                    'Reading Materials': 'readingMaterials',
                    'Stories and comprehension exercises': 'readingDesc',
                    'lessons': 'lessons',
                    'books': 'books',
                    'System Settings': 'systemSettings',
                    'Offline Settings': 'offlineSettings',
                    'Auto-sync when online': 'autoSyncOnline',
                    'Compress offline content': 'compressOfflineContent',
                    'Enable offline analytics': 'enableOfflineAnalytics',
                    'Accessibility Settings': 'accessibilitySettings',
                    'High contrast mode': 'highContrastMode',
                    'Large text size': 'largeTextSize',
                    'Audio descriptions': 'audioDescriptions',
                    'Practice Materials': 'practiceMaterials',
                    'Please select your role in the "Start Lessons" tab to access practice materials.': 'practiceDesc',
                    'Math Practice Quiz': 'mathPracticeQuiz',
                    'Addition and Subtraction': 'mathQuizDesc',
                    'Reading Comprehension': 'readingComprehension',
                    'Understanding Stories': 'readingDesc2',
                    'Notifications': 'notifications',
                    'New assignment posted': 'newAssignment',
                    'Math - Fractions Practice': 'assignmentDesc',
                    'Progress milestone reached': 'progressMilestone',
                    'Completed 10 lessons this week!': 'milestoneDesc',
                    'Practice reminder': 'practiceReminder',
                    'Science quiz due tomorrow': 'reminderDesc',
                    'Guest User': 'guest',
                    'guest': 'role'
                };
                
                const text = element.textContent.trim();
                const key = textMap[text];
                if (key && currentLang[key]) {
                    element.textContent = currentLang[key];
                }
            }
            
            // Translate all elements in the document
            function translateAllElements() {
                // Get all text nodes and elements
                const allElements = document.querySelectorAll('*');
                allElements.forEach(translateElement);
                
                // Also handle text nodes
                const walker = document.createTreeWalker(
                    document.body,
                    NodeFilter.SHOW_TEXT,
                    null,
                    false
                );
                
                let node;
                while (node = walker.nextNode()) {
                    if (node.parentElement && !node.parentElement.hasAttribute('data-translate')) {
                        translateElement(node.parentElement);
                    }
                }
            }
            
            // Update document direction for RTL languages
            if (lang === 'ar') {
                document.documentElement.setAttribute('dir', 'rtl');
                document.documentElement.setAttribute('lang', 'ar');
                document.body.classList.add('rtl');
                // Add RTL-specific styles
                document.body.style.textAlign = 'right';
                document.body.style.direction = 'rtl';
            } else {
                document.documentElement.setAttribute('dir', 'ltr');
                document.documentElement.setAttribute('lang', lang);
                document.body.classList.remove('rtl');
                // Reset to LTR styles
                document.body.style.textAlign = 'left';
                document.body.style.direction = 'ltr';
            }
            
            // Store language preference
            localStorage.setItem('selectedLanguage', lang);
            
            // Translate all elements
            translateAllElements();
            
            // Update language selector
            const languageSelector = document.querySelector('select[onchange*="changeLanguage"]');
            if (languageSelector) {
                languageSelector.value = lang;
            }
        }

        // Function to translate dynamically generated content
        function translateDynamicContent() {
            if (window.currentLanguage) {
                changeLanguage(window.currentLanguage);
            }
        }
        
        // Enhanced Dark Mode Functions
        function toggleDarkMode() {
            const isDark = document.documentElement.classList.toggle('dark');
            localStorage.setItem('darkMode', isDark);
            
            // Update dark mode button text/icon
            const darkModeBtn = document.querySelector('[onclick="toggleDarkMode()"]');
            if (isDark) {
                darkModeBtn.title = 'Switch to Light Mode';
            } else {
                darkModeBtn.title = 'Switch to Dark Mode';
            }
        }

        // Simplified translation monitoring system
        function ensureCompleteTranslation() {
            // Monitor for any untranslated content
            const observer = new MutationObserver(function(mutations) {
                mutations.forEach(function(mutation) {
                    if (mutation.type === 'childList') {
                        // New nodes added - translate them
                        mutation.addedNodes.forEach(function(node) {
                            if (node.nodeType === Node.ELEMENT_NODE) {
                                // Simple translation check
                                if (window.currentLanguage && window.currentLanguage !== 'en') {
                                    setTimeout(translateDynamicContent, 100);
                                }
                            }
                        });
                    }
                });
            });
            
            // Start observing
            observer.observe(document.body, {
                childList: true,
                subtree: true
            });
        }
        
        // Simplified language persistence function
        function ensureLanguagePersistence() {
            // Just ensure the monitoring system is working
            console.log('Language persistence system initialized');
        }
        
        // Enhanced initialization with comprehensive language persistence
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // Initialize language
                const savedLang = localStorage.getItem('selectedLanguage') || 'en';
                changeLanguage(savedLang);
                
                // Initialize dark mode
                const savedDarkMode = localStorage.getItem('darkMode') === 'true';
                if (savedDarkMode) {
                    document.documentElement.classList.add('dark');
                }
                
                // Initialize charts
                initializeAdvancedCharts();
                
                // Start translation monitoring
                ensureCompleteTranslation();
                
                // Ensure language persistence across all functions
                ensureLanguagePersistence();
                
                console.log('Site initialized successfully');
            } catch (error) {
                console.error('Error during initialization:', error);
            }
        });

        // Enhanced Interactive Functions
        function toggleMobileMenu() {
            document.getElementById('mobileMenu').classList.toggle('hidden');
        }

        function toggleNotifications() {
            const panel = document.getElementById('notificationPanel');
            panel.classList.toggle('hidden');
        }

        function toggleBookmark(lessonId) {
            const bookmarks = JSON.parse(localStorage.getItem('bookmarks') || '[]');
            const index = bookmarks.indexOf(lessonId);
            
            if (index > -1) {
                bookmarks.splice(index, 1);
            } else {
                bookmarks.push(lessonId);
            }
            
            localStorage.setItem('bookmarks', JSON.stringify(bookmarks));
            
            // Visual feedback
            const button = event.target.closest('button');
            button.classList.toggle('text-yellow-500');
        }

        function rateLesson(lessonId, rating) {
            const ratings = JSON.parse(localStorage.getItem('lessonRatings') || '{}');
            ratings[lessonId] = rating;
            localStorage.setItem('lessonRatings', JSON.stringify(ratings));
            
            // Update visual rating
            const stars = event.target.closest('.flex').querySelectorAll('svg');
            stars.forEach((star, index) => {
                if (index < rating) {
                    star.classList.add('fill-current');
                } else {
                    star.classList.remove('fill-current');
                }
            });
        }

        function previewLesson(lessonId) {
            alert(`Preview for lesson: ${lessonId}\n\nThis would show a preview of the lesson content, including:\n- Learning objectives\n- Estimated time\n- Difficulty level\n- Prerequisites`);
        }

        function showLessonInfo(lessonId) {
            alert(`Lesson Info: ${lessonId}\n\n• Subject: ${lessonId.split('-')[0]}\n• Duration: 15-20 minutes\n• Difficulty: Beginner\n• Skills: Problem solving, critical thinking\n• Prerequisites: None`);
        }

        function dragStart(event) {
            event.dataTransfer.setData('text/plain', event.target.dataset.lessonId);
        }

        // Enhanced Search System
        const searchData = {
            lessons: [
                { id: 'math-1', title: 'Basic Addition', subject: 'math', grade: '1st Grade', difficulty: 'beginner', description: 'Learn basic addition with fun exercises' },
                { id: 'math-2', title: 'Subtraction Basics', subject: 'math', grade: '1st Grade', difficulty: 'beginner', description: 'Introduction to subtraction concepts' },
                { id: 'science-1', title: 'Plant Life Cycle', subject: 'science', grade: '2nd Grade', difficulty: 'intermediate', description: 'Explore how plants grow and develop' },
                { id: 'science-2', title: 'Solar System', subject: 'science', grade: '4th Grade', difficulty: 'intermediate', description: 'Journey through our solar system' },
                { id: 'english-1', title: 'Reading Comprehension', subject: 'english', grade: '3rd Grade', difficulty: 'intermediate', description: 'Improve reading skills with stories' },
                { id: 'english-2', title: 'Grammar Basics', subject: 'english', grade: '2nd Grade', difficulty: 'beginner', description: 'Learn basic grammar rules' },
                { id: 'tech-1', title: 'Introduction to Coding', subject: 'technology', grade: '5th Grade', difficulty: 'intermediate', description: 'Start your coding journey' },
                { id: 'tech-2', title: 'Digital Safety', subject: 'technology', grade: '3rd Grade', difficulty: 'beginner', description: 'Learn to stay safe online' },
                { id: 'geo-1', title: 'World Continents', subject: 'geography', grade: '3rd Grade', difficulty: 'beginner', description: 'Explore the seven continents' },
                { id: 'geo-2', title: 'Climate Zones', subject: 'geography', grade: '4th Grade', difficulty: 'intermediate', description: 'Understand different climate types' }
            ],
            books: [
                { id: 'book-1', title: 'Adventure Stories', subject: 'english', grade: '2nd Grade', author: 'Jane Smith' },
                { id: 'book-2', title: 'Math Puzzles', subject: 'math', grade: '3rd Grade', author: 'John Doe' },
                { id: 'book-3', title: 'Science Experiments', subject: 'science', grade: '4th Grade', author: 'Dr. Wilson' }
            ],
            features: [
                { id: 'feature-1', title: 'Adaptive Learning', category: 'learning', description: 'Personalized difficulty adjustment' },
                { id: 'feature-2', title: 'Offline Support', category: 'accessibility', description: 'Learn without internet connection' },
                { id: 'feature-3', title: 'Progress Tracking', category: 'analytics', description: 'Monitor learning journey' }
            ]
        };

        let searchResults = [];
        let currentSearchTerm = '';

        function handleSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase().trim();
            currentSearchTerm = searchTerm;
            
            // Hide search results if search term is too short
            if (searchTerm.length < 2) {
                hideSearchResults();
                // Also hide lesson cards if we're filtering them
                const lessonCards = document.querySelectorAll('[data-lesson-id]');
                lessonCards.forEach(card => {
                    card.style.display = 'block';
                });
                return;
            }

            searchResults = [];
            
            // Search lessons
            searchData.lessons.forEach(lesson => {
                if (lesson.title.toLowerCase().includes(searchTerm) || 
                    lesson.description.toLowerCase().includes(searchTerm) ||
                    lesson.subject.toLowerCase().includes(searchTerm) ||
                    lesson.grade.toLowerCase().includes(searchTerm)) {
                    searchResults.push({ ...lesson, type: 'lesson' });
                }
            });

            // Search books
            searchData.books.forEach(book => {
                if (book.title.toLowerCase().includes(searchTerm) || 
                    book.author.toLowerCase().includes(searchTerm) ||
                    book.subject.toLowerCase().includes(searchTerm)) {
                    searchResults.push({ ...book, type: 'book' });
                }
            });

            // Search features
            searchData.features.forEach(feature => {
                if (feature.title.toLowerCase().includes(searchTerm) || 
                    feature.description.toLowerCase().includes(searchTerm)) {
                    searchResults.push({ ...feature, type: 'feature' });
                }
            });

            // Also filter existing lesson cards
            const lessonCards = document.querySelectorAll('[data-lesson-id]');
            lessonCards.forEach(card => {
                const title = card.querySelector('h4').textContent.toLowerCase();
                const description = card.querySelector('p').textContent.toLowerCase();
                
                if (title.includes(searchTerm) || description.includes(searchTerm)) {
                    card.style.display = 'block';
                } else {
                    card.style.display = 'none';
                }
            });

            displaySearchResults();
        }

        function displaySearchResults() {
            const searchContainer = document.getElementById('searchResults');
            if (!searchContainer) return;

            if (searchResults.length === 0) {
                searchContainer.innerHTML = `
                    <div class="p-4 text-center text-gray-500">
                        <svg class="w-8 h-8 mx-auto mb-2 text-gray-400" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"></path>
                        </svg>
                        No results found for "${currentSearchTerm}"
                    </div>
                `;
                searchContainer.classList.remove('hidden');
                return;
            }

            let html = '<div class="p-2">';
            
            // Group results by type
            const lessons = searchResults.filter(r => r.type === 'lesson');
            const books = searchResults.filter(r => r.type === 'book');
            const features = searchResults.filter(r => r.type === 'feature');

            if (lessons.length > 0) {
                html += '<div class="mb-3"><h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">Lessons</h4>';
                lessons.slice(0, 3).forEach(lesson => {
                    html += `
                        <div class="flex items-center p-2 hover:bg-gray-50 rounded-lg cursor-pointer transition-colors" onclick="openLesson('${lesson.id}')">
                            <div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-gray-900">${lesson.title}</p>
                                <p class="text-xs text-gray-500">${lesson.grade} • ${lesson.subject}</p>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            }

            if (books.length > 0) {
                html += '<div class="mb-3"><h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">Books</h4>';
                books.slice(0, 2).forEach(book => {
                    html += `
                        <div class="flex items-center p-2 hover:bg-gray-50 rounded-lg cursor-pointer transition-colors" onclick="openBook('${book.id}')">
                            <div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-gray-900">${book.title}</p>
                                <p class="text-xs text-gray-500">${book.author} • ${book.grade}</p>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            }

            if (features.length > 0) {
                html += '<div class="mb-3"><h4 class="text-xs font-semibold text-gray-500 uppercase tracking-wide mb-2">Features</h4>';
                features.slice(0, 2).forEach(feature => {
                    html += `
                        <div class="flex items-center p-2 hover:bg-gray-50 rounded-lg cursor-pointer transition-colors" onclick="openFeature('${feature.id}')">
                            <div class="w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center mr-3">
                                <svg class="w-4 h-4 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                </svg>
                            </div>
                            <div class="flex-1">
                                <p class="text-sm font-medium text-gray-900">${feature.title}</p>
                                <p class="text-xs text-gray-500">${feature.description}</p>
                            </div>
                        </div>
                    `;
                });
                html += '</div>';
            }

            html += '</div>';
            searchContainer.innerHTML = html;
            searchContainer.classList.remove('hidden');
        }

        function hideSearchResults() {
            const searchContainer = document.getElementById('searchResults');
            if (searchContainer) {
                searchContainer.classList.add('hidden');
            }
        }

        function openLesson(lessonId) {
            console.log('Opening lesson:', lessonId);
            hideSearchResults();
            // Navigate to lesson or show lesson details
            goToTab('library');
        }

        function openBook(bookId) {
            console.log('Opening book:', bookId);
            hideSearchResults();
            // Navigate to book or show book details
        }

        function openFeature(featureId) {
            console.log('Opening feature:', featureId);
            hideSearchResults();
            // Navigate to feature or show feature details
        }

        // Initialize dark mode from localStorage
        if (localStorage.getItem('darkMode') === 'true') {
            document.documentElement.classList.add('dark');
        }

        // Search functionality
        document.getElementById('searchInput').addEventListener('input', handleSearch);
        
        // Add keyboard support for search
        document.getElementById('searchInput').addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                hideSearchResults();
                this.blur();
            }
        });

        // Close search results when clicking outside
        document.addEventListener('click', function(event) {
            const searchContainer = document.getElementById('searchResults');
            const searchInput = document.getElementById('searchInput');
            
            if (searchContainer && !searchContainer.contains(event.target) && !searchInput.contains(event.target)) {
                hideSearchResults();
            }
        });

        // Close notifications when clicking outside
        document.addEventListener('click', function(event) {
            const panel = document.getElementById('notificationPanel');
            const button = event.target.closest('[onclick="toggleNotifications()"]');
            
            if (!panel.contains(event.target) && !button) {
                panel.classList.add('hidden');
            }
        });

        // Comprehensive Digital Library System
        const digitalLibrary = {
            books: [
                {
                    id: 'book-001',
                    title: 'The Magic Tree House',
                    author: 'Mary Pope Osborne',
                    grade: '2nd',
                    subject: 'reading',
                    difficulty: 'beginner',
                    pages: 80,
                    readingTime: '45 minutes',
                    description: 'Join Jack and Annie as they discover a magical tree house filled with books that can transport them to any time and place.',
                    rating: 4.5,
                    reviews: 23,
                    availability: 'available',
                    checkedOutBy: null,
                    dueDate: null,
                    coverImage: '📚',
                    tags: ['adventure', 'magic', 'friendship'],
                    addedDate: '2024-01-15',
                    isFavorite: false,
                    readingProgress: { pagesRead: 0, timeSpent: 0 }
                },
                {
                    id: 'book-002',
                    title: 'Charlotte\'s Web',
                    author: 'E.B. White',
                    grade: '3rd',
                    subject: 'reading',
                    difficulty: 'intermediate',
                    pages: 192,
                    readingTime: '2 hours',
                    description: 'A heartwarming tale of friendship between a pig named Wilbur and a spider named Charlotte.',
                    rating: 4.8,
                    reviews: 45,
                    availability: 'available',
                    checkedOutBy: null,
                    dueDate: null,
                    coverImage: '🕷️',
                    tags: ['friendship', 'animals', 'classic'],
                    addedDate: '2024-01-10',
                    isFavorite: true,
                    readingProgress: { pagesRead: 45, timeSpent: 30 }
                },
                {
                    id: 'book-003',
                    title: 'Math Adventures',
                    author: 'Dr. Sarah Johnson',
                    grade: '1st',
                    subject: 'math',
                    difficulty: 'beginner',
                    pages: 64,
                    readingTime: '30 minutes',
                    description: 'Fun math problems and puzzles that make learning numbers exciting and engaging.',
                    rating: 4.2,
                    reviews: 18,
                    availability: 'checked-out',
                    checkedOutBy: 'current-user',
                    dueDate: '2024-02-15',
                    coverImage: '🔢',
                    tags: ['math', 'puzzles', 'learning'],
                    addedDate: '2024-01-20',
                    isFavorite: false,
                    readingProgress: { pagesRead: 20, timeSpent: 15 }
                },
                {
                    id: 'book-004',
                    title: 'Science Experiments',
                    author: 'Prof. Michael Chen',
                    grade: '4th',
                    subject: 'science',
                    difficulty: 'intermediate',
                    pages: 128,
                    readingTime: '1.5 hours',
                    description: 'Discover the wonders of science through hands-on experiments and fascinating facts.',
                    rating: 4.6,
                    reviews: 32,
                    availability: 'available',
                    checkedOutBy: null,
                    dueDate: null,
                    coverImage: '🔬',
                    tags: ['science', 'experiments', 'discovery'],
                    addedDate: '2024-01-25',
                    isFavorite: true,
                    readingProgress: { pagesRead: 0, timeSpent: 0 }
                },
                {
                    id: 'book-005',
                    title: 'World Geography',
                    author: 'Dr. Emily Rodriguez',
                    grade: '5th',
                    subject: 'geography',
                    difficulty: 'advanced',
                    pages: 200,
                    readingTime: '3 hours',
                    description: 'Explore the world\'s continents, countries, and cultures through stunning maps and stories.',
                    rating: 4.7,
                    reviews: 28,
                    availability: 'available',
                    checkedOutBy: null,
                    dueDate: null,
                    coverImage: '🌍',
                    tags: ['geography', 'world', 'cultures'],
                    addedDate: '2024-01-30',
                    isFavorite: false,
                    readingProgress: { pagesRead: 0, timeSpent: 0 }
                }
            ],
            
            userStats: {
                totalBooks: 0,
                booksRead: 0,
                readingTime: 0,
                booksThisMonth: 0,
                pagesReadToday: 0,
                averageRating: 0.0,
                favorites: JSON.parse(localStorage.getItem('bookFavorites') || '[]'),
                checkedOutBooks: JSON.parse(localStorage.getItem('checkedOutBooks') || '[]'),
                readingLists: JSON.parse(localStorage.getItem('readingLists') || '[]')
            },
            
            currentFilter: 'all',
            currentBook: null,
            
            init() {
                try {
                    this.updateStats();
                    this.loadBooks();
                    this.setupEventListeners();
                    this.loadReadingLists();
                    console.log('Digital library system initialized');
                } catch (error) {
                    console.error('Error in digital library init:', error);
                }
            },
            
            updateStats() {
                this.userStats.totalBooks = this.books.length;
                this.userStats.booksRead = this.books.filter(book => book.readingProgress.pagesRead === book.pages).length;
                this.userStats.readingTime = this.books.reduce((total, book) => total + book.readingProgress.timeSpent, 0);
                this.userStats.booksThisMonth = this.books.filter(book => {
                    const addedDate = new Date(book.addedDate);
                    const now = new Date();
                    return addedDate.getMonth() === now.getMonth() && addedDate.getFullYear() === now.getFullYear();
                }).length;
                this.userStats.pagesReadToday = this.books.reduce((total, book) => total + (book.readingProgress.pagesRead || 0), 0);
                this.userStats.averageRating = this.books.reduce((total, book) => total + book.rating, 0) / this.books.length;
                
                // Update display
                const totalBooksEl = document.getElementById('totalBooks');
                const booksReadEl = document.getElementById('booksRead');
                const readingTimeEl = document.getElementById('readingTime');
                const booksThisMonthEl = document.getElementById('booksThisMonth');
                const pagesReadTodayEl = document.getElementById('pagesReadToday');
                const averageRatingEl = document.getElementById('averageRating');
                
                if (totalBooksEl) totalBooksEl.textContent = this.userStats.totalBooks;
                if (booksReadEl) booksReadEl.textContent = this.userStats.booksRead;
                if (readingTimeEl) readingTimeEl.textContent = Math.floor(this.userStats.readingTime / 60) + 'h';
                if (booksThisMonthEl) booksThisMonthEl.textContent = this.userStats.booksThisMonth;
                if (pagesReadTodayEl) pagesReadTodayEl.textContent = this.userStats.pagesReadToday;
                if (averageRatingEl) averageRatingEl.textContent = this.userStats.averageRating.toFixed(1);
            },
            
            loadBooks() {
                const grid = document.getElementById('booksGrid');
                if (!grid) return;
                
                let filteredBooks = this.getFilteredBooks();
                
                let booksHTML = '';
                filteredBooks.forEach(book => {
                    const isCheckedOut = book.availability === 'checked-out' && book.checkedOutBy === 'current-user';
                    const isFavorite = this.userStats.favorites.includes(book.id);
                    
                    booksHTML += `
                        <div class="card group hover:shadow-xl transition-all duration-300 hover:scale-105" data-book-id="${book.id}">
                            <div class="relative">
                                <div class="w-full h-48 bg-gray-200 rounded-lg flex items-center justify-center mb-4">
                                    <span class="text-6xl">${book.coverImage}</span>
                                </div>
                                <div class="absolute top-2 right-2 flex space-x-1">
                                    <button onclick="digitalLibrary.toggleFavorite('${book.id}')" class="p-2 bg-white rounded-full shadow-md hover:bg-gray-50 transition-colors">
                                        <svg class="w-4 h-4 ${isFavorite ? 'text-red-500 fill-current' : 'text-gray-400'}" fill="currentColor" viewBox="0 0 20 20">
                                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
                                        </svg>
                                    </button>
                                </div>
                                <div class="absolute top-2 left-2">
                                    <span class="px-2 py-1 text-xs rounded-full ${this.getAvailabilityColor(book.availability)}">${this.getAvailabilityText(book.availability)}</span>
                                </div>
                            </div>
                            
                            <div class="space-y-2">
                                <h4 class="font-semibold text-gray-900 group-hover:text-blue-600 transition-colors">${book.title}</h4>
                                <p class="text-sm text-gray-600">by ${book.author}</p>
                                <div class="flex items-center justify-between text-xs text-gray-500">
                                    <span>${book.grade} Grade</span>
                                    <span>${book.pages} pages</span>
                                </div>
                                <div class="flex items-center space-x-1">
                                    <div class="flex">
                                        ${this.generateStars(book.rating)}
                                    </div>
                                    <span class="text-xs text-gray-500">${book.rating} (${book.reviews})</span>
                                </div>
                                ${book.readingProgress.pagesRead > 0 ? `
                                    <div class="space-y-1">
                                        <div class="flex items-center justify-between text-xs">
                                            <span class="text-gray-600">Progress</span>
                                            <span class="text-gray-900">${book.readingProgress.pagesRead}/${book.pages}</span>
                                        </div>
                                        <div class="w-full bg-gray-200 rounded-full h-1">
                                            <div class="bg-blue-600 h-1 rounded-full" style="width: ${(book.readingProgress.pagesRead / book.pages) * 100}%"></div>
                                        </div>
                                    </div>
                                ` : ''}
                            </div>
                            
                            <div class="mt-4">
                                <button onclick="digitalLibrary.openBookModal('${book.id}')" class="btn btn-primary w-full text-sm">
                                    ${isCheckedOut ? 'Continue Reading' : 'View Details'}
                                </button>
                            </div>
                        </div>
                    `;
                });
                
                grid.innerHTML = booksHTML;
            },
            
            getFilteredBooks() {
                let filtered = [...this.books];
                
                // Apply current filter
                switch(this.currentFilter) {
                    case 'available':
                        filtered = filtered.filter(book => book.availability === 'available');
                        break;
                    case 'checked-out':
                        filtered = filtered.filter(book => book.availability === 'checked-out' && book.checkedOutBy === 'current-user');
                        break;
                    case 'favorites':
                        filtered = filtered.filter(book => this.userStats.favorites.includes(book.id));
                        break;
                    case 'recent':
                        filtered = filtered.sort((a, b) => new Date(b.addedDate) - new Date(a.addedDate)).slice(0, 8);
                        break;
                }
                
                // Apply search filter
                const searchInput = document.getElementById('librarySearch');
                if (searchInput) {
                    const searchTerm = searchInput.value.toLowerCase();
                    if (searchTerm) {
                        filtered = filtered.filter(book => 
                            book.title.toLowerCase().includes(searchTerm) ||
                            book.author.toLowerCase().includes(searchTerm) ||
                            book.subject.toLowerCase().includes(searchTerm) ||
                            book.tags.some(tag => tag.toLowerCase().includes(searchTerm))
                        );
                    }
                }
                
                // Apply grade filter
                const gradeFilter = document.getElementById('gradeFilter');
                if (gradeFilter) {
                    const gradeValue = gradeFilter.value;
                    if (gradeValue) {
                        filtered = filtered.filter(book => book.grade === gradeValue);
                    }
                }
                
                // Apply subject filter
                const subjectFilter = document.getElementById('subjectFilter');
                if (subjectFilter) {
                    const subjectValue = subjectFilter.value;
                    if (subjectValue) {
                        filtered = filtered.filter(book => book.subject === subjectValue);
                    }
                }
                
                // Apply difficulty filter
                const difficultyFilter = document.getElementById('difficultyFilter');
                if (difficultyFilter) {
                    const difficultyValue = difficultyFilter.value;
                    if (difficultyValue) {
                        filtered = filtered.filter(book => book.difficulty === difficultyValue);
                    }
                }
                
                return filtered;
            },
            
            getAvailabilityColor(availability) {
                switch(availability) {
                    case 'available': return 'bg-green-100 text-green-800';
                    case 'checked-out': return 'bg-yellow-100 text-yellow-800';
                    case 'reserved': return 'bg-blue-100 text-blue-800';
                    default: return 'bg-gray-100 text-gray-800';
                }
            },
            
            getAvailabilityText(availability) {
                switch(availability) {
                    case 'available': return 'Available';
                    case 'checked-out': return 'Checked Out';
                    case 'reserved': return 'Reserved';
                    default: return 'Unknown';
                }
            },
            
            generateStars(rating) {
                let stars = '';
                const fullStars = Math.floor(rating);
                const hasHalfStar = rating % 1 >= 0.5;
                
                for (let i = 0; i < fullStars; i++) {
                    stars += '<svg class="w-4 h-4 text-yellow-400 fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>';
                }
                
                if (hasHalfStar) {
                    stars += '<svg class="w-4 h-4 text-yellow-400 fill-current" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>';
                }
                
                const emptyStars = 5 - fullStars - (hasHalfStar ? 1 : 0);
                for (let i = 0; i < emptyStars; i++) {
                    stars += '<svg class="w-4 h-4 text-gray-300" viewBox="0 0 20 20"><path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path></svg>';
                }
                
                return stars;
            },
            
            setupEventListeners() {
                // Search input
                const searchInput = document.getElementById('librarySearch');
                if (searchInput) {
                    searchInput.addEventListener('input', () => this.loadBooks());
                }
                
                // Filter selects
                ['gradeFilter', 'subjectFilter', 'difficultyFilter'].forEach(id => {
                    const element = document.getElementById(id);
                    if (element) {
                        element.addEventListener('change', () => this.loadBooks());
                    }
                });
            },
            
            openBookModal(bookId) {
                const book = this.books.find(b => b.id === bookId);
                if (!book) return;
                
                this.currentBook = book;
                
                // Update modal content
                const modalTitle = document.getElementById('modalBookTitle');
                const modalAuthor = document.getElementById('modalBookAuthor');
                const modalDescription = document.getElementById('modalBookDescription');
                const modalGrade = document.getElementById('modalBookGrade');
                const modalSubject = document.getElementById('modalBookSubject');
                const modalPages = document.getElementById('modalBookPages');
                const modalTime = document.getElementById('modalBookTime');
                const modalRatingText = document.getElementById('modalBookRatingText');
                const modalRating = document.getElementById('modalBookRating');
                
                if (modalTitle) modalTitle.textContent = book.title;
                if (modalAuthor) modalAuthor.textContent = book.author;
                if (modalDescription) modalDescription.textContent = book.description;
                if (modalGrade) modalGrade.textContent = book.grade + ' Grade';
                if (modalSubject) modalSubject.textContent = book.subject.charAt(0).toUpperCase() + book.subject.slice(1);
                if (modalPages) modalPages.textContent = book.pages;
                if (modalTime) modalTime.textContent = book.readingTime;
                if (modalRatingText) modalRatingText.textContent = `${book.rating} (${book.reviews} reviews)`;
                if (modalRating) modalRating.innerHTML = this.generateStars(book.rating);
                
                // Update progress
                const progressPercent = (book.readingProgress.pagesRead / book.pages) * 100;
                const modalPagesRead = document.getElementById('modalPagesRead');
                const modalProgressBar = document.getElementById('modalProgressBar');
                const modalTimeSpent = document.getElementById('modalTimeSpent');
                
                if (modalPagesRead) modalPagesRead.textContent = `${book.readingProgress.pagesRead} / ${book.pages}`;
                if (modalProgressBar) modalProgressBar.style.width = progressPercent + '%';
                if (modalTimeSpent) modalTimeSpent.textContent = `${book.readingProgress.timeSpent} minutes`;
                
                // Update buttons
                const isCheckedOut = book.availability === 'checked-out' && book.checkedOutBy === 'current-user';
                const isFavorite = this.userStats.favorites.includes(book.id);
                
                const modalCheckoutBtn = document.getElementById('modalCheckoutBtn');
                const modalReturnBtn = document.getElementById('modalReturnBtn');
                const favoriteText = document.getElementById('favoriteText');
                
                if (modalCheckoutBtn) modalCheckoutBtn.classList.toggle('hidden', isCheckedOut);
                if (modalReturnBtn) modalReturnBtn.classList.toggle('hidden', !isCheckedOut);
                if (favoriteText) favoriteText.textContent = isFavorite ? 'Remove from Favorites' : 'Add to Favorites';
                
                // Show modal
                const modal = document.getElementById('bookModal');
                if (modal) modal.classList.remove('hidden');
            },
            
            closeBookModal() {
                const modal = document.getElementById('bookModal');
                if (modal) modal.classList.add('hidden');
                this.currentBook = null;
            },
            
            checkoutBook() {
                if (!this.currentBook) return;
                
                this.currentBook.availability = 'checked-out';
                this.currentBook.checkedOutBy = 'current-user';
                this.currentBook.dueDate = new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toISOString().split('T')[0];
                
                this.userStats.checkedOutBooks.push(this.currentBook.id);
                this.saveUserData();
                this.loadBooks();
                this.closeBookModal();
                
                alert(`You've checked out "${this.currentBook.title}"`);
            },
            
            returnBook() {
                if (!this.currentBook) return;
                
                this.currentBook.availability = 'available';
                this.currentBook.checkedOutBy = null;
                this.currentBook.dueDate = null;
                
                this.userStats.checkedOutBooks = this.userStats.checkedOutBooks.filter(id => id !== this.currentBook.id);
                this.saveUserData();
                this.loadBooks();
                this.closeBookModal();
                
                alert(`You've returned "${this.currentBook.title}"`);
            },
            
            toggleFavorite(bookId) {
                const book = this.books.find(b => b.id === bookId);
                if (!book) return;
                
                const index = this.userStats.favorites.indexOf(bookId);
                if (index > -1) {
                    this.userStats.favorites.splice(index, 1);
                    book.isFavorite = false;
                    alert(`"${book.title}" removed from favorites`);
                } else {
                    this.userStats.favorites.push(bookId);
                    book.isFavorite = true;
                    alert(`"${book.title}" added to favorites`);
                }
                
                this.saveUserData();
                this.loadBooks();
            },
            
            loadReadingLists() {
                const container = document.getElementById('readingLists');
                if (!container) return;
                
                if (this.userStats.readingLists.length === 0) {
                    container.innerHTML = '<p class="text-gray-500 text-center py-4">No reading lists yet. Create one to organize your books!</p>';
                    return;
                }
                
                let listsHTML = '';
                this.userStats.readingLists.forEach(list => {
                    listsHTML += `
                        <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                            <div class="flex items-center justify-between">
                                <div>
                                    <h5 class="font-semibold text-gray-900">${list.name}</h5>
                                    <p class="text-sm text-gray-600">${list.books.length} books</p>
                                </div>
                                <div class="flex items-center space-x-2">
                                    <button onclick="digitalLibrary.viewReadingList('${list.id}')" class="btn btn-secondary text-sm">View</button>
                                    <button onclick="digitalLibrary.deleteReadingList('${list.id}')" class="btn btn-secondary text-sm text-red-600">Delete</button>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = listsHTML;
            },
            
            createReadingList() {
                const name = prompt('Enter reading list name:');
                if (!name) return;
                
                const newList = {
                    id: 'list-' + Date.now(),
                    name: name,
                    books: [],
                    createdAt: new Date().toISOString()
                };
                
                this.userStats.readingLists.push(newList);
                this.saveUserData();
                this.loadReadingLists();
                
                alert(`"${name}" has been created`);
            },
            
            saveUserData() {
                localStorage.setItem('bookFavorites', JSON.stringify(this.userStats.favorites));
                localStorage.setItem('checkedOutBooks', JSON.stringify(this.userStats.checkedOutBooks));
                localStorage.setItem('readingLists', JSON.stringify(this.userStats.readingLists));
            }
        };

        // Library system functions
        function filterBooks(filter) {
            digitalLibrary.currentFilter = filter;
            
            // Update filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('active', 'bg-blue-600', 'text-white');
                btn.classList.add('border-gray-300', 'hover:bg-gray-50');
            });
            
            event.target.classList.add('active', 'bg-blue-600', 'text-white');
            event.target.classList.remove('border-gray-300', 'hover:bg-gray-50');
            
            digitalLibrary.loadBooks();
        }

        function openBookModal(bookId) {
            digitalLibrary.openBookModal(bookId);
        }

        function closeBookModal() {
            digitalLibrary.closeBookModal();
        }

        function checkoutBook() {
            digitalLibrary.checkoutBook();
        }

        function returnBook() {
            digitalLibrary.returnBook();
        }

        function toggleFavorite() {
            if (digitalLibrary.currentBook) {
                digitalLibrary.toggleFavorite(digitalLibrary.currentBook.id);
            }
        }

        // Comprehensive Progress & Analytics System
        const progressAnalytics = {
            userStats: {
                totalLessonsCompleted: parseInt(localStorage.getItem('totalLessonsCompleted') || '0'),
                studyStreak: parseInt(localStorage.getItem('studyStreak') || '0'),
                totalTimeSpent: parseInt(localStorage.getItem('totalTimeSpent') || '0'),
                subjectMastery: JSON.parse(localStorage.getItem('subjectMastery') || '{"math": 75, "reading": 60, "science": 85}'),
                learningGoals: JSON.parse(localStorage.getItem('learningGoals') || '{"dailyPractice": 8, "weeklyLessons": 6, "readingTime": 2}'),
                achievements: JSON.parse(localStorage.getItem('achievements') || '[]'),
                studyHistory: JSON.parse(localStorage.getItem('studyHistory') || '[]')
            },
            
            charts: {
                learningProgress: null,
                subjectPerformance: null,
                studyTime: null,
                learningVelocity: null
            },
            
            init() {
                try {
                    this.updateStatsDisplay();
                    this.loadProgressTable();
                    this.loadRecommendations();
                    this.initializeCharts();
                    console.log('Progress analytics system initialized');
                } catch (error) {
                    console.error('Error in progress analytics init:', error);
                }
            },
            
            updateStatsDisplay() {
                const totalLessonsEl = document.getElementById('totalLessonsCompleted');
                const studyStreakEl = document.getElementById('studyStreak');
                const totalTimeEl = document.getElementById('totalTimeSpent');
                
                if (totalLessonsEl) totalLessonsEl.textContent = this.userStats.totalLessonsCompleted;
                if (studyStreakEl) studyStreakEl.textContent = this.userStats.studyStreak;
                if (totalTimeEl) totalTimeEl.textContent = Math.floor(this.userStats.totalTimeSpent / 60) + 'h';
                
                this.updateSubjectMastery();
                this.updateLearningGoals();
                this.updateAchievements();
            },
            
            updateSubjectMastery() {
                const subjects = ['math', 'reading', 'science'];
                subjects.forEach(subject => {
                    const mastery = this.userStats.subjectMastery[subject] || 0;
                    const progressBar = document.querySelector(`[data-subject="${subject}"] .bg-blue-600, [data-subject="${subject}"] .bg-green-600, [data-subject="${subject}"] .bg-purple-600`);
                    if (progressBar) {
                        progressBar.style.width = mastery + '%';
                        const nextEl = progressBar.nextElementSibling;
                        if (nextEl) nextEl.textContent = mastery + '%';
                    }
                });
            },
            
            updateLearningGoals() {
                const goals = this.userStats.learningGoals;
                const goalElements = document.querySelectorAll('.card:nth-child(2) .space-y-3 > div');
                if (goalElements.length >= 3) {
                    const dailyProgress = goalElements[0].querySelector('.bg-green-600');
                    if (dailyProgress) dailyProgress.style.width = (goals.dailyPractice / 10 * 100) + '%';
                    
                    const weeklyProgress = goalElements[1].querySelector('.bg-blue-600');
                    if (weeklyProgress) weeklyProgress.style.width = (goals.weeklyLessons / 10 * 100) + '%';
                    
                    const readingProgress = goalElements[2].querySelector('.bg-purple-600');
                    if (readingProgress) readingProgress.style.width = (goals.readingTime / 5 * 100) + '%';
                }
            },
            
            updateAchievements() {
                const achievements = this.userStats.achievements;
                if (achievements.length === 0) {
                    this.userStats.achievements = [
                        { id: 'math-master', title: 'Math Master', description: 'Completed 10 math lessons', icon: '🥇', earned: true },
                        { id: 'bookworm', title: 'Bookworm', description: 'Read 5 books this month', icon: '📖', earned: true },
                        { id: 'streak-master', title: 'Streak Master', description: '7-day study streak', icon: '⚡', earned: true }
                    ];
                    this.saveStats();
                }
            },
            
            initializeCharts() {
                try {
                    this.createLearningProgressChart();
                    this.createSubjectPerformanceChart();
                    this.createStudyTimeChart();
                    this.createLearningVelocityChart();
                    console.log('Progress charts initialized successfully');
                } catch (error) {
                    console.error('Error initializing progress charts:', error);
                }
            },
            
            createLearningProgressChart() {
                const ctx = document.getElementById('learningProgressChart');
                if (!ctx || typeof Chart === 'undefined') return;
                
                this.charts.learningProgress = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
                        datasets: [{
                            label: 'Lessons Completed',
                            data: [2, 3, 1, 4, 2, 1, 3],
                            borderColor: 'rgb(59, 130, 246)',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            tension: 0.4
                        }, {
                            label: 'Practice Sessions',
                            data: [1, 2, 2, 3, 1, 2, 2],
                            borderColor: 'rgb(16, 185, 129)',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            tension: 0.4
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'top',
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            },
            
            createSubjectPerformanceChart() {
                const ctx = document.getElementById('subjectPerformanceChart');
                if (!ctx || typeof Chart === 'undefined') return;
                
                this.charts.subjectPerformance = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Mathematics', 'Reading', 'Science'],
                        datasets: [{
                            data: [75, 60, 85],
                            backgroundColor: [
                                'rgb(59, 130, 246)',
                                'rgb(16, 185, 129)',
                                'rgb(147, 51, 234)'
                            ],
                            borderWidth: 2,
                            borderColor: '#fff'
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom',
                            }
                        }
                    }
                });
            },
            
            createStudyTimeChart() {
                const ctx = document.getElementById('studyTimeChart');
                if (!ctx || typeof Chart === 'undefined') return;
                
                this.charts.studyTime = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: ['6AM', '9AM', '12PM', '3PM', '6PM', '9PM'],
                        datasets: [{
                            label: 'Study Time (minutes)',
                            data: [15, 30, 20, 45, 25, 10],
                            backgroundColor: 'rgba(147, 51, 234, 0.8)',
                            borderColor: 'rgb(147, 51, 234)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            },
            
            createLearningVelocityChart() {
                const ctx = document.getElementById('learningVelocityChart');
                if (!ctx || typeof Chart === 'undefined') return;
                
                this.charts.learningVelocity = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
                        datasets: [{
                            label: 'Learning Velocity',
                            data: [2.1, 2.3, 2.8, 3.2],
                            borderColor: 'rgb(245, 158, 11)',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 4
                            }
                        }
                    }
                });
            },
            
            loadProgressTable() {
                const tbody = document.getElementById('progressTableBody');
                if (!tbody) return;
                
                const progressData = [
                    { subject: 'Mathematics', lessons: 12, practice: 8, accuracy: '85%', timeSpent: '2h 30m', lastActivity: '2 hours ago' },
                    { subject: 'Reading', lessons: 8, practice: 6, accuracy: '72%', timeSpent: '1h 45m', lastActivity: '1 day ago' },
                    { subject: 'Science', lessons: 10, practice: 7, accuracy: '90%', timeSpent: '2h 15m', lastActivity: '3 hours ago' },
                    { subject: 'Geography', lessons: 5, practice: 3, accuracy: '78%', timeSpent: '1h 20m', lastActivity: '2 days ago' }
                ];
                
                let tableHTML = '';
                progressData.forEach(row => {
                    tableHTML += `
                        <tr class="border-b border-gray-100 hover:bg-gray-50">
                            <td class="py-3 px-4 font-medium text-gray-900">${row.subject}</td>
                            <td class="py-3 px-4 text-gray-600">${row.lessons}</td>
                            <td class="py-3 px-4 text-gray-600">${row.practice}</td>
                            <td class="py-3 px-4">
                                <span class="px-2 py-1 text-xs rounded-full ${this.getAccuracyColor(row.accuracy)}">${row.accuracy}</span>
                            </td>
                            <td class="py-3 px-4 text-gray-600">${row.timeSpent}</td>
                            <td class="py-3 px-4 text-gray-500 text-sm">${row.lastActivity}</td>
                        </tr>
                    `;
                });
                
                tbody.innerHTML = tableHTML;
            },
            
            getAccuracyColor(accuracy) {
                const percent = parseInt(accuracy);
                if (percent >= 80) return 'bg-green-100 text-green-800';
                if (percent >= 60) return 'bg-yellow-100 text-yellow-800';
                return 'bg-red-100 text-red-800';
            },
            
            loadRecommendations() {
                const container = document.getElementById('recommendationsContainer');
                if (!container) return;
                
                const recommendations = [
                    {
                        title: 'Focus on Reading Comprehension',
                        description: 'Your reading accuracy is 72%. Try practicing vocabulary and reading exercises.',
                        action: 'Start Reading Practice',
                        color: 'blue',
                        icon: '📚'
                    },
                    {
                        title: 'Maintain Your Math Streak',
                        description: 'You\'re doing great in math! Keep up the excellent work with daily practice.',
                        action: 'Continue Math Lessons',
                        color: 'green',
                        icon: '🔢'
                    },
                    {
                        title: 'Explore Science Topics',
                        description: 'Your science performance is outstanding. Consider advanced science lessons.',
                        action: 'View Advanced Science',
                        color: 'purple',
                        icon: '🔬'
                    },
                    {
                        title: 'Set Daily Goals',
                        description: 'Create specific daily learning goals to improve consistency.',
                        action: 'Set Goals',
                        color: 'orange',
                        icon: '🎯'
                    }
                ];
                
                let recommendationsHTML = '';
                recommendations.forEach(rec => {
                    recommendationsHTML += `
                        <div class="p-4 border rounded-lg hover:shadow-md transition-shadow">
                            <div class="flex items-start space-x-3">
                                <div class="text-2xl">${rec.icon}</div>
                                <div class="flex-1">
                                    <h5 class="font-semibold text-gray-900 mb-2">${rec.title}</h5>
                                    <p class="text-sm text-gray-600 mb-3">${rec.description}</p>
                                    <button class="btn btn-primary text-sm">${rec.action}</button>
                                </div>
                            </div>
                        </div>
                    `;
                });
                
                container.innerHTML = recommendationsHTML;
            },
            
            updateChartPeriod(period) {
                document.querySelectorAll('.chart-period-btn').forEach(btn => {
                    btn.classList.remove('bg-blue-600', 'text-white');
                    btn.classList.add('border-gray-300', 'hover:bg-gray-50');
                });
                
                event.target.classList.add('bg-blue-600', 'text-white');
                event.target.classList.remove('border-gray-300', 'hover:bg-gray-50');
                
                this.refreshChartData(period);
            },
            
            refreshChartData(period) {
                const data = {
                    week: { lessons: [2, 3, 1, 4, 2, 1, 3], practice: [1, 2, 2, 3, 1, 2, 2] },
                    month: { lessons: [8, 12, 6, 15, 9, 4, 11], practice: [5, 8, 7, 12, 6, 8, 9] },
                    year: { lessons: [45, 67, 38, 89, 52, 23, 78], practice: [28, 45, 42, 67, 38, 45, 56] }
                };
                
                if (this.charts.learningProgress && data[period]) {
                    this.charts.learningProgress.data.datasets[0].data = data[period].lessons;
                    this.charts.learningProgress.data.datasets[1].data = data[period].practice;
                    this.charts.learningProgress.update();
                }
            },
            
            exportProgress() {
                const exportData = {
                    userStats: this.userStats,
                    exportDate: new Date().toISOString(),
                    version: '1.0'
                };
                
                const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `progress-data-${new Date().toISOString().split('T')[0]}.json`;
                a.click();
                URL.revokeObjectURL(url);
                
                alert('Your progress data has been downloaded');
            },
            
            refreshProgress() {
                setTimeout(() => {
                    this.loadProgressTable();
                    this.loadRecommendations();
                    this.updateStatsDisplay();
                    alert('Progress data has been updated');
                }, 1500);
            },
            
            saveStats() {
                localStorage.setItem('totalLessonsCompleted', this.userStats.totalLessonsCompleted.toString());
                localStorage.setItem('studyStreak', this.userStats.studyStreak.toString());
                localStorage.setItem('totalTimeSpent', this.userStats.totalTimeSpent.toString());
                localStorage.setItem('subjectMastery', JSON.stringify(this.userStats.subjectMastery));
                localStorage.setItem('learningGoals', JSON.stringify(this.userStats.learningGoals));
                localStorage.setItem('achievements', JSON.stringify(this.userStats.achievements));
                localStorage.setItem('studyHistory', JSON.stringify(this.userStats.studyHistory));
            },
            
            updateProgress(activity) {
                switch(activity.type) {
                    case 'lessonCompleted':
                        this.userStats.totalLessonsCompleted++;
                        this.userStats.studyStreak++;
                        break;
                    case 'practiceCompleted':
                        this.userStats.totalTimeSpent += activity.timeSpent || 15;
                        break;
                    case 'timeSpent':
                        this.userStats.totalTimeSpent += activity.minutes;
                        break;
                }
                
                this.saveStats();
                this.updateStatsDisplay();
            }
        };

        // Progress system functions
        function updateChartPeriod(period) {
            progressAnalytics.updateChartPeriod(period);
        }

        function exportProgress() {
            progressAnalytics.exportProgress();
        }

        function refreshProgress() {
            progressAnalytics.refreshProgress();
        }
    </script>
</body>
</html>
