<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Accessible Quality Education (AQE)</title>
  
  <!-- Bootstrap 5.x CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css" rel="stylesheet">
  
  <!-- Unified Design System -->
  <link href="resources/styles/design-tokens.css" rel="stylesheet">
  <link href="resources/styles/component-library.css" rel="stylesheet">
  <link href="resources/styles/navigation.css" rel="stylesheet">
  <link href="resources/styles/landing-page.css" rel="stylesheet">
  <link href="resources/styles/dashboard.css" rel="stylesheet">
  <link href="resources/styles/notifications.css" rel="stylesheet">
  
  <!-- Legacy Styles (for compatibility) -->
  <link href="resources/styles/main.css" rel="stylesheet">
  <link href="resources/styles/premium.css" rel="stylesheet">
  <link href="resources/styles/modern-ui.css" rel="stylesheet">
  <link href="resources/styles/transform.css" rel="stylesheet">
  <link href="resources/styles/dark-mode.css" rel="stylesheet">
  <link href="resources/styles/dark-premium.css" rel="stylesheet">
  
  <!-- PWA Manifest -->
  <link rel="manifest" href="/manifest.json">
  
  <!-- PWA Meta Tags -->
  <meta name="theme-color" content="#667eea">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="AQE">
  
  <!-- PWA Icons -->
  <link rel="apple-touch-icon" sizes="180x180" href="/icons/icon-192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/icons/icon-192.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/icons/icon-192.png">
</head>
<body class="bg-light">
  <div id="app">
    <!-- Header -->
    <header class="aqe-header">
      <div class="aqe-header-content">
        <!-- Logo and Branding -->
        <a href="#" class="aqe-logo">
          <div class="aqe-logo-icon">
            <i class="bi bi-mortarboard-fill"></i>
          </div>
          <div class="aqe-brand">
            <h1 class="aqe-brand-title" data-translate="header" data-translate-key="welcome">
              Accessible Quality Education
            </h1>
            <p class="aqe-brand-subtitle" data-translate="header" data-translate-key="welcomeSubtitle">
              Empowering learners worldwide
            </p>
          </div>
        </a>
        
        <!-- Navigation Menu -->
        <nav class="aqe-nav-menu" id="mainNavigationTabs">
          <ul class="aqe-nav-menu">
            <li class="aqe-nav-item">
              <a href="#gettingStarted" class="aqe-nav-link" data-translate="nav" data-translate-key="gettingStarted">
                <i class="bi bi-play-circle me-2"></i>Getting Started
              </a>
            </li>
            <li class="aqe-nav-item">
              <a href="#chooseExperience" class="aqe-nav-link" data-translate="nav" data-translate-key="chooseExperience">
                <i class="bi bi-people me-2"></i>Choose Experience
              </a>
            </li>
            <li class="aqe-nav-item">
              <a href="#institutional" class="aqe-nav-link" data-translate="nav" data-translate-key="institutional">
                <i class="bi bi-building me-2"></i>Institutional
              </a>
            </li>
          </ul>
        </nav>
        
        <!-- Header Actions -->
        <div class="aqe-header-actions">
          <!-- Language Selector -->
          <div class="language-selector">
            <select class="aqe-form-select" onchange="changeLanguage(this.value)" id="languageSelect">
              <option value="en">ðŸ‡ºðŸ‡¸ English</option>
              <option value="es">ðŸ‡ªðŸ‡¸ EspaÃ±ol</option>
              <option value="fr">ðŸ‡«ðŸ‡· FranÃ§ais</option>
              <option value="de">ðŸ‡©ðŸ‡ª Deutsch</option>
              <option value="zh">ðŸ‡¨ðŸ‡³ ä¸­æ–‡</option>
              <option value="ar">ðŸ‡¸ðŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
              <option value="sw">ðŸ‡°ðŸ‡ª Kiswahili</option>
              <option value="am">ðŸ‡ªðŸ‡¹ áŠ áˆ›áˆ­áŠ›</option>
              <option value="zu">ðŸ‡¿ðŸ‡¦ isiZulu</option>
            </select>
          </div>
          
          <!-- Dark Mode Toggle -->
          <button type="button" class="aqe-action-btn theme-toggle" onclick="toggleDarkMode()" title="Toggle dark mode">
            <i class="bi bi-moon-fill d-none" id="darkModeIcon"></i>
            <i class="bi bi-sun-fill" id="lightModeIcon"></i>
          </button>
          
          <!-- Support Button -->
          <button type="button" class="aqe-action-btn support-btn" onclick="showSupportModal()" title="Support Accessibility">
            <i class="bi bi-heart-fill me-1"></i><span>Support</span>
          </button>
          
          <!-- User Profile -->
          <div class="aqe-user-profile dropdown">
            <button class="aqe-user-btn dropdown-toggle" type="button" data-bs-toggle="dropdown">
              <div class="aqe-user-avatar">
                <i class="bi bi-person-fill"></i>
              </div>
              <div class="aqe-user-info">
                <p class="aqe-user-name" id="userFullName" data-translate="user" data-translate-key="guest">Guest User</p>
                <p class="aqe-user-role" id="userRole" data-translate="user" data-translate-key="role">guest</p>
              </div>
            </button>
            <ul class="dropdown-menu dropdown-menu-end user-menu">
              <li><span class="dropdown-item-text small text-muted" id="userRoleDisplay" data-translate="user" data-translate-key="role">guest</span></li>
              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="#" onclick="showProfile()"><i class="bi bi-person me-2"></i>Profile</a></li>
              <li><a class="dropdown-item" href="#" onclick="showSettings()"><i class="bi bi-gear me-2"></i>Settings</a></li>
              <li><a class="dropdown-item" href="#" onclick="logout()"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
            </ul>
          </div>
        </div>
        
        <!-- Mobile Navigation Toggle -->
        <button class="aqe-mobile-nav-toggle" id="mobileNavToggle">
          <span></span>
          <span></span>
          <span></span>
        </button>
      </div>
    </header>

    <!-- Mobile Menu -->
    <div id="mobileMenu" class="d-lg-none mobile-menu d-none">
      <div class="container-fluid py-3">
        <div class="d-flex flex-column gap-3">
          <!-- Mobile Navigation -->
          <div class="d-flex flex-column gap-2">
            <button class="btn btn-outline-primary w-100 text-start mobile-nav-btn" onclick="goToTab('dashboard'); toggleMobileMenu();">
              <i class="bi bi-speedometer2 me-2"></i><span data-translate="nav" data-translate-key="dashboard">Dashboard</span>
            </button>
            <button class="btn btn-outline-primary w-100 text-start mobile-nav-btn" onclick="goToTab('lessons'); toggleMobileMenu();">
              <i class="bi bi-book me-2"></i><span data-translate="nav" data-translate-key="lessons">Lessons</span>
            </button>
            <button class="btn btn-outline-primary w-100 text-start mobile-nav-btn" onclick="goToTab('library'); toggleMobileMenu();">
              <i class="bi bi-collection me-2"></i><span data-translate="nav" data-translate-key="library">Library</span>
            </button>
            <button class="btn btn-outline-primary w-100 text-start mobile-nav-btn admin-tab d-none" onclick="goToTab('admin'); toggleMobileMenu();" id="adminMobileTab">
              <i class="bi bi-gear me-2"></i><span data-translate="nav" data-translate-key="adminPanel">Admin Panel</span>
            </button>
          </div>
          
          <!-- Mobile Actions -->
          <div class="d-flex justify-content-between align-items-center pt-2 border-top">
            <div class="d-flex gap-2">
              <div class="language-selector">
                <select class="form-select form-select-sm" onchange="changeLanguage(this.value)" id="mobileLanguageSelect">
                  <option value="en">ðŸ‡ºðŸ‡¸ English</option>
                  <option value="es">ðŸ‡ªðŸ‡¸ EspaÃ±ol</option>
                  <option value="fr">ðŸ‡«ðŸ‡· FranÃ§ais</option>
                  <option value="de">ðŸ‡©ðŸ‡ª Deutsch</option>
                  <option value="zh">ðŸ‡¨ðŸ‡³ ä¸­æ–‡</option>
                  <option value="ar">ðŸ‡¸ðŸ‡¦ Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
                  <option value="sw">ðŸ‡°ðŸ‡ª Kiswahili</option>
                  <option value="am">ðŸ‡ªðŸ‡¹ áŠ áˆ›áˆ­áŠ›</option>
                  <option value="zu">ðŸ‡¿ðŸ‡¦ isiZulu</option>
                </select>
              </div>
              
              <button type="button" class="btn btn-outline-secondary btn-sm theme-toggle" onclick="toggleDarkMode()" title="Toggle dark mode">
                <i class="bi bi-moon-fill d-none" id="mobileDarkModeIcon"></i>
                <i class="bi bi-sun-fill" id="mobileLightModeIcon"></i>
              </button>
            </div>
            
            <div class="dropdown user-profile">
              <button class="btn btn-primary btn-sm dropdown-toggle user-btn" type="button" data-bs-toggle="dropdown">
                <div class="user-avatar">
                  <i class="bi bi-person-fill"></i>
                </div>
                <div class="user-info">
                  <span class="user-name" id="mobileUserFullName" data-translate="user" data-translate-key="guest">Guest User</span>
                  <span class="user-role" id="mobileUserRole" data-translate="user" data-translate-key="role">guest</span>
                </div>
              </button>
              <ul class="dropdown-menu dropdown-menu-end user-menu">
                <li><span class="dropdown-item-text small text-muted" id="mobileUserRoleDisplay" data-translate="user" data-translate-key="role">guest</span></li>
                <li><hr class="dropdown-divider"></li>
                <li><a class="dropdown-item" href="#" onclick="showProfile()"><i class="bi bi-person me-2"></i>Profile</a></li>
                <li><a class="dropdown-item" href="#" onclick="showSettings()"><i class="bi bi-gear me-2"></i>Settings</a></li>
                <li><a class="dropdown-item" href="#" onclick="logout()"><i class="bi bi-box-arrow-right me-2"></i>Logout</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>


    <!-- Hero Section -->
    <section class="hero-section">
      <div class="container-fluid">
        <div class="row align-items-center min-vh-75 py-5">
          <div class="col-lg-12 text-center">
            <div class="hero-content">
              <div class="mb-4">
                <span class="badge px-4 py-2 rounded-pill hero-badge-modern">
                  <div class="status-indicator me-2"></div>
                  <span data-translate="hero" data-translate-key="languagesBadge">Now Available in 9 Languages</span>
                </span>
              </div>
              <h1 class="hero-title mb-4" data-translate="hero" data-translate-key="title">Learn better with a platform designed for every learner</h1>
              <p class="hero-subtitle mb-4" data-translate="hero" data-translate-key="subtitle">Accessible Quality Education provides personalized learning experiences for students, teachers, and parents.</p>
              <div class="d-flex gap-3 justify-content-center flex-wrap">
                <button class="btn btn-primary btn-lg" onclick="showGettingStarted()">
                  Get Started Free
                </button>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Feature Cards Below Hero -->
        <div class="row g-4 mt-5 pt-5">
          <div class="col-lg-3 col-md-6">
            <div class="content-card text-center">
              <div class="feature-icon mx-auto">
                <i class="bi bi-gear-fill"></i>
              </div>
              <h5 class="mt-3" data-translate="hero" data-translate-key="adaptiveLessons">Adaptive Lessons</h5>
              <p class="text-muted mb-0" data-translate="hero" data-translate-key="adaptiveLessonsDesc">Tailored to your level</p>
            </div>
          </div>
          <div class="col-lg-3 col-md-6">
            <div class="content-card text-center">
              <div class="feature-icon mx-auto">
                <i class="bi bi-wifi-off"></i>
              </div>
              <h5 class="mt-3" data-translate="hero" data-translate-key="offlineReady">Offline Ready</h5>
              <p class="text-muted mb-0" data-translate="hero" data-translate-key="offlineReadyDesc">Keep learning anywhere</p>
            </div>
          </div>
          <div class="col-lg-3 col-md-6">
            <div class="content-card text-center">
              <div class="feature-icon mx-auto">
                <i class="bi bi-people-fill"></i>
              </div>
              <h5 class="mt-3" data-translate="hero" data-translate-key="parentInsights">Parent Insights</h5>
              <p class="text-muted mb-0" data-translate="hero" data-translate-key="parentInsightsDesc">Support and track progress</p>
            </div>
          </div>
          <div class="col-lg-3 col-md-6">
            <div class="content-card text-center">
              <div class="feature-icon mx-auto">
                <i class="bi bi-trophy-fill"></i>
              </div>
              <h5 class="mt-3" data-translate="hero" data-translate-key="progressTracking">Achievements</h5>
              <p class="text-muted mb-0" data-translate="hero" data-translate-key="progressTrackingDesc">Stay motivated</p>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Role-Based Dashboard -->
    <section class="dashboard-metrics py-5 role-dashboard" id="roleDashboard">
      <div class="container-fluid">
        <!-- Student Dashboard -->
        <div class="role-content student-only" id="studentDashboard">
          <!-- Student Navigation Tabs -->
          <ul class="nav nav-pills justify-content-center mb-4" id="studentTabs" role="tablist" style="display: flex; flex-direction: row; flex-wrap: wrap;">
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link active" id="student-dashboard-tab" data-bs-toggle="tab" data-bs-target="#student-dashboard-content" type="button" role="tab">
                <i class="bi bi-speedometer2 me-2"></i>Dashboard
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="student-digital-library-tab" data-bs-toggle="tab" data-bs-target="#student-digital-library-content" type="button" role="tab">
                <i class="bi bi-book me-2"></i>Digital Library
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="student-my-work-tab" data-bs-toggle="tab" data-bs-target="#student-my-work-content" type="button" role="tab">
                <i class="bi bi-briefcase me-2"></i>My Work
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;" id="student-practice-materials-nav" style="display: none;">
              <button class="nav-link" id="student-practice-materials-tab" data-bs-toggle="tab" data-bs-target="#student-practice-materials-content" type="button" role="tab">
                <i class="bi bi-clipboard-check me-2"></i>Practice Materials
              </button>
            </li>
          </ul>

          <!-- Student Tab Content -->
          <div class="tab-content" id="studentTabContent">
            
            <!-- Student Dashboard Tab -->
            <div class="tab-pane fade show active" id="student-dashboard-content" role="tabpanel">
              <!-- Progress Charts Section -->
              <div class="row g-4 mb-4">
                <div class="col-md-8">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Learning Progress</h5>
                      <p class="card-subtitle-modern">Your learning journey over time</p>
                    </div>
                    <div class="card-body">
                      <canvas id="studentProgressChart" width="400" height="200"></canvas>
                    </div>
                  </div>
                </div>
                <div class="col-md-4">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Subject Breakdown</h5>
                      <p class="card-subtitle-modern">Lessons by subject</p>
                    </div>
                    <div class="card-body">
                      <canvas id="studentSubjectChart" width="300" height="200"></canvas>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Key Metrics Cards -->
              <div class="row g-4 mb-4">
                <div class="col-md-3">
                  <div class="metric-card">
                    <div class="metric-icon lessons">
                      <i class="bi bi-book"></i>
                    </div>
                    <div class="metric-content">
                      <h3 class="metric-number" id="studentTotalLessonsAssigned">0</h3>
                      <p class="metric-label">Total Lessons Assigned</p>
                      <small class="metric-progress">By teachers and parents</small>
                    </div>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="metric-card">
                    <div class="metric-icon books">
                      <i class="bi bi-check-circle-fill"></i>
                    </div>
                    <div class="metric-content">
                      <h3 class="metric-number" id="studentLessonsCompleted">0</h3>
                      <p class="metric-label">Lessons Completed</p>
                      <small class="metric-progress">Great job!</small>
                    </div>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="metric-card">
                    <div class="metric-icon streak">
                      <i class="bi bi-fire"></i>
                    </div>
                    <div class="metric-content">
                      <h3 class="metric-number" id="studentCurrentStreak">0</h3>
                      <p class="metric-label">Current Daily Streak</p>
                      <small class="metric-progress">Keep it up!</small>
                    </div>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="metric-card">
                    <div class="metric-icon badges">
                      <i class="bi bi-graph-up"></i>
                    </div>
                    <div class="metric-content">
                      <h3 class="metric-number" id="studentAverageScore">0%</h3>
                      <p class="metric-label">Average Score</p>
                      <small class="metric-progress">Overall performance</small>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Recent Activity -->
              <div class="row g-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Recent Activity</h5>
                      <p class="card-subtitle-modern">Your latest learning activities</p>
                    </div>
                    <div class="card-body">
                      <div id="studentRecentActivity">
                        <div class="text-center text-muted py-3">
                          <i class="bi bi-clock-history" style="font-size: 2rem;"></i>
                          <p class="mt-2 mb-0">No recent activity</p>
                          <small>Start learning to see your activity here!</small>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Student Digital Library Tab -->
            <div class="tab-pane fade" id="student-digital-library-content" role="tabpanel">
              <div class="row">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Digital Library - Assigned Lessons</h5>
                      <p class="card-subtitle-modern">Lessons assigned by your teacher or parent</p>
                    </div>
                    <div class="card-body">
                      <!-- Filters -->
                      <div class="row g-3 mb-4">
                        <div class="col-md-3">
                          <label for="studentSubjectFilter" class="form-label">Subject</label>
                          <select class="form-select" id="studentSubjectFilter" onchange="window.app.filterStudentLibrary()">
                            <option value="">All Subjects</option>
                          </select>
                        </div>
                        <div class="col-md-3">
                          <label for="studentAssignerFilter" class="form-label">Assigner</label>
                          <select class="form-select" id="studentAssignerFilter" onchange="window.app.filterStudentLibrary()">
                            <option value="">All Assigners</option>
                            <option value="teacher">Teacher</option>
                            <option value="parent">Parent</option>
                          </select>
                        </div>
                        <div class="col-md-3">
                          <label for="studentStatusFilter" class="form-label">Status</label>
                          <select class="form-select" id="studentStatusFilter" onchange="window.app.filterStudentLibrary()">
                            <option value="">All Status</option>
                            <option value="pending">Not Started</option>
                            <option value="in_progress">In Progress</option>
                            <option value="completed">Completed</option>
                          </select>
                        </div>
                        <div class="col-md-3">
                          <label for="studentSearchFilter" class="form-label">Search</label>
                          <input type="text" class="form-control" id="studentSearchFilter" placeholder="Search lessons..." onkeyup="window.app.filterStudentLibrary()">
                        </div>
                      </div>

                      <!-- Lessons Grid -->
                      <div class="row g-4" id="studentDigitalLibraryGrid">
                        <div class="col-12 text-center">
                          <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading assignments...</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Student My Work Tab -->
            <div class="tab-pane fade" id="student-my-work-content" role="tabpanel">
              <div class="row">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">My Work - Checked Out Lessons</h5>
                      <p class="card-subtitle-modern">Lessons you've checked out from the Digital Library</p>
                    </div>
                    <div class="card-body">
                      <!-- Subject Filter -->
                      <div class="row g-3 mb-4">
                        <div class="col-md-4">
                          <label for="myWorkSubjectFilter" class="form-label">Filter by Subject</label>
                          <select class="form-select" id="myWorkSubjectFilter" onchange="filterMyWork()">
                            <option value="">All Subjects</option>
                            <option value="Science">Science</option>
                            <option value="Technology">Technology</option>
                            <option value="English">English</option>
                            <option value="Math">Math</option>
                            <option value="Geography">Geography</option>
                          </select>
                        </div>
                        <div class="col-md-4">
                          <label for="myWorkStatusFilter" class="form-label">Filter by Status</label>
                          <select class="form-select" id="myWorkStatusFilter" onchange="filterMyWork()">
                            <option value="">All Status</option>
                            <option value="not_started">Not Started</option>
                            <option value="in_progress">In Progress</option>
                            <option value="completed">Completed</option>
                          </select>
                        </div>
                        <div class="col-md-4">
                          <label for="searchMyWork" class="form-label">Search My Work</label>
                          <input type="text" class="form-control" id="searchMyWork" placeholder="Search by title..." onkeyup="filterMyWork()">
                        </div>
                      </div>

                      <!-- My Work Grid -->
                      <div class="row g-4" id="studentMyWorkGrid">
                        <div class="col-12 text-center text-muted py-5">
                          <i class="bi bi-briefcase" style="font-size: 3rem;"></i>
                          <h5 class="mt-3">No lessons checked out yet</h5>
                          <p class="mb-0">Check out lessons from the Digital Library to start working on them.</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Student Practice Materials Tab (Class Students Only) -->
            <div class="tab-pane fade" id="student-practice-materials-content" role="tabpanel">
              <div class="row">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Practice Materials</h5>
                      <p class="card-subtitle-modern">Practice materials assigned by your teacher</p>
                    </div>
                    <div class="card-body">
                      <!-- Subject Filter -->
                      <div class="row g-3 mb-4">
                        <div class="col-md-4">
                          <label for="practiceSubjectFilter" class="form-label">Filter by Subject</label>
                          <select class="form-select" id="practiceSubjectFilter" onchange="filterPracticeMaterials()">
                            <option value="">All Subjects</option>
                            <option value="Science">Science</option>
                            <option value="Technology">Technology</option>
                            <option value="English">English</option>
                            <option value="Math">Math</option>
                            <option value="Geography">Geography</option>
                          </select>
                        </div>
                        <div class="col-md-4">
                          <label for="practiceStatusFilter" class="form-label">Filter by Status</label>
                          <select class="form-select" id="practiceStatusFilter" onchange="filterPracticeMaterials()">
                            <option value="">All Status</option>
                            <option value="not_started">Not Started</option>
                            <option value="in_progress">In Progress</option>
                            <option value="completed">Completed</option>
                          </select>
                        </div>
                        <div class="col-md-4">
                          <label for="searchPracticeMaterials" class="form-label">Search Practice Materials</label>
                          <input type="text" class="form-control" id="searchPracticeMaterials" placeholder="Search by title..." onkeyup="filterPracticeMaterials()">
                        </div>
                      </div>

                      <!-- Practice Materials Grid -->
                      <div class="row g-4" id="studentPracticeMaterialsGrid">
                        <div class="col-12 text-center text-muted py-5">
                          <i class="bi bi-clipboard-check" style="font-size: 3rem;"></i>
                          <h5 class="mt-3">No practice materials assigned yet</h5>
                          <p class="mb-0">Your teacher will assign practice materials for you to complete.</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Teacher Dashboard -->
        <div class="role-content teacher-only" id="teacherDashboard">
          <!-- Teacher Navigation Tabs -->
          <ul class="nav nav-pills justify-content-center mb-4" id="teacherTabs" role="tablist" style="display: flex; flex-direction: row; flex-wrap: wrap;">
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link active" id="teacher-dashboard-tab" data-bs-toggle="tab" data-bs-target="#teacher-dashboard-content" type="button" role="tab">
                <i class="bi bi-speedometer2 me-2"></i>Dashboard
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="students-tab" data-bs-toggle="tab" data-bs-target="#students-content" type="button" role="tab">
                <i class="bi bi-people me-2"></i>My Students
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="create-materials-tab" data-bs-toggle="tab" data-bs-target="#create-materials-content" type="button" role="tab">
                <i class="bi bi-plus-circle me-2"></i>Create Practice Materials
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="view-materials-tab" data-bs-toggle="tab" data-bs-target="#view-materials-content" type="button" role="tab">
                <i class="bi bi-eye me-2"></i>View Practice Materials
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="digital-library-tab" data-bs-toggle="tab" data-bs-target="#digital-library-content" type="button" role="tab">
                <i class="bi bi-book me-2"></i>Digital Library
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="professional-dev-tab" data-bs-toggle="tab" data-bs-target="#professional-dev-content" type="button" role="tab">
                <i class="bi bi-award-fill me-2"></i>Professional Development
              </button>
            </li>
          </ul>

          <!-- Teacher Tab Content -->
          <div class="tab-content" id="teacherTabContent">
            
            <!-- Dashboard Tab -->
            <div class="tab-pane fade show active" id="teacher-dashboard-content" role="tabpanel">
              <!-- Recent Activity -->
              <div class="row g-4 mb-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Recent Activity</h5>
                    </div>
                    <div class="card-body">
                      <div id="recentActivityList">
                        <!-- Recent activity will be populated here -->
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Dashboard Stats Cards -->
              <div class="row g-4 mb-5">
                <div class="col-md-3">
                  <div class="metric-card">
                    <div class="metric-icon students">
                      <i class="bi bi-people-fill"></i>
                    </div>
                    <div class="metric-content">
                      <h3 class="metric-number" id="totalStudents">0</h3>
                      <p class="metric-label">Students</p>
                      <small class="metric-progress">Active</small>
                    </div>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="metric-card">
                    <div class="metric-icon assignments">
                      <i class="bi bi-clipboard-check-fill"></i>
                    </div>
                    <div class="metric-content">
                      <h3 class="metric-number" id="totalPracticeMaterials">0</h3>
                      <p class="metric-label">Practice Materials</p>
                      <small class="metric-progress">Created</small>
                    </div>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="metric-card">
                    <div class="metric-icon grades">
                      <i class="bi bi-graph-up-arrow"></i>
                    </div>
                    <div class="metric-content">
                      <h3 class="metric-number" id="avgScore">0%</h3>
                      <p class="metric-label">Avg Score</p>
                      <small class="metric-progress">Class average</small>
                    </div>
                  </div>
                </div>
                <div class="col-md-3">
                  <div class="metric-card">
                    <div class="metric-icon engagement">
                      <i class="bi bi-check-circle-fill"></i>
                    </div>
                    <div class="metric-content">
                      <h3 class="metric-number" id="completedAssignments">0</h3>
                      <p class="metric-label">Completed</p>
                      <small class="metric-progress">Assignments</small>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Curriculum Analytics Section -->
              <div class="row g-4 mb-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Curriculum Analytics</h5>
                      <p class="card-subtitle-modern">Track lesson assignments and student progress</p>
                    </div>
                    <div class="card-body">
                      <div class="row g-4">
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon content">
                              <i class="bi bi-book-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="teacherLessonsInLibrary">0</h3>
                              <p class="metric-label">Lessons in Library</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon users">
                              <i class="bi bi-person-plus-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="teacherAssignmentsCreated">0</h3>
                              <p class="metric-label">Assignments Created</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon system">
                              <i class="bi bi-people-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="teacherStudentsAssigned">0</h3>
                              <p class="metric-label">Students Assigned</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon revenue">
                              <i class="bi bi-graph-up"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="teacherAvgClassScore">0%</h3>
                              <p class="metric-label">Avg Class Score</p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Ask Question Section -->
              <div class="row g-4 mb-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Need Help?</h5>
                      <p class="card-subtitle-modern">Have a question or need support? Ask our admin team!</p>
                    </div>
                    <div class="card-body text-center">
                      <button class="btn btn-primary btn-lg" onclick="showAskQuestionModal()">
                        <i class="bi bi-question-circle me-2"></i>Ask a Question
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- My Students Tab -->
            <div class="tab-pane fade" id="students-content" role="tabpanel">
              <div class="row g-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern d-flex justify-content-between align-items-center">
                      <h5 class="card-title-modern mb-0">My Students</h5>
                      <button class="btn btn-primary btn-sm" onclick="showAddStudentModal()">
                        <i class="bi bi-person-plus me-1"></i>Add Student
                      </button>
                    </div>
                    <div class="card-body">
                      <div class="table-responsive">
                        <table class="table table-hover">
                          <thead>
                            <tr>
                              <th>Name</th>
                              <th>Grade Level</th>
                              <th>Access Code</th>
                              <th>Last Login</th>
                              <th>Actions</th>
                            </tr>
                          </thead>
                          <tbody id="studentsTableBody">
                            <!-- Students will be populated here -->
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Create Practice Materials Tab -->
            <div class="tab-pane fade" id="create-materials-content" role="tabpanel">
              <div class="row g-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Create Practice Material</h5>
                    </div>
                    <div class="card-body">
                      <form id="createMaterialForm">
                        <div class="row g-3">
                          <div class="col-md-6">
                            <label for="materialTitle" class="form-label">Title</label>
                            <input type="text" class="form-control" id="materialTitle" required>
                          </div>
                          <div class="col-md-6">
                            <label for="materialSubject" class="form-label">Subject</label>
                            <select class="form-select" id="materialSubject" required>
                              <option value="">Select Subject</option>
                              <option value="Science">Science</option>
                              <option value="Technology">Technology</option>
                              <option value="English">English</option>
                              <option value="Math">Math</option>
                              <option value="Geography">Geography</option>
                            </select>
                          </div>
                          <div class="col-12">
                            <label for="materialDescription" class="form-label">Description</label>
                            <textarea class="form-control" id="materialDescription" rows="3"></textarea>
                          </div>
                        </div>
                        
                        <!-- Questions Section -->
                        <div class="mt-4">
                          <div class="d-flex justify-content-between align-items-center mb-3">
                            <h6>Questions</h6>
                            <button type="button" class="btn btn-outline-primary btn-sm" onclick="addQuestion()">
                              <i class="bi bi-plus me-1"></i>Add Question
                            </button>
                          </div>
                          <div id="questionsContainer">
                            <!-- Questions will be added here dynamically -->
                          </div>
                        </div>

                        <div class="mt-4">
                          <button type="submit" class="btn btn-primary">
                            <i class="bi bi-save me-1"></i>Create Material
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- View Practice Materials Tab -->
            <div class="tab-pane fade" id="view-materials-content" role="tabpanel">
              <div class="row g-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Practice Materials</h5>
                    </div>
                    <div class="card-body">
                      <div class="row g-3" id="practiceMaterialsGrid">
                        <!-- Practice materials will be populated here -->
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Digital Library Tab -->
            <div class="tab-pane fade" id="digital-library-content" role="tabpanel">
              <div class="row g-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Digital Library</h5>
                      <p class="card-subtitle-modern">Published lessons available for assignment to your students</p>
                    </div>
                    <div class="card-body">
                      <!-- Filters -->
                      <div class="row g-3 mb-4">
                        <div class="col-md-3">
                          <label for="teacherSubjectFilter" class="form-label">Subject</label>
                          <select class="form-select" id="teacherSubjectFilter" onchange="window.app.filterTeacherLibrary()">
                            <option value="">All Subjects</option>
                          </select>
                        </div>
                        <div class="col-md-3">
                          <label for="teacherGradeFilter" class="form-label">Grade</label>
                          <select class="form-select" id="teacherGradeFilter" onchange="window.app.filterTeacherLibrary()">
                            <option value="">All Grades</option>
                          </select>
                        </div>
                        <div class="col-md-3">
                          <label for="teacherDifficultyFilter" class="form-label">Difficulty</label>
                          <select class="form-select" id="teacherDifficultyFilter" onchange="window.app.filterTeacherLibrary()">
                            <option value="">All Levels</option>
                            <option value="A">Lesson A (Easier)</option>
                            <option value="B">Lesson B (Moderate)</option>
                          </select>
                        </div>
                        <div class="col-md-3">
                          <label for="teacherSearchFilter" class="form-label">Search</label>
                          <input type="text" class="form-control" id="teacherSearchFilter" placeholder="Search lessons..." onkeyup="window.app.filterTeacherLibrary()">
                        </div>
                      </div>
                      
                      <!-- Lessons Grid -->
                      <div class="row g-4" id="teacherLibraryGrid">
                        <div class="col-12 text-center">
                          <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading lessons...</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Professional Development Tab -->
            <div class="tab-pane fade" id="professional-dev-content" role="tabpanel">
              <div class="row g-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">
                        <i class="bi bi-award-fill me-2"></i>Certification & Professional Development
                      </h5>
                      <p class="card-subtitle-modern">Earn recognized credentials and advance your teaching career</p>
                    </div>
                    <div class="card-body">
                      <p class="lead">Complete our professional development courses and earn certificates that you can display on your profile. Perfect for continuing education credits and professional recognition.</p>
                      
                      <div class="row g-4 mt-3">
                        <div class="col-md-6">
                          <div class="card h-100 border-primary">
                            <div class="card-body">
                              <div class="d-flex align-items-start mb-3">
                                <i class="bi bi-mortarboard-fill text-primary fs-1 me-3"></i>
                                <div>
                                  <h5 class="card-title">Teacher Proficiency Certificate</h5>
                                  <h4 class="text-primary mb-3">$25</h4>
                                  <p>Master the fundamentals of modern teaching methods and student engagement strategies.</p>
                                  <ul class="small">
                                    <li>5 professional development modules</li>
                                    <li>Digital badge for your profile</li>
                                    <li>Certificate of completion</li>
                                    <li>Can be used for CE credits</li>
                                  </ul>
                                </div>
                              </div>
                              <button class="btn btn-primary w-100" onclick="supportManager.purchaseCertification('teacher_proficiency', 25)">
                                <i class="bi bi-cart me-2"></i>Enroll Now
                              </button>
                            </div>
                          </div>
                        </div>
                        
                        <div class="col-md-6">
                          <div class="card h-100 border-success">
                            <div class="card-body">
                              <div class="d-flex align-items-start mb-3">
                                <i class="bi bi-bookmark-star-fill text-success fs-1 me-3"></i>
                                <div>
                                  <h5 class="card-title">Homeschool Mastery Certification</h5>
                                  <h4 class="text-success mb-3">$50</h4>
                                  <p>Comprehensive certification for homeschool parents and educators.</p>
                                  <ul class="small">
                                    <li>10 comprehensive modules</li>
                                    <li>Advanced curriculum planning</li>
                                    <li>Student assessment strategies</li>
                                    <li>Verification badge</li>
                                  </ul>
                                </div>
                              </div>
                              <button class="btn btn-success w-100" onclick="supportManager.purchaseCertification('homeschool_mastery', 50)">
                                <i class="bi bi-cart me-2"></i>Enroll Now
                              </button>
                            </div>
                          </div>
                        </div>
                        
                        <div class="col-md-6">
                          <div class="card h-100 border-warning">
                            <div class="card-body">
                              <div class="d-flex align-items-start mb-3">
                                <i class="bi bi-trophy-fill text-warning fs-1 me-3"></i>
                                <div>
                                  <h5 class="card-title">Special Education Specialist</h5>
                                  <h4 class="text-warning mb-3">$50</h4>
                                  <p>Specialized training for inclusive and special needs education.</p>
                                  <ul class="small">
                                    <li>8 specialized modules</li>
                                    <li>Adaptive learning strategies</li>
                                    <li>IEP development skills</li>
                                    <li>Professional recognition</li>
                                  </ul>
                                </div>
                              </div>
                              <button class="btn btn-warning w-100" onclick="supportManager.purchaseCertification('special_education', 50)">
                                <i class="bi bi-cart me-2"></i>Enroll Now
                              </button>
                            </div>
                          </div>
                        </div>

                        <div class="col-md-6">
                          <div class="card h-100 bg-light border">
                            <div class="card-body text-center d-flex flex-column justify-content-center">
                              <i class="bi bi-award-fill" style="font-size: 4rem; color: #667eea; opacity: 0.3;"></i>
                              <h5 class="mt-3">Earn Verified Certificates</h5>
                              <p class="text-muted">Display your achievements and advance your career with recognized credentials.</p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>

        <!-- Parent Dashboard -->
        <div class="role-content parent-only" id="parentDashboard">
          <div class="row g-4 mb-5">
            <div class="col-md-3">
              <div class="metric-card">
                <div class="metric-icon children">
                  <i class="bi bi-person-heart"></i>
                </div>
                <div class="metric-content">
                  <h3 class="metric-number" id="childrenCount">2</h3>
                  <p class="metric-label">Children</p>
                  <small class="metric-progress">Enrolled</small>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="metric-card">
                <div class="metric-icon progress">
                  <i class="bi bi-trophy-fill"></i>
                </div>
                <div class="metric-content">
                  <h3 class="metric-number" id="childProgress">78%</h3>
                  <p class="metric-label">Progress</p>
                  <small class="metric-progress">Overall completion</small>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="metric-card">
                <div class="metric-icon time">
                  <i class="bi bi-clock-fill"></i>
                </div>
                <div class="metric-content">
                  <h3 class="metric-number" id="studyTime">2.5h</h3>
                  <p class="metric-label">Study Time</p>
                  <small class="metric-progress">This week</small>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="metric-card">
                <div class="metric-icon alerts">
                  <i class="bi bi-bell-fill"></i>
                </div>
                <div class="metric-content">
                  <h3 class="metric-number" id="alerts">3</h3>
                  <p class="metric-label">Alerts</p>
                  <small class="metric-progress">Need attention</small>
                </div>
              </div>
            </div>
          </div>
          <!-- Parent Navigation Tabs -->
          <ul class="nav nav-pills justify-content-center mb-4" id="parentTabs" role="tablist" style="display: flex; flex-direction: row; flex-wrap: wrap;">
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link active" id="parent-dashboard-tab" data-bs-toggle="tab" data-bs-target="#parent-dashboard-content" type="button" role="tab">
                <i class="bi bi-speedometer2 me-2"></i>Dashboard
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="parent-digital-library-tab" data-bs-toggle="tab" data-bs-target="#parent-digital-library-content" type="button" role="tab">
                <i class="bi bi-book me-2"></i>Digital Library
              </button>
            </li>
          </ul>

          <!-- Parent Tab Content -->
          <div class="tab-content" id="parentTabContent">
            
            <!-- Parent Dashboard Tab -->
            <div class="tab-pane fade show active" id="parent-dashboard-content" role="tabpanel">
              <div class="row g-4 mb-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Children Overview</h5>
                      <p class="card-subtitle-modern">Progress and activity for your children</p>
                    </div>
                    <div class="card-body">
                      <div class="table-responsive">
                        <table class="table table-hover">
                          <thead class="table-dark">
                            <tr>
                              <th>Child Name</th>
                              <th>Grade Level</th>
                              <th>Practice Materials</th>
                              <th>Lessons</th>
                              <th>Overall Progress</th>
                              <th>Actions</th>
                            </tr>
                          </thead>
                          <tbody id="parentChildrenTableBody">
                            <tr>
                              <td colspan="6" class="text-center text-muted">Loading children data...</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Curriculum Analytics Section -->
              <div class="row g-4 mb-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Curriculum Analytics</h5>
                      <p class="card-subtitle-modern">Track lesson assignments and children's progress</p>
                    </div>
                    <div class="card-body">
                      <div class="row g-4">
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon content">
                              <i class="bi bi-book-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="parentLessonsAvailable">0</h3>
                              <p class="metric-label">Lessons Available</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon users">
                              <i class="bi bi-person-plus-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="parentAssignmentsCreated">0</h3>
                              <p class="metric-label">Assignments Created</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon system">
                              <i class="bi bi-people-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="parentChildAttempts">0</h3>
                              <p class="metric-label">Child Attempts</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon revenue">
                              <i class="bi bi-graph-up"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="parentAvgScore">0%</h3>
                              <p class="metric-label">Avg Score</p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Parent Digital Library Tab -->
            <div class="tab-pane fade" id="parent-digital-library-content" role="tabpanel">
              <div class="row g-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Digital Library</h5>
                      <p class="card-subtitle-modern">Published lessons available for assignment to your children</p>
                    </div>
                    <div class="card-body">
                      <!-- Filters -->
                      <div class="row g-3 mb-4">
                        <div class="col-md-3">
                          <label for="parentSubjectFilter" class="form-label">Subject</label>
                          <select class="form-select" id="parentSubjectFilter" onchange="window.app.filterParentLibrary()">
                            <option value="">All Subjects</option>
                          </select>
                        </div>
                        <div class="col-md-3">
                          <label for="parentGradeFilter" class="form-label">Grade</label>
                          <select class="form-select" id="parentGradeFilter" onchange="window.app.filterParentLibrary()">
                            <option value="">All Grades</option>
                          </select>
                        </div>
                        <div class="col-md-3">
                          <label for="parentDifficultyFilter" class="form-label">Difficulty</label>
                          <select class="form-select" id="parentDifficultyFilter" onchange="window.app.filterParentLibrary()">
                            <option value="">All Levels</option>
                            <option value="A">Lesson A (Easier)</option>
                            <option value="B">Lesson B (Moderate)</option>
                          </select>
                        </div>
                        <div class="col-md-3">
                          <label for="parentSearchFilter" class="form-label">Search</label>
                          <input type="text" class="form-control" id="parentSearchFilter" placeholder="Search lessons..." onkeyup="window.app.filterParentLibrary()">
                        </div>
                      </div>
                      
                      <!-- Lessons Grid -->
                      <div class="row g-4" id="parentLibraryGrid">
                        <div class="col-12 text-center">
                          <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading lessons...</span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Admin Dashboard -->
        <div class="role-content" id="adminDashboard">
          <div class="row g-4 mb-5">
            <div class="col-md-3">
              <div class="metric-card">
                <div class="metric-icon users">
                  <i class="bi bi-people-fill"></i>
                </div>
                <div class="metric-content">
                  <h3 class="metric-number" id="totalUsers">1,247</h3>
                  <p class="metric-label">Total Users</p>
                  <small class="metric-progress">Registered</small>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="metric-card">
                <div class="metric-icon content">
                  <i class="bi bi-folder-fill"></i>
                </div>
                <div class="metric-content">
                  <h3 class="metric-number" id="totalContent">156</h3>
                  <p class="metric-label">Content Items</p>
                  <small class="metric-progress">Available</small>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="metric-card">
                <div class="metric-icon system">
                  <i class="bi bi-server"></i>
                </div>
                <div class="metric-content">
                  <h3 class="metric-number" id="systemHealth">99.8%</h3>
                  <p class="metric-label">System Health</p>
                  <small class="metric-progress">Uptime</small>
                </div>
              </div>
            </div>
            <div class="col-md-3">
              <div class="metric-card">
                <div class="metric-icon revenue">
                  <i class="bi bi-currency-dollar"></i>
                </div>
                <div class="metric-content">
                  <h3 class="metric-number" id="revenue">$12.4K</h3>
                  <p class="metric-label">Revenue</p>
                  <small class="metric-progress">This month</small>
                </div>
              </div>
            </div>
          </div>
          <!-- Admin Navigation Tabs -->
          <ul class="nav nav-pills justify-content-center mb-4" id="adminTabs" role="tablist" style="display: flex; flex-direction: row; flex-wrap: wrap;">
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link active" id="admin-dashboard-tab" data-bs-toggle="tab" data-bs-target="#admin-dashboard-content" type="button" role="tab">
                <i class="bi bi-speedometer2 me-2"></i>Dashboard
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="admin-user-management-tab" data-bs-toggle="tab" data-bs-target="#admin-user-management-content" type="button" role="tab">
                <i class="bi bi-people me-2"></i>User Management
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="admin-content-management-tab" data-bs-toggle="tab" data-bs-target="#admin-content-management-content" type="button" role="tab">
                <i class="bi bi-folder me-2"></i>Content Management
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="admin-course-management-tab" data-bs-toggle="tab" data-bs-target="#admin-course-management-content" type="button" role="tab">
                <i class="bi bi-mortarboard me-2"></i>Course Management
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="admin-system-settings-tab" data-bs-toggle="tab" data-bs-target="#admin-system-settings-content" type="button" role="tab">
                <i class="bi bi-gear me-2"></i>System Settings
              </button>
            </li>
            <li class="nav-item" role="presentation" style="display: inline-block;">
              <button class="nav-link" id="admin-accessibility-tab" data-bs-toggle="tab" data-bs-target="#admin-accessibility-content" type="button" role="tab">
                <i class="bi bi-phone me-2"></i>SMS/USSD
              </button>
            </li>
          </ul>

          <!-- Admin Tab Content -->
          <div class="tab-content" id="adminTabContent">
            
            <!-- Admin Dashboard Tab -->
            <div class="tab-pane fade show active" id="admin-dashboard-content" role="tabpanel">
              <div class="row g-4 mb-4">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">System Overview</h5>
                      <p class="card-subtitle-modern">Current system statistics and health</p>
                    </div>
                    <div class="card-body">
                      <div class="row g-4">
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon users">
                              <i class="bi bi-people-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="adminTotalUsers">0</h3>
                              <p class="metric-label">Total Users</p>
                              <small class="metric-progress">Registered</small>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon content">
                              <i class="bi bi-mortarboard-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="adminTotalStudents">0</h3>
                              <p class="metric-label">Students</p>
                              <small class="metric-progress">Active</small>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon system">
                              <i class="bi bi-easel-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="adminTotalTeachers">0</h3>
                              <p class="metric-label">Teachers</p>
                              <small class="metric-progress">Active</small>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon revenue">
                              <i class="bi bi-heart-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="adminTotalParents">0</h3>
                              <p class="metric-label">Parents</p>
                              <small class="metric-progress">Active</small>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Admin User Management Tab -->
            <div class="tab-pane fade" id="admin-user-management-content" role="tabpanel">
              <div class="row">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">User Management</h5>
                      <p class="card-subtitle-modern">Manage user accounts and permissions</p>
                    </div>
                    <div class="card-body">
                      <div class="table-responsive">
                        <table class="table table-hover">
                          <thead class="table-dark">
                            <tr>
                              <th>Name</th>
                              <th>Email</th>
                              <th>Role</th>
                              <th>Status</th>
                              <th>Created</th>
                              <th>Last Login</th>
                              <th>Actions</th>
                            </tr>
                          </thead>
                          <tbody id="adminUsersTableBody">
                            <tr>
                              <td colspan="7" class="text-center text-muted">Loading users...</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Admin Content Management Tab -->
            <div class="tab-pane fade" id="admin-content-management-content" role="tabpanel">
              <div class="row">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Content Management</h5>
                      <p class="card-subtitle-modern">Create and manage lessons for the Digital Library</p>
                    </div>
                    <div class="card-body">
                      <div class="row mb-4">
                        <div class="col-md-6">
                                          <button class="btn btn-primary" onclick="showCreateLessonModal()">
                    <i class="bi bi-magic me-2"></i>Create New Lesson (AI)
                </button>
                        </div>
                        <div class="col-md-6 text-end">
                          <div class="metric-card">
                            <div class="metric-content">
                              <h3 class="metric-number" id="adminTotalLessons">0</h3>
                              <p class="metric-label">Total Lessons</p>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="table-responsive">
                        <table class="table table-hover">
                          <thead class="table-dark">
                            <tr>
                              <th>Title</th>
                              <th>Subject</th>
                              <th>Grade Level</th>
                              <th>Status</th>
                              <th>Created</th>
                              <th>Actions</th>
                            </tr>
                          </thead>
                          <tbody id="adminLessonsTableBody">
                            <tr>
                              <td colspan="6" class="text-center text-muted">Loading lessons...</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Admin Course Management Tab -->
            <div class="tab-pane fade" id="admin-course-management-content" role="tabpanel">
              <div class="row g-4 mb-4">
                <!-- Course Generation Section -->
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Curriculum Generation</h5>
                      <p class="card-subtitle-modern">Generate lessons automatically for all subjects and grades</p>
                    </div>
                    <div class="card-body">
                      <div class="row mb-4">
                        <div class="col-md-8">
                          <div class="alert alert-info">
                            <i class="bi bi-info-circle me-2"></i>
                            <strong>Auto-Generation:</strong> Generate 2 lessons per subject per grade (Lesson A = easier, Lesson B = moderate). Each lesson contains exactly 5 multiple-choice questions.
                          </div>
                        </div>
                        <div class="col-md-4 text-end">
                          <button class="btn btn-primary btn-lg" onclick="showGenerateLessonsModal()">
                            <i class="bi bi-magic me-2"></i>Generate Lessons
                          </button>
                        </div>
                      </div>
                      
                      <!-- Generation Filters -->
                      <div class="row mb-4">
                        <div class="col-md-6">
                          <label class="form-label">Subjects</label>
                          <select class="form-select" id="subjectFilter" multiple>
                            <option value="">All Subjects</option>
                          </select>
                        </div>
                        <div class="col-md-6">
                          <label class="form-label">Grades</label>
                          <select class="form-select" id="gradeFilter" multiple>
                            <option value="">All Grades</option>
                          </select>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Generated Lessons Section -->
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Generated Lessons</h5>
                      <p class="card-subtitle-modern">Manage and publish auto-generated lessons</p>
                    </div>
                    <div class="card-body">
                      <div class="row mb-4">
                        <div class="col-md-6">
                          <div class="btn-group" role="group">
                            <button class="btn btn-outline-primary" onclick="filterLessons('all')">All</button>
                            <button class="btn btn-outline-primary" onclick="filterLessons('draft')">Draft</button>
                            <button class="btn btn-outline-primary" onclick="filterLessons('published')">Published</button>
                          </div>
                        </div>
                        <div class="col-md-6 text-end">
                          <button class="btn btn-success" onclick="showPublishLessonsModal()" disabled id="publishLessonsBtn">
                            <i class="bi bi-cloud-upload me-2"></i>Publish Selected
                          </button>
                        </div>
                      </div>
                      
                      <div class="table-responsive">
                        <table class="table table-hover">
                          <thead class="table-dark">
                            <tr>
                              <th>
                                <input type="checkbox" id="selectAllLessons" onchange="toggleAllLessons(this)">
                              </th>
                              <th>Title</th>
                              <th>Subject</th>
                              <th>Grade</th>
                              <th>Difficulty</th>
                              <th>Status</th>
                              <th>Questions</th>
                              <th>Created</th>
                              <th>Actions</th>
                            </tr>
                          </thead>
                          <tbody id="generatedLessonsTableBody">
                            <tr>
                              <td colspan="9" class="text-center text-muted">Loading lessons...</td>
                            </tr>
                          </tbody>
                        </table>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Analytics Section -->
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">Curriculum Analytics</h5>
                      <p class="card-subtitle-modern">Track lesson generation and usage statistics</p>
                    </div>
                    <div class="card-body">
                      <div class="row g-4">
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon content">
                              <i class="bi bi-mortarboard-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="adminLessonsGenerated">0</h3>
                              <p class="metric-label">Lessons Generated</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon users">
                              <i class="bi bi-people-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="adminLessonsPublishedParent">0</h3>
                              <p class="metric-label">Published to Parents</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon system">
                              <i class="bi bi-easel-fill"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="adminLessonsPublishedTeacher">0</h3>
                              <p class="metric-label">Published to Teachers</p>
                            </div>
                          </div>
                        </div>
                        <div class="col-md-3">
                          <div class="metric-card">
                            <div class="metric-icon revenue">
                              <i class="bi bi-graph-up"></i>
                            </div>
                            <div class="metric-content">
                              <h3 class="metric-number" id="adminAssignmentsCreated">0</h3>
                              <p class="metric-label">Assignments Created</p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Admin System Settings Tab -->
            <div class="tab-pane fade" id="admin-system-settings-content" role="tabpanel">
              <div class="row">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">System Settings</h5>
                      <p class="card-subtitle-modern">Configure global system settings</p>
                    </div>
                    <div class="card-body">
                      <div class="row g-4">
                        <div class="col-md-6">
                          <h6>Grade Levels</h6>
                          <p class="text-muted">Configure available grade levels for the system</p>
                          <ul class="list-group">
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              Kindergarten
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              1st Grade
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              2nd Grade
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              3rd Grade
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              4th Grade
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              5th Grade
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              6th Grade
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              7th Grade
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              8th Grade
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                          </ul>
                        </div>
                        <div class="col-md-6">
                          <h6>Subjects</h6>
                          <p class="text-muted">Configure available subjects for lessons and practice materials</p>
                          <ul class="list-group">
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              Science
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              Technology
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              English
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              Math
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                            <li class="list-group-item d-flex justify-content-between align-items-center">
                              Geography
                              <span class="badge bg-primary rounded-pill">Active</span>
                            </li>
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Admin SMS/USSD Accessibility Tab -->
            <div class="tab-pane fade" id="admin-accessibility-content" role="tabpanel">
              <div class="row">
                <div class="col-12">
                  <div class="modern-card">
                    <div class="card-header-modern">
                      <h5 class="card-title-modern">SMS/USSD Accessibility</h5>
                      <p class="card-subtitle-modern">Manage SMS and USSD learning experiences</p>
                    </div>
                    <div class="card-body">
                      <!-- Accessibility Navigation Sub-tabs -->
                      <ul class="nav nav-tabs mb-3" role="tablist">
                        <li class="nav-item" role="presentation">
                          <button class="nav-link active" data-accessibility-tab="overview" type="button">
                            <i class="bi bi-speedometer2 me-1"></i>Overview
                          </button>
                        </li>
                        <li class="nav-item" role="presentation">
                          <button class="nav-link" data-accessibility-tab="messages" type="button">
                            <i class="bi bi-chat-dots me-1"></i>Messages
                          </button>
                        </li>
                        <li class="nav-item" role="presentation">
                          <button class="nav-link" data-accessibility-tab="keywords" type="button">
                            <i class="bi bi-key me-1"></i>Keywords
                          </button>
                        </li>
                        <li class="nav-item" role="presentation">
                          <button class="nav-link" data-accessibility-tab="flows" type="button">
                            <i class="bi bi-diagram-3 me-1"></i>Flows
                          </button>
                        </li>
                        <li class="nav-item" role="presentation">
                          <button class="nav-link" data-accessibility-tab="routing" type="button">
                            <i class="bi bi-arrow-left-right me-1"></i>Routing
                          </button>
                        </li>
                        <li class="nav-item" role="presentation">
                          <button class="nav-link" data-accessibility-tab="content-targeting" type="button">
                            <i class="bi bi-bullseye me-1"></i>Content Targeting
                          </button>
                        </li>
                        <li class="nav-item" role="presentation">
                          <button class="nav-link" data-accessibility-tab="opt-ins" type="button">
                            <i class="bi bi-check2-circle me-1"></i>Opt-Ins
                          </button>
                        </li>
                      </ul>

                      <!-- Accessibility Content Area -->
                      <div id="accessibilityContent">
                        <div class="text-center p-5">
                          <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                          </div>
                          <p class="mt-3 text-muted">Initializing SMS/USSD module...</p>
                          <button class="btn btn-primary mt-3" onclick="if(window.adminAccessibility) { window.adminAccessibility.init(); } else { alert('AdminAccessibility not found'); }">
                            <i class="bi bi-arrow-clockwise me-1"></i>Initialize SMS/USSD
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>


        <!-- Role-Based Navigation Tabs -->
        <div class="nav-tabs-modern" id="mainNavigationTabs" style="display: none;">
          <!-- Student Navigation -->
          <ul class="nav nav-pills justify-content-center student-only" id="studentTabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="dashboard-tab" data-bs-toggle="tab" data-bs-target="#dashboard-content" type="button" role="tab">
                <i class="bi bi-speedometer2 me-2"></i><span data-translate="nav" data-translate-key="dashboard">Dashboard</span>
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="lessons-tab" data-bs-toggle="tab" data-bs-target="#lessons-content" type="button" role="tab">
                <i class="bi bi-book me-2"></i><span data-translate="nav" data-translate-key="lessons">Lessons</span>
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="library-tab" data-bs-toggle="tab" data-bs-target="#library-content" type="button" role="tab">
                <i class="bi bi-collection me-2"></i><span data-translate="nav" data-translate-key="library">Digital Library</span>
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="progress-tab" data-bs-toggle="tab" data-bs-target="#progress-content" type="button" role="tab">
                <i class="bi bi-graph-up me-2"></i>Progress
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="practice-tab" data-bs-toggle="tab" data-bs-target="#practice-content" type="button" role="tab">
                <i class="bi bi-pencil-square me-2"></i>Practice Materials
              </button>
            </li>
          </ul>


          <!-- Parent Navigation -->
          <ul class="nav nav-pills justify-content-center parent-only" id="parentTabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="parent-dashboard-tab" data-bs-toggle="tab" data-bs-target="#parent-dashboard-content" type="button" role="tab">
                <i class="bi bi-speedometer2 me-2"></i>Dashboard
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="children-tab" data-bs-toggle="tab" data-bs-target="#children-content" type="button" role="tab">
                <i class="bi bi-person-heart me-2"></i>My Children
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="progress-tab" data-bs-toggle="tab" data-bs-target="#progress-content" type="button" role="tab">
                <i class="bi bi-graph-up me-2"></i>Progress Reports
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="communication-tab" data-bs-toggle="tab" data-bs-target="#communication-content" type="button" role="tab">
                <i class="bi bi-chat-dots me-2"></i>Communication
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="support-tab" data-bs-toggle="tab" data-bs-target="#support-content" type="button" role="tab">
                <i class="bi bi-question-circle me-2"></i>Support
              </button>
            </li>
          </ul>

        </div>
      </div>
    </section>

    <!-- Main Content -->
    <main class="container-fluid py-4">

      <!-- Tab Content -->
      <div class="tab-content" id="mainTabContent">
        
        <!-- Dashboard Content -->
        <div class="tab-pane fade show active" id="dashboard-content" role="tabpanel">
          <div class="row g-4">
            <!-- Getting Started Section -->
            <div class="col-lg-6">
              <div class="modern-card">
                <div class="card-header-modern">
                  <h5 class="card-title-modern" data-translate="gettingStarted" data-translate-key="title">Getting Started</h5>
                </div>
                <div class="card-body">
                  <div class="getting-started-list">
                    <div class="step-item">
                      <div class="step-number">1</div>
                      <div class="step-content">
                        <h6 data-translate="gettingStarted" data-translate-key="step1">Choose Your Role & Login</h6>
                        <p class="small text-muted mb-2" data-translate="gettingStarted" data-translate-key="step1Desc">Select your role and login with demo credentials to access your personalized dashboard</p>
                        <button class="btn btn-primary btn-sm" onclick="showLoginModal()">
                          <i class="bi bi-person-plus me-1"></i><span data-translate="gettingStarted" data-translate-key="login">Login</span>
                        </button>
                      </div>
                    </div>
                    <div class="step-item">
                      <div class="step-number">2</div>
                      <div class="step-content">
                        <h6 data-translate="gettingStarted" data-translate-key="step2">Access Content</h6>
                        <p class="small text-muted mb-0" data-translate="gettingStarted" data-translate-key="step2Desc">Browse lessons, books, and practice materials</p>
                      </div>
                    </div>
                    <div class="step-item">
                      <div class="step-number">3</div>
                      <div class="step-content">
                        <h6 data-translate="gettingStarted" data-translate-key="step3">Track Progress</h6>
                        <p class="small text-muted mb-0" data-translate="gettingStarted" data-translate-key="step3Desc">Monitor your learning journey and achievements</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Platform Features Section -->
            <div class="col-lg-6">
              <div class="modern-card">
                <div class="card-header-modern">
                  <h5 class="card-title-modern" data-translate="dashboard" data-translate-key="platformFeatures">Platform Features</h5>
                </div>
                <div class="card-body">
                  <div class="features-list">
                    <div class="feature-item">
                      <div class="feature-icon-small">
                        <i class="bi bi-gear-fill"></i>
                      </div>
                      <div class="feature-content">
                        <h6 data-translate="dashboard" data-translate-key="adaptiveLearning">Adaptive Learning</h6>
                        <p class="small text-muted mb-0" data-translate="dashboard" data-translate-key="adaptiveLearningDesc">Personalized difficulty adjustment</p>
                      </div>
                    </div>
                    <div class="feature-item">
                      <div class="feature-icon-small">
                        <i class="bi bi-wifi-off"></i>
                      </div>
                      <div class="feature-content">
                        <h6 data-translate="dashboard" data-translate-key="offlineSupport">Offline Support</h6>
                        <p class="small text-muted mb-0" data-translate="dashboard" data-translate-key="offlineSupportDesc">Learn without internet connection</p>
                      </div>
                    </div>
                    <div class="feature-item">
                      <div class="feature-icon-small">
                        <i class="bi bi-chat-dots-fill"></i>
                      </div>
                      <div class="feature-content">
                        <h6 data-translate="dashboard" data-translate-key="smsLearning">SMS Learning</h6>
                        <p class="small text-muted mb-0" data-translate="dashboard" data-translate-key="smsLearningDesc">Learn via text messages</p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- AQE Introduction -->
            <div class="col-12">
              <div class="aqe-intro">
                <h2 class="aqe-title" data-translate="dashboard" data-translate-key="aqeTitle">Accessible Quality Education</h2>
                <p class="aqe-description" data-translate="dashboard" data-translate-key="aqeDescription">Accessible Quality Education is your gateway to personalized learning experiences. Choose your role in the 'Getting Started' tab to begin your educational journey.</p>
              </div>
            </div>

            <!-- Role Cards -->
            <div class="col-12">
              <div class="row g-4">
                <div class="col-md-6 col-lg-3">
                  <div class="role-card students">
                    <div class="role-icon">
                      <i class="bi bi-mortarboard-fill"></i>
                    </div>
                    <h6 data-translate="roleCards" data-translate-key="forStudents">For Students</h6>
                    <p class="small mb-0" data-translate="roleCards" data-translate-key="forStudentsDesc">Access lessons, track progress, and earn badges as you learn.</p>
                  </div>
                </div>
                <div class="col-md-6 col-lg-3">
                  <div class="role-card teachers">
                    <div class="role-icon">
                      <i class="bi bi-easel-fill"></i>
                    </div>
                    <h6 data-translate="roleCards" data-translate-key="forTeachers">For Teachers</h6>
                    <p class="small mb-0" data-translate="roleCards" data-translate-key="forTeachersDesc">Create assignments and monitor student progress effectively.</p>
                  </div>
                </div>
                <div class="col-md-6 col-lg-3">
                  <div class="role-card parents">
                    <div class="role-icon">
                      <i class="bi bi-heart-fill"></i>
                    </div>
                    <h6 data-translate="roleCards" data-translate-key="forParents">For Parents</h6>
                    <p class="small mb-0" data-translate="roleCards" data-translate-key="forParentsDesc">Support your child's learning journey with progress insights.</p>
                  </div>
                </div>
                <div class="col-md-6 col-lg-3">
                  <div class="role-card admins">
                    <div class="role-icon">
                      <i class="bi bi-shield-fill-check"></i>
                    </div>
                    <h6 data-translate="roleCards" data-translate-key="forAdmins">For Admins</h6>
                    <p class="small mb-0" data-translate="roleCards" data-translate-key="forAdminsDesc">Manage content, users, and system settings.</p>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Lessons Content -->
        <div class="tab-pane fade" id="lessons-content" role="tabpanel">
          <div class="row g-4">
            <div class="col-12">
              <div class="card">
                <div class="card-header">
                  <h5 class="card-title mb-0">Available Lessons</h5>
                </div>
                <div class="card-body">
                  <div class="row g-3" id="lessonsGrid">
                    <!-- Lessons will be populated here -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Library Content -->
        <div class="tab-pane fade" id="library-content" role="tabpanel">
          <div class="row g-4">
            <!-- Library Stats -->
            <div class="col-md-4">
              <div class="card text-center">
                <div class="card-body">
                  <i class="bi bi-book-fill text-primary fs-1 mb-2"></i>
                  <h3 class="card-title" id="totalBooks">0</h3>
                  <p class="card-text text-muted">Total Books</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="card text-center">
                <div class="card-body">
                  <i class="bi bi-check-circle-fill text-success fs-1 mb-2"></i>
                  <h3 class="card-title" id="booksRead">0</h3>
                  <p class="card-text text-muted">Books Read</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="card text-center">
                <div class="card-body">
                  <i class="bi bi-clock-fill text-warning fs-1 mb-2"></i>
                  <h3 class="card-title" id="readingTime">0h</h3>
                  <p class="card-text text-muted">Reading Time</p>
                </div>
              </div>
            </div>

            <!-- Library Search -->
            <div class="col-12">
              <div class="card">
                <div class="card-body">
                  <div class="input-group mb-3">
                    <input type="text" class="form-control" placeholder="Search books by title, author, or subject..." id="librarySearch">
                    <button class="btn btn-outline-secondary" type="button">
                      <i class="bi bi-search"></i>
                    </button>
                  </div>
                  <div class="row g-3" id="libraryGrid">
                    <!-- Library items will be populated here -->
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Progress Content -->
        <div class="tab-pane fade" id="progress-content" role="tabpanel">
          <div class="row g-4">
            <div class="col-12">
              <div class="card">
                <div class="card-header">
                  <h5 class="card-title mb-0">Learning Progress</h5>
                </div>
                <div class="card-body">
                  <p class="card-text">Track your learning progress and achievements here.</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Practice Materials Content -->
        <div class="tab-pane fade" id="practice-content" role="tabpanel">
          <div class="row g-4">
            <div class="col-12">
              <div class="modern-card">
                <div class="card-header-modern">
                  <h5 class="card-title-modern">Assigned Practice Materials</h5>
                  <p class="card-subtitle-modern">Complete practice exercises assigned by your teacher</p>
                </div>
                <div class="card-body">
                  <div id="studentPracticeMaterialsList">
                    <div class="text-center text-muted py-4">
                      <i class="bi bi-clipboard-check" style="font-size: 3rem;"></i>
                      <p class="mt-3 mb-0">Loading practice materials...</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Admin Content -->
        <div class="tab-pane fade" id="admin-content" role="tabpanel">
          <div class="row g-4">
            <div class="col-12">
              <div class="card">
                <div class="card-header">
                  <h5 class="card-title mb-0">Admin Panel</h5>
                </div>
                <div class="card-body">
                  <p class="card-text">Admin functionality will be implemented here.</p>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </main>

    <!-- Premium Plans Section - Removed: Now handled by centralized AdPlacement system -->

    <!-- Institutional Licensing Section -->
    <section class="institutional-section">
      <div class="container-fluid">
        <div class="row mb-5">
          <div class="col-12 text-center">
            <h3 class="section-title-modern">Institutional Solutions</h3>
            <p class="section-subtitle-modern">Empower your entire school or district with comprehensive educational tools and analytics</p>
          </div>
        </div>
        <div class="institutional-grid">
          <div class="institutional-card">
            <div class="institutional-icon text-primary">
              <i class="bi bi-mortarboard-fill"></i>
            </div>
            <h5>Small School</h5>
            <div class="institutional-price">$300<small>/year</small></div>
            <p class="text-muted mb-3">Up to 200 students</p>
            <ul class="feature-list mb-4">
              <li><i class="bi bi-check-circle-fill"></i> Full platform access</li>
              <li><i class="bi bi-check-circle-fill"></i> Classroom management tools</li>
              <li><i class="bi bi-check-circle-fill"></i> Basic analytics dashboard</li>
              <li><i class="bi bi-check-circle-fill"></i> Email support</li>
            </ul>
            <button class="btn btn-primary-modern w-100" onclick="showLicensingModal('small_school')">
              Get Started
            </button>
          </div>

          <div class="institutional-card featured">
            <span class="featured-badge">Most Popular</span>
            <div class="institutional-icon text-primary">
              <i class="bi bi-building"></i>
            </div>
            <h5>District License</h5>
            <div class="institutional-price">$500<small>/year</small></div>
            <p class="text-muted mb-3">Up to 500 students</p>
            <ul class="feature-list mb-4">
              <li><i class="bi bi-check-circle-fill"></i> Everything in Small School</li>
              <li><i class="bi bi-check-circle-fill"></i> Advanced analytics dashboard</li>
              <li><i class="bi bi-check-circle-fill"></i> Assessment exports & reports</li>
              <li><i class="bi bi-check-circle-fill"></i> Priority support</li>
              <li><i class="bi bi-check-circle-fill"></i> Custom branding</li>
            </ul>
            <button class="btn btn-primary-modern w-100" onclick="showLicensingModal('district')">
              Get Started
            </button>
          </div>

          <div class="institutional-card">
            <div class="institutional-icon text-primary">
              <i class="bi bi-buildings"></i>
            </div>
            <h5>Enterprise</h5>
            <div class="institutional-price">$1,000<small>/year</small></div>
            <p class="text-muted mb-3">Unlimited students</p>
            <ul class="feature-list mb-4">
              <li><i class="bi bi-check-circle-fill"></i> Everything in District</li>
              <li><i class="bi bi-check-circle-fill"></i> Multi-school management</li>
              <li><i class="bi bi-check-circle-fill"></i> API access & integrations</li>
              <li><i class="bi bi-check-circle-fill"></i> Dedicated account manager</li>
              <li><i class="bi bi-check-circle-fill"></i> Custom integrations</li>
              <li><i class="bi bi-check-circle-fill"></i> On-site training</li>
            </ul>
            <button class="btn btn-outline-primary w-100 btn-modern" onclick="showLicensingModal('enterprise')">
              Contact Sales
            </button>
          </div>
        </div>
      </div>
    </section>

    <!-- Professional Development Section -->
    <section class="certification-section">
      <div class="container-fluid">
        <div class="row mb-5">
          <div class="col-12 text-center">
            <h3 class="section-title-modern">Professional Development</h3>
            <p class="section-subtitle-modern">Earn recognized certifications to advance your teaching career and enhance your professional credentials</p>
          </div>
        </div>
        <div class="row g-4">
          <div class="col-md-4">
            <div class="cert-card">
              <div class="cert-icon bg-primary text-white">
                <i class="bi bi-mortarboard-fill"></i>
              </div>
              <div class="cert-title">Teacher Proficiency Certificate</div>
              <div class="cert-price text-primary">$25</div>
              <p class="text-muted small mb-3">Master modern teaching methods and student engagement strategies</p>
              <ul class="cert-features">
                <li><i class="bi bi-check-circle-fill"></i> 5 professional development modules</li>
                <li><i class="bi bi-check-circle-fill"></i> Digital badge for your profile</li>
                <li><i class="bi bi-check-circle-fill"></i> Certificate of completion</li>
                <li><i class="bi bi-check-circle-fill"></i> CE credits</li>
              </ul>
              <button class="btn btn-primary-modern w-100 mt-3" onclick="supportManager.purchaseCertification('teacher_proficiency', 25)">
                Enroll Now
              </button>
            </div>
          </div>
          <div class="col-md-4">
            <div class="cert-card">
              <div class="cert-icon bg-success text-white">
                <i class="bi bi-bookmark-star-fill"></i>
              </div>
              <div class="cert-title">Homeschool Mastery</div>
              <div class="cert-price text-success">$50</div>
              <p class="text-muted small mb-3">Comprehensive certification for homeschool parents and educators</p>
              <ul class="cert-features">
                <li><i class="bi bi-check-circle-fill"></i> 10 comprehensive modules</li>
                <li><i class="bi bi-check-circle-fill"></i> Advanced curriculum planning</li>
                <li><i class="bi bi-check-circle-fill"></i> Assessment strategies</li>
                <li><i class="bi bi-check-circle-fill"></i> Verification badge</li>
              </ul>
              <button class="btn btn-primary-modern w-100 mt-3" onclick="supportManager.purchaseCertification('homeschool_mastery', 50)">
                Enroll Now
              </button>
            </div>
          </div>
          <div class="col-md-4">
            <div class="cert-card">
              <div class="cert-icon bg-warning text-white">
                <i class="bi bi-trophy-fill"></i>
              </div>
              <div class="cert-title">Special Education Specialist</div>
              <div class="cert-price text-warning">$50</div>
              <p class="text-muted small mb-3">Specialized training for inclusive and special needs education</p>
              <ul class="cert-features">
                <li><i class="bi bi-check-circle-fill"></i> 8 specialized modules</li>
                <li><i class="bi bi-check-circle-fill"></i> Adaptive learning strategies</li>
                <li><i class="bi bi-check-circle-fill"></i> IEP development skills</li>
                <li><i class="bi bi-check-circle-fill"></i> Professional recognition</li>
              </ul>
              <button class="btn btn-primary-modern w-100 mt-3" onclick="supportManager.purchaseCertification('special_education', 50)">
                Enroll Now
              </button>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Footer -->
    <footer class="footer-modern">
      <div class="container-fluid">
        <div class="row align-items-center">
          <div class="col-md-6">
            <p class="mb-0" data-translate="footer" data-translate-key="copyright">&copy; 2025 Accessible Quality Education. All rights reserved.</p>
          </div>
          <div class="col-md-6 text-md-end">
            <div class="footer-links">
              <a href="privacy.html" class="footer-link" data-translate="footer" data-translate-key="privacy">
                <i class="bi bi-shield-lock me-1"></i>Privacy Policy
              </a>
              <a href="terms.html" class="footer-link" data-translate="footer" data-translate-key="terms">
                <i class="bi bi-file-text me-1"></i>Terms of Service
              </a>
              <a href="support.html" class="footer-link" data-translate="footer" data-translate-key="support">
                <i class="bi bi-headset me-1"></i>Support
              </a>
            </div>
          </div>
        </div>
        <div class="row mt-3">
          <div class="col-12 text-center">
            <p class="text-muted mb-0 small">AQE Platform - Empowering accessible education for all</p>
          </div>
        </div>
      </div>
    </footer>
  </div>

  <!-- Login Modal -->
  <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="loginModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="loginModalLabel">
            <i class="bi bi-person-plus me-2"></i><span data-translate="authModal" data-translate-key="loginAndRegistration">Login & Registration</span>
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- Login/Registration Tabs -->
          <ul class="nav nav-pills mb-3" id="authTabs" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link active" id="login-tab" data-bs-toggle="pill" data-bs-target="#login-pane" type="button" role="tab" aria-controls="login-pane" aria-selected="true">
                <i class="bi bi-box-arrow-in-right me-2"></i><span data-translate="authModal" data-translate-key="loginTab">Login</span>
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link" id="register-tab" data-bs-toggle="pill" data-bs-target="#register-pane" type="button" role="tab" aria-controls="register-pane" aria-selected="false">
                <i class="bi bi-person-plus me-2"></i><span data-translate="authModal" data-translate-key="registerTab">Register</span>
              </button>
            </li>
          </ul>
          
          <!-- Tab Content -->
          <div class="tab-content" id="authTabContent">
            <!-- Login Tab -->
            <div class="tab-pane fade show active" id="login-pane" role="tabpanel" aria-labelledby="login-tab">
          <div class="row">
            <!-- Role Selection -->
            <div class="col-md-6">
              <h6 class="mb-3">Select Your Role</h6>
              <div class="role-selection">
                <div class="row g-2">
                  <div class="col-6">
                    <div class="role-option-card-small" onclick="selectLoginRole('student')" id="role-student">
                      <div class="role-option-icon-small students">
                        <i class="bi bi-mortarboard-fill"></i>
                      </div>
                      <h6 class="mb-1">Student</h6>
                      <p class="small text-muted mb-0">Access lessons & track progress</p>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="role-option-card-small" onclick="selectLoginRole('teacher')" id="role-teacher">
                      <div class="role-option-icon-small teachers">
                        <i class="bi bi-easel-fill"></i>
                      </div>
                      <h6 class="mb-1">Teacher</h6>
                      <p class="small text-muted mb-0">Create assignments & monitor students</p>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="role-option-card-small" onclick="selectLoginRole('parent')" id="role-parent">
                      <div class="role-option-icon-small parents">
                        <i class="bi bi-heart-fill"></i>
                      </div>
                      <h6 class="mb-1">Parent</h6>
                      <p class="small text-muted mb-0">Support your child's learning</p>
                    </div>
                  </div>
                  <div class="col-6">
                    <div class="role-option-card-small" onclick="selectLoginRole('admin')" id="role-admin">
                      <div class="role-option-icon-small admins">
                        <i class="bi bi-shield-fill-check"></i>
                      </div>
                      <h6 class="mb-1">Admin</h6>
                      <p class="small text-muted mb-0">Manage content & system settings</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <!-- Login Form -->
            <div class="col-md-6">
              <h6 class="mb-3" data-translate="authModal" data-translate-key="loginCredentials">Login Credentials</h6>
              <form id="loginForm">
                <!-- Student Type Selection (only shown when student role is selected) -->
                <div class="mb-3" id="studentTypeSelection" style="display: none;">
                  <label class="form-label">Student Type</label>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="studentType" id="independentStudent" value="independent" checked>
                    <label class="form-check-label" for="independentStudent">
                      Independent Student (Email & Password)
                    </label>
                  </div>
                  <div class="form-check">
                    <input class="form-check-input" type="radio" name="studentType" id="classStudent" value="class">
                    <label class="form-check-label" for="classStudent">
                      Class Student (Name & Access Code)
                    </label>
                  </div>
                </div>
                
                <!-- Email/Name Field -->
                <div class="mb-3">
                  <label for="loginEmail" class="form-label" id="loginEmailLabel">Email</label>
                  <input type="text" class="form-control" id="loginEmail" placeholder="Select a role first" disabled required>
                  <div class="invalid-feedback" id="emailError"></div>
                </div>
                
                <!-- Password/Access Code Field -->
                <div class="mb-3">
                  <label for="loginPassword" class="form-label" id="loginPasswordLabel">Password</label>
                  <input type="password" class="form-control" id="loginPassword" placeholder="Select a role first" disabled minlength="8" required>
                  <div class="invalid-feedback" id="passwordError"></div>
                  <div class="form-text" id="passwordHelpText">Please select a role first</div>
                </div>
                
                <div class="mb-3">
                  <button type="submit" class="btn btn-primary w-100" id="loginBtn" disabled>
                    <i class="bi bi-box-arrow-in-right me-2"></i><span data-translate="authModal" data-translate-key="loginButton">Login</span>
                  </button>
                </div>
              </form>
              
            </div>
          </div>
            </div>
            
            <!-- Registration Tab -->
            <div class="tab-pane fade" id="register-pane" role="tabpanel" aria-labelledby="register-tab">
              <div class="row">
                <!-- Registration Role Selection -->
                <div class="col-md-6">
                  <h6 class="mb-3" data-translate="authModal" data-translate-key="selectRoleToRegister">Select Role to Register</h6>
                  <div class="role-selection">
                    <div class="row g-2">
                      <div class="col-6">
                        <div class="role-option-card-small" onclick="selectRegisterRole('student')" id="register-role-student">
                          <div class="role-option-icon-small students">
                            <i class="bi bi-mortarboard-fill"></i>
                          </div>
                          <h6 class="mb-1">Student</h6>
                          <p class="small text-muted mb-0">Independent learner</p>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="role-option-card-small" onclick="selectRegisterRole('teacher')" id="register-role-teacher">
                          <div class="role-option-icon-small teachers">
                            <i class="bi bi-easel-fill"></i>
                          </div>
                          <h6 class="mb-1">Teacher</h6>
                          <p class="small text-muted mb-0">Create & manage classes</p>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="role-option-card-small" onclick="selectRegisterRole('parent')" id="register-role-parent">
                          <div class="role-option-icon-small parents">
                            <i class="bi bi-heart-fill"></i>
                          </div>
                          <h6 class="mb-1">Parent</h6>
                          <p class="small text-muted mb-0">Support your child</p>
                        </div>
                      </div>
                      <div class="col-6">
                        <div class="role-option-card-small" onclick="selectRegisterRole('admin')" id="register-role-admin">
                          <div class="role-option-icon-small admins">
                            <i class="bi bi-shield-fill-check"></i>
                          </div>
                          <h6 class="mb-1">Admin</h6>
                          <p class="small text-muted mb-0">System administrator</p>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Registration Form -->
                <div class="col-md-6">
                  <h6 class="mb-3">Registration Details</h6>
                  <form id="registerForm">
                    <!-- Student Registration -->
                    <div id="student-registration" class="registration-form" style="display: none;">
                      <div class="mb-3">
                        <label for="studentName" class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="studentName" placeholder="Select a role first" disabled required>
                      </div>
                      <div class="mb-3">
                        <label for="studentEmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="studentEmail" placeholder="Select a role first" disabled required>
                      </div>
                      <div class="mb-3">
                        <label for="studentPassword" class="form-label">Password</label>
                        <input type="password" class="form-control" id="studentPassword" placeholder="Select a role first" disabled minlength="8" required>
                      </div>
                      <div class="mb-3">
                        <label for="studentGradeLevel" class="form-label">Grade Level</label>
                        <select class="form-select" id="studentGradeLevel" disabled required>
                          <option value="">Select a role first</option>
                          <option value="Kindergarten">Kindergarten</option>
                          <option value="1st Grade">1st Grade</option>
                          <option value="2nd Grade">2nd Grade</option>
                          <option value="3rd Grade">3rd Grade</option>
                          <option value="4th Grade">4th Grade</option>
                          <option value="5th Grade">5th Grade</option>
                          <option value="6th Grade">6th Grade</option>
                          <option value="7th Grade">7th Grade</option>
                          <option value="8th Grade">8th Grade</option>
                        </select>
                      </div>
                    </div>
                    
                    <!-- Teacher Registration -->
                    <div id="teacher-registration" class="registration-form" style="display: none;">
                      <div class="mb-3">
                        <label for="teacherName" class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="teacherName" placeholder="Select a role first" disabled required>
                      </div>
                      <div class="mb-3">
                        <label for="teacherEmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="teacherEmail" placeholder="Select a role first" disabled required>
                      </div>
                      <div class="mb-3">
                        <label for="teacherPassword" class="form-label">Password</label>
                        <input type="password" class="form-control" id="teacherPassword" placeholder="Select a role first" disabled minlength="8" required>
                      </div>
                      <div class="mb-3">
                        <label for="teacherGradeLevel" class="form-label">Grade Level Taught</label>
                        <select class="form-select" id="teacherGradeLevel" disabled required>
                          <option value="">Select a role first</option>
                          <option value="Kindergarten">Kindergarten</option>
                          <option value="1st Grade">1st Grade</option>
                          <option value="2nd Grade">2nd Grade</option>
                          <option value="3rd Grade">3rd Grade</option>
                          <option value="4th Grade">4th Grade</option>
                          <option value="5th Grade">5th Grade</option>
                          <option value="6th Grade">6th Grade</option>
                          <option value="7th Grade">7th Grade</option>
                          <option value="8th Grade">8th Grade</option>
                        </select>
                        <div class="form-text">This site is a supplementary learning tool - you can assign lessons from multiple subjects</div>
                      </div>
                    </div>
                    
                    <!-- Parent Registration -->
                    <div id="parent-registration" class="registration-form" style="display: none;">
                      <div class="mb-3">
                        <label for="parentName" class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="parentName" placeholder="Select a role first" disabled required>
                      </div>
                      <div class="mb-3">
                        <label for="parentEmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="parentEmail" placeholder="Select a role first" disabled required>
                      </div>
                      <div class="mb-3">
                        <label for="parentPassword" class="form-label">Password</label>
                        <input type="password" class="form-control" id="parentPassword" placeholder="Select a role first" disabled minlength="8" required>
                      </div>
                      <div id="children-section">
                        <h6 class="mb-3">Add Your Children</h6>
                        <div id="children-list"></div>
                        <button type="button" class="btn btn-outline-primary btn-sm" onclick="addChildField()">
                          <i class="bi bi-plus me-1"></i>Add Child
                        </button>
                      </div>
                    </div>
                    
                    <!-- Admin Registration -->
                    <div id="admin-registration" class="registration-form" style="display: none;">
                      <div class="mb-3">
                        <label for="adminName" class="form-label">Full Name</label>
                        <input type="text" class="form-control" id="adminName" placeholder="Enter your full name" required>
                      </div>
                      <div class="mb-3">
                        <label for="adminEmail" class="form-label">Email</label>
                        <input type="email" class="form-control" id="adminEmail" placeholder="Enter your email" required>
                      </div>
                      <div class="mb-3">
                        <label for="adminPassword" class="form-label">Password</label>
                        <input type="password" class="form-control" id="adminPassword" placeholder="Enter your password" minlength="8" required>
                      </div>
                      <div class="mb-3">
                        <label for="adminSecretPassword" class="form-label">Admin Secret Password</label>
                        <input type="password" class="form-control" id="adminSecretPassword" placeholder="Enter admin secret password" required>
                        <div class="form-text">Contact system administrator for the admin secret password</div>
                        <div class="alert alert-info mt-2" role="alert">
                          <small><strong>Developer Note:</strong> The admin secret password is "admin"</small>
                        </div>
                      </div>
                    </div>
                    
                    <div class="mb-3">
                      <button type="submit" class="btn btn-success w-100" id="registerBtn">
                        <i class="bi bi-person-plus me-2"></i><span data-translate="authModal" data-translate-key="registerButton">Register</span>
                      </button>
                    </div>
                  </form>
                </div>
              </div>
            </div>
            
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Demo Accounts Modal -->
  <div class="modal fade" id="demoAccountsModal" tabindex="-1" aria-labelledby="demoAccountsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="demoAccountsModalLabel">
            <i class="bi bi-table me-2"></i>Demo Accounts
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p class="text-muted mb-3">Use these demo accounts to test the platform. All passwords are 8+ characters long.</p>
          <div class="table-responsive">
            <table class="table table-striped table-hover">
              <thead class="table-dark">
                <tr>
                  <th>Role</th>
                  <th>Name</th>
                  <th>Email</th>
                  <th>Password</th>
                  <th>Additional Info</th>
                </tr>
              </thead>
              <tbody id="demoAccountsTable">
                <!-- Demo accounts will be populated here -->
              </tbody>
            </table>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Add Student Modal -->
  <div class="modal fade" id="addStudentModal" tabindex="-1" aria-labelledby="addStudentModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addStudentModalLabel">Add New Student</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="addStudentForm">
            <div class="mb-3">
              <label for="addStudentName" class="form-label">Student Name</label>
              <input type="text" class="form-control" id="addStudentName" required>
            </div>
            <div class="mb-3">
              <label for="addStudentGradeLevel" class="form-label">Grade Level</label>
              <select class="form-select" id="addStudentGradeLevel" required>
                <option value="">Select Grade Level</option>
                <option value="Kindergarten">Kindergarten</option>
                <option value="1st Grade">1st Grade</option>
                <option value="2nd Grade">2nd Grade</option>
                <option value="3rd Grade">3rd Grade</option>
                <option value="4th Grade">4th Grade</option>
                <option value="5th Grade">5th Grade</option>
                <option value="6th Grade">6th Grade</option>
                <option value="7th Grade">7th Grade</option>
                <option value="8th Grade">8th Grade</option>
              </select>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="addStudent()">Add Student</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Assign Material Modal -->
  <div class="modal fade" id="assignMaterialModal" tabindex="-1" aria-labelledby="assignMaterialModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="assignMaterialModalLabel">Assign Material</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="assignMaterialForm">
            <div class="mb-3">
              <div class="form-check">
                <input class="form-check-input" type="checkbox" id="assignToAllStudents" onchange="toggleStudentSelection()">
                <label class="form-check-label" for="assignToAllStudents">
                  Assign to all students
                </label>
              </div>
            </div>
            <div class="mb-3" id="studentSelectionContainer">
              <label class="form-label">Select Students</label>
              <div id="studentCheckboxes">
                <!-- Student checkboxes will be populated here -->
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="assignMaterial()">Assign Material</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Lesson Preview Modal -->
  <div class="modal fade" id="lessonPreviewModal" tabindex="-1" aria-labelledby="lessonPreviewModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="lessonPreviewModalLabel">Lesson Preview</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="row mb-3">
            <div class="col-md-6">
              <strong>Subject:</strong> <span id="lessonPreviewSubject"></span>
            </div>
            <div class="col-md-6">
              <strong>Grade Level:</strong> <span id="lessonPreviewGradeLevel"></span>
            </div>
          </div>
          <div class="mb-3">
            <h6>Content Preview:</h6>
            <div id="lessonPreviewContent" class="border p-3 rounded" style="max-height: 300px; overflow-y: auto;"></div>
          </div>
          <div id="lessonPreviewResourceUrl" style="display: none;">
            <a href="#" target="_blank" class="btn btn-outline-primary">
              <i class="bi bi-link-45deg me-2"></i>View Resource
            </a>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" id="checkoutLessonBtn">Check Out Lesson</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Lesson Completion Modal -->
  <div class="modal fade" id="lessonCompletionModal" tabindex="-1" aria-labelledby="lessonCompletionModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="lessonCompletionModalLabel">Complete Lesson</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="lessonCompletionForm">
            <div class="mb-3">
              <label for="lessonScore" class="form-label">Score</label>
              <input type="number" class="form-control" id="lessonScore" min="0" max="100" required>
              <div class="form-text">Enter your score (0-100)</div>
            </div>
            <div class="mb-3">
              <label for="lessonTotalQuestions" class="form-label">Total Questions</label>
              <input type="number" class="form-control" id="lessonTotalQuestions" min="1" required>
            </div>
            <div class="mb-3">
              <label for="lessonCorrectAnswers" class="form-label">Correct Answers</label>
              <input type="number" class="form-control" id="lessonCorrectAnswers" min="0" required>
            </div>
            <div class="mb-3">
              <label for="lessonStudentNotes" class="form-label">Notes (Optional)</label>
              <textarea class="form-control" id="lessonStudentNotes" rows="3" placeholder="Add any notes about this lesson..."></textarea>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-success" id="completeLessonBtn">Complete Lesson</button>
        </div>
      </div>
    </div>
  </div>

  <!-- AI Lesson Generator Modal -->
  <div class="modal fade" id="createLessonModal" tabindex="-1" aria-labelledby="createLessonModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-xl">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title"><i class="bi bi-magic me-2"></i>AI Lesson Generator</h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <!-- Step 1: Configuration -->
          <div id="lessonGenStep1">
            <div class="alert alert-info">
              <i class="bi bi-info-circle me-2"></i>
              Select subjects and grade levels. AI will generate comprehensive lessons with content, questions, and assessments.
            </div>
            
            <div class="row mb-3">
              <div class="col-md-6">
                <label class="form-label fw-bold">Grade Levels</label>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="Kindergarten" id="gradeK">
                  <label class="form-check-label" for="gradeK">Kindergarten</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="1st Grade" id="grade1">
                  <label class="form-check-label" for="grade1">1st Grade</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="2nd Grade" id="grade2">
                  <label class="form-check-label" for="grade2">2nd Grade</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="3rd Grade" id="grade3">
                  <label class="form-check-label" for="grade3">3rd Grade</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="4th Grade" id="grade4">
                  <label class="form-check-label" for="grade4">4th Grade</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="5th Grade" id="grade5">
                  <label class="form-check-label" for="grade5">5th Grade</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="6th Grade" id="grade6">
                  <label class="form-check-label" for="grade6">6th Grade</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="7th Grade" id="grade7">
                  <label class="form-check-label" for="grade7">7th Grade</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="8th Grade" id="grade8">
                  <label class="form-check-label" for="grade8">8th Grade</label>
                </div>
                <button class="btn btn-sm btn-link p-0 mt-2" onclick="selectAllGrades()">Select All</button>
              </div>
              
              <div class="col-md-6">
                <label class="form-label fw-bold">Subjects</label>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="Math" id="subjectMath">
                  <label class="form-check-label" for="subjectMath">Math</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="Science" id="subjectScience">
                  <label class="form-check-label" for="subjectScience">Science</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="English" id="subjectEnglish">
                  <label class="form-check-label" for="subjectEnglish">English</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="Technology" id="subjectTechnology">
                  <label class="form-check-label" for="subjectTechnology">Technology</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" value="Geography" id="subjectGeography">
                  <label class="form-check-label" for="subjectGeography">Geography</label>
                </div>
                <button class="btn btn-sm btn-link p-0 mt-2" onclick="selectAllSubjects()">Select All</button>
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label fw-bold">Difficulty Level</label>
              <select class="form-select" id="lessonDifficulty">
                <option value="Easy">Easy (Scaffolded, step-by-step)</option>
                <option value="Intermediate" selected>Intermediate (Grade-level)</option>
                <option value="Hard">Hard (Multi-step, challenge)</option>
              </select>
            </div>
          </div>

          <!-- Step 2: Generation Progress -->
          <div id="lessonGenStep2" style="display: none;">
            <div class="text-center py-4">
              <div class="spinner-border text-primary mb-3" role="status" style="width: 3rem; height: 3rem;">
                <span class="visually-hidden">Generating...</span>
              </div>
              <h5>AI is generating your lessons...</h5>
              <p class="text-muted">This may take a moment. Please don't close this window.</p>
              <div id="generationProgress" class="mt-3"></div>
            </div>
          </div>

          <!-- Step 3: Review Generated Lessons -->
          <div id="lessonGenStep3" style="display: none;">
            <h6 class="mb-3">Generated Lessons - Review and Edit</h6>
            <div id="generatedLessonsContainer" class="row">
              <!-- Generated lessons will appear here -->
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" id="cancelGenBtn">Cancel</button>
          <button type="button" class="btn btn-primary" id="startGenerationBtn">
            <i class="bi bi-magic me-2"></i>Generate Lessons
          </button>
          <button type="button" class="btn btn-success" id="publishAllBtn" style="display: none;">
            <i class="bi bi-check-circle me-2"></i>Publish All Lessons
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Ask Question Modal -->
  <div class="modal fade" id="askQuestionModal" tabindex="-1" aria-labelledby="askQuestionModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="askQuestionModalLabel">Ask a Question</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="askQuestionForm">
            <div class="mb-3">
              <label for="questionSubject" class="form-label">Subject *</label>
              <input type="text" class="form-control" id="questionSubject" placeholder="Brief description of your question" required>
            </div>
            <div class="mb-3">
              <label for="questionMessage" class="form-label">Your Question *</label>
              <textarea class="form-control" id="questionMessage" rows="6" placeholder="Please provide as much detail as possible about your question or issue..." required></textarea>
            </div>
            <div class="alert alert-info">
              <i class="bi bi-info-circle me-2"></i>
              <strong>Note:</strong> Your question will be sent to our admin team. They will respond as soon as possible, typically within 24 hours.
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" id="submitQuestionBtn">
            <i class="bi bi-send me-1"></i>Submit Question
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Support Modal -->
  <div class="modal fade" id="supportModal" tabindex="-1" aria-labelledby="supportModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header bg-primary text-white">
          <h5 class="modal-title" id="supportModalLabel">
            <i class="bi bi-gift me-2"></i>Support Our Mission
          </h5>
          <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="text-center mb-4">
            <p class="lead">Help us maintain and grow our platform to reach more learners worldwide</p>
          </div>

          <div class="row g-4">
            <!-- Donation Section -->
            <div class="col-12">
              <div class="card h-100">
                <div class="card-body">
                  <h6 class="fw-bold mb-3"><i class="bi bi-gift me-2"></i>Make a Contribution</h6>
                  <div class="d-flex gap-2 mb-3">
                    <button class="btn btn-outline-primary flex-fill" onclick="donateAmount(5)">$5</button>
                    <button class="btn btn-outline-primary flex-fill" onclick="donateAmount(10)">$10</button>
                    <button class="btn btn-outline-primary flex-fill" onclick="donateAmount(25)">$25</button>
                    <button class="btn btn-outline-primary flex-fill" onclick="donateAmount(50)">$50</button>
                  </div>
                  <div class="input-group">
                    <span class="input-group-text">$</span>
                    <input type="number" class="form-control" id="donationAmount" placeholder="Other amount" min="1" step="0.01">
                    <button class="btn btn-primary" onclick="processDonation()">
                      <i class="bi bi-arrow-right me-1"></i>Contribute
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Premium Info - Removed: Now handled by centralized AdPlacement system -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Edit Practice Material Modal -->
  <div class="modal fade" id="editPracticeMaterialModal" tabindex="-1" aria-labelledby="editPracticeMaterialModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="editPracticeMaterialModalLabel">
            <i class="bi bi-pencil-square me-2"></i>Edit Practice Material
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="editPracticeMaterialForm">
            <!-- Basic Information -->
            <div class="row mb-4">
              <div class="col-md-6">
                <label for="editMaterialTitle" class="form-label">Title <span class="text-danger">*</span></label>
                <input type="text" class="form-control" id="editMaterialTitle" required>
              </div>
              <div class="col-md-6">
                <label for="editMaterialSubject" class="form-label">Subject <span class="text-danger">*</span></label>
                <select class="form-select" id="editMaterialSubject" required>
                  <option value="">Select Subject</option>
                  <option value="Science">Science</option>
                  <option value="Technology">Technology</option>
                  <option value="English">English</option>
                  <option value="Math">Math</option>
                  <option value="Geography">Geography</option>
                </select>
              </div>
            </div>

            <div class="mb-4">
              <label for="editMaterialDescription" class="form-label">Description <span class="text-danger">*</span></label>
              <textarea class="form-control" id="editMaterialDescription" rows="3" required></textarea>
            </div>

            <!-- Questions Section -->
            <div class="mb-4">
              <div class="d-flex justify-content-between align-items-center mb-3">
                <h6 class="mb-0">Questions <span class="text-danger">*</span></h6>
                <div class="d-flex align-items-center gap-3">
                  <span class="badge bg-primary" id="editQuestionCount">0 questions</span>
                  <button type="button" class="btn btn-outline-primary btn-sm" onclick="window.app.addEditQuestion()">
                    <i class="bi bi-plus"></i> Add Question
                  </button>
                </div>
              </div>
              <div id="editQuestionsContainer">
                <!-- Questions will be populated here -->
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="window.app.updatePracticeMaterial()">
            <i class="bi bi-check-lg me-2"></i>Update Practice Material
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Generate Lessons Modal -->
  <div class="modal fade" id="generateLessonsModal" tabindex="-1" aria-labelledby="generateLessonsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="generateLessonsModalLabel">
            <i class="bi bi-magic me-2"></i>Generate Lessons
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            <strong>Auto-Generation:</strong> This will generate 2 lessons per subject per grade (Lesson A = easier, Lesson B = moderate). Each lesson contains exactly 5 multiple-choice questions.
          </div>
          
          <form id="generateLessonsForm">
            <div class="row mb-4">
              <div class="col-md-6">
                <label class="form-label">Subjects</label>
                <select class="form-select" id="generateSubjectFilter" multiple>
                  <option value="">All Subjects</option>
                </select>
                <small class="form-text text-muted">Hold Ctrl/Cmd to select multiple subjects</small>
              </div>
              <div class="col-md-6">
                <label class="form-label">Grades</label>
                <select class="form-select" id="generateGradeFilter" multiple>
                  <option value="">All Grades</option>
                </select>
                <small class="form-text text-muted">Hold Ctrl/Cmd to select multiple grades</small>
              </div>
            </div>
            
            <div class="form-check mb-3">
              <input class="form-check-input" type="checkbox" id="dryRunCheck">
              <label class="form-check-label" for="dryRunCheck">
                Dry Run (Preview only - no changes will be saved)
              </label>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="window.app.generateLessons()">
            <i class="bi bi-magic me-2"></i>Generate Lessons
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Publish Lessons Modal -->
  <div class="modal fade" id="publishLessonsModal" tabindex="-1" aria-labelledby="publishLessonsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="publishLessonsModalLabel">
            <i class="bi bi-cloud-upload me-2"></i>Publish Lessons
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="alert alert-warning">
            <i class="bi bi-exclamation-triangle me-2"></i>
            <strong>Publishing:</strong> Selected lessons will be published to the chosen library and made available for assignment.
          </div>
          
          <form id="publishLessonsForm">
            <div class="mb-4">
              <label class="form-label">Target Library</label>
              <select class="form-select" id="publishTargetLibrary" required>
                <option value="">Select Library</option>
                <option value="parent">Parent Library</option>
                <option value="teacher">Teacher Library</option>
              </select>
            </div>
            
            <div class="mb-4">
              <label class="form-label">Selected Lessons</label>
              <div id="selectedLessonsList" class="border rounded p-3" style="max-height: 200px; overflow-y: auto;">
                <p class="text-muted mb-0">No lessons selected</p>
              </div>
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-success" onclick="window.app.publishLessons()">
            <i class="bi bi-cloud-upload me-2"></i>Publish Selected
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Assign Lesson Modal -->
  <div class="modal fade" id="assignLessonModal" tabindex="-1" aria-labelledby="assignLessonModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="assignLessonModalLabel">
            <i class="bi bi-person-plus me-2"></i>Assign Lesson
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            <strong>Assignment:</strong> Select students/children to assign this lesson to. They will be able to access it in their digital library.
          </div>
          
          <form id="assignLessonForm">
            <div class="mb-4">
              <label class="form-label">Lesson Details</label>
              <div class="card bg-light">
                <div class="card-body">
                  <h6 id="assignLessonTitle" class="card-title">Lesson Title</h6>
                  <p id="assignLessonDescription" class="card-text text-muted">Lesson description</p>
                  <div class="row">
                    <div class="col-md-4">
                      <small class="text-muted"><strong>Subject:</strong> <span id="assignLessonSubject">-</span></small>
                    </div>
                    <div class="col-md-4">
                      <small class="text-muted"><strong>Grade:</strong> <span id="assignLessonGrade">-</span></small>
                    </div>
                    <div class="col-md-4">
                      <small class="text-muted"><strong>Difficulty:</strong> <span id="assignLessonDifficulty">-</span></small>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="mb-4">
              <label class="form-label">Assign To</label>
              <div class="border rounded p-3" style="max-height: 300px; overflow-y: auto;">
                <div id="assigneeList">
                  <!-- Students/children will be populated here -->
                </div>
              </div>
            </div>
            
            <div class="mb-4">
              <label for="dueDate" class="form-label">Due Date (Optional)</label>
              <input type="date" class="form-control" id="dueDate" min="">
            </div>
          </form>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
          <button type="button" class="btn btn-primary" onclick="window.app.assignLesson()">
            <i class="bi bi-person-plus me-2"></i>Assign Lesson
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Lesson Player Modal -->
  <div class="modal fade" id="lessonPlayerModal" tabindex="-1" aria-labelledby="lessonPlayerModalLabel" aria-hidden="true" data-bs-backdrop="static" data-bs-keyboard="false">
    <div class="modal-dialog modal-dialog-centered modal-xl">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="lessonPlayerModalLabel">
            <i class="bi bi-play-circle me-2"></i>Lesson Player
          </h5>
          <div class="d-flex align-items-center">
            <span class="badge bg-primary me-2" id="lessonProgress">Question 1 of 5</span>
            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" onclick="window.app.exitLessonPlayer()"></button>
          </div>
        </div>
        <div class="modal-body">
          <!-- Progress Bar -->
          <div class="mb-4">
            <div class="progress" style="height: 8px;">
              <div class="progress-bar" role="progressbar" id="lessonProgressBar" style="width: 0%"></div>
            </div>
          </div>

          <!-- Question Content -->
          <div id="lessonQuestionContent">
            <div class="text-center">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Loading lesson...</span>
              </div>
            </div>
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" id="prevQuestionBtn" onclick="window.app.previousQuestion()" disabled>
            <i class="bi bi-arrow-left me-1"></i>Previous
          </button>
          <button type="button" class="btn btn-primary" id="nextQuestionBtn" onclick="window.app.nextQuestion()">
            Next<i class="bi bi-arrow-right ms-1"></i>
          </button>
          <button type="button" class="btn btn-success d-none" id="submitLessonBtn" onclick="window.app.submitLesson()">
            <i class="bi bi-check-lg me-1"></i>Submit Lesson
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Lesson Results Modal -->
  <div class="modal fade" id="lessonResultsModal" tabindex="-1" aria-labelledby="lessonResultsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="lessonResultsModalLabel">
            <i class="bi bi-trophy me-2"></i>Lesson Complete!
          </h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <div class="text-center mb-4">
            <div class="mb-3">
              <i class="bi bi-check-circle-fill text-success" style="font-size: 4rem;"></i>
            </div>
            <h4 id="lessonScore">Great job!</h4>
            <p class="text-muted">You completed the lesson successfully.</p>
          </div>

          <div class="row g-4 mb-4">
            <div class="col-md-4">
              <div class="card text-center">
                <div class="card-body">
                  <h3 class="text-primary" id="correctAnswers">0</h3>
                  <p class="mb-0">Correct</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="card text-center">
                <div class="card-body">
                  <h3 class="text-danger" id="wrongAnswers">0</h3>
                  <p class="mb-0">Incorrect</p>
                </div>
              </div>
            </div>
            <div class="col-md-4">
              <div class="card text-center">
                <div class="card-body">
                  <h3 class="text-success" id="scorePercentage">0%</h3>
                  <p class="mb-0">Score</p>
                </div>
              </div>
            </div>
          </div>

          <div class="alert alert-info">
            <i class="bi bi-info-circle me-2"></i>
            <strong>Well done!</strong> Your progress has been saved and your teacher/parent will be able to see your results.
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal">
            <i class="bi bi-house me-1"></i>Return to Dashboard
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Bootstrap 5.x JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  
  <!-- Curriculum Tests (Development Only) -->
  <script src="resources/scripts/curriculumTests.js"></script>
  
  <!-- Custom JavaScript -->
  <!-- PWA Scripts (load first) -->
  <script src="resources/scripts/offline-db.js"></script>
  <script src="resources/scripts/pwa.js"></script>
  
  <!-- Application Scripts -->
  <script src="resources/scripts/config.js"></script>
  <script src="resources/config/adPolicy.js"></script>
  <script src="resources/scripts/adPlacement.js"></script>
  <script src="resources/scripts/translations.js"></script>
  <!-- Unified Authentication System -->
  <script src="resources/scripts/auth.js"></script>
  <script src="resources/scripts/loginModal.js"></script>
  <script src="resources/scripts/ui-manager.js"></script>
  <script src="resources/scripts/main.js"></script>
  
  <script src="resources/scripts/admin.js"></script>
  <script src="resources/scripts/admin-accessibility.js"></script>
  <script src="resources/scripts/teacher.js"></script>
  <script src="resources/scripts/student.js"></script>
  <script src="resources/scripts/parent.js"></script>
  <script src="resources/scripts/support.js"></script>
  <script src="resources/scripts/payment.js"></script>
  <script src="resources/scripts/guest-dashboard.js"></script>
  <script src="resources/scripts/connection-system.js"></script>
  <script src="resources/scripts/gamified-lesson.js"></script>
  <script src="resources/scripts/admin-billing.js"></script>
  <script src="resources/scripts/admin-portal.js"></script>
  <script src="resources/scripts/lesson-system.js"></script>
  <script src="resources/scripts/getting-started.js"></script>
  
  <!-- Ad Policy Tests (development only) -->
  <script src="resources/scripts/adPolicyTests.js"></script>
  
  <!-- Authentication Smoke Tests (development only) -->
  <script src="resources/scripts/authSmokeTest.js"></script>
  
  <script>
    // Initialize the application with proper authentication handling
    document.addEventListener('DOMContentLoaded', function() {
      // Scroll to top on page load
      window.scrollTo(0, 0);
      
      // Show loading state to prevent flickering
      showLoadingState();
      
      // Initialize authentication first, then everything else
      initializeApplication();
    });

    async function initializeApplication() {
      try {
        // Auth system is already initialized in auth.js
        // Session hydration happens automatically on construction
        
        // Initialize the main application
        window.app = new AQEPlatform();
        
        // Add a small delay to ensure smooth transition
        await new Promise(resolve => setTimeout(resolve, 100));
        
        // Hide loading state
        hideLoadingState();
        
        // Add test buttons for development
        addTestButtons();
        
      } catch (error) {
        console.error('Error initializing application:', error);
        hideLoadingState();
        // Fallback to guest mode
        if (window.auth) {
          window.auth.updateUI();
        }
      }
    }

    function showLoadingState() {
      // Hide marketing sections during loading to prevent flash
      const marketingSections = document.querySelectorAll('.hero-section, .gettingStarted, .chooseExperience, .institutional-section, .professionalDevelopment');
      marketingSections.forEach(section => {
        section.style.display = 'none';
      });
      
      // Add a loading overlay to prevent flickering
      const loadingOverlay = document.createElement('div');
      loadingOverlay.id = 'loadingOverlay';
      loadingOverlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(255, 255, 255, 0.9);
        z-index: 9999;
        display: flex;
        align-items: center;
        justify-content: center;
      `;
      loadingOverlay.innerHTML = `
        <div class="text-center">
          <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
          </div>
          <div class="mt-2">Loading AQE Platform...</div>
        </div>
      `;
      document.body.appendChild(loadingOverlay);
    }

    function hideLoadingState() {
      const loadingOverlay = document.getElementById('loadingOverlay');
      if (loadingOverlay) {
        loadingOverlay.remove();
      }
    }

    function addTestButtons() {
      if (window.location.hostname === 'localhost' || window.location.hostname === '127.0.0.1') {
        // Test login button
        const testLoginButton = document.createElement('button');
        testLoginButton.innerHTML = 'ðŸ”§ Test Login (Teacher)';
        testLoginButton.className = 'btn btn-warning position-fixed';
        testLoginButton.style.cssText = 'top: 10px; right: 10px; z-index: 9999;';
        testLoginButton.onclick = function() {
          // Simulate teacher login for testing
          const testUser = {
            id: 1,
            name: 'Test Teacher',
            email: 'teacher@test.com',
            role: 'teacher',
            teacherId: 1
          };
          localStorage.setItem('aqe_user', JSON.stringify(testUser));
          window.location.reload(); // Reload to trigger session restoration
        };
        document.body.appendChild(testLoginButton);

        // Test logout button (only show if user is logged in)
        const storedUser = localStorage.getItem('aqe_user');
        if (storedUser) {
          const testLogoutButton = document.createElement('button');
          testLogoutButton.innerHTML = 'ðŸ”§ Test Logout';
          testLogoutButton.className = 'btn btn-danger position-fixed';
          testLogoutButton.style.cssText = 'top: 50px; right: 10px; z-index: 9999;';
          testLogoutButton.onclick = function() {
            localStorage.removeItem('aqe_user');
            window.location.reload();
          };
          document.body.appendChild(testLogoutButton);
        }
      }
    }

    // Scroll to top on page refresh/reload
    window.addEventListener('beforeunload', function() {
      window.scrollTo(0, 0);
    });

    // Also scroll to top when page is fully loaded
    window.addEventListener('load', function() {
      window.scrollTo(0, 0);
    });
  </script>
</body>
</html>