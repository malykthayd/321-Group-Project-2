<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Database Viewer - AQE</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .btn {
            @apply px-4 py-2 rounded-lg font-medium transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2;
        }
        .btn-primary {
            @apply bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500;
        }
        .btn-secondary {
            @apply bg-gray-200 text-gray-900 hover:bg-gray-300 focus:ring-gray-500;
        }
        .card {
            @apply bg-white rounded-lg shadow-sm border border-gray-200 p-6;
        }
        table {
            @apply w-full border-collapse;
        }
        th, td {
            @apply border border-gray-300 px-4 py-2 text-left;
        }
        th {
            @apply bg-gray-100 font-semibold;
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
        <div class="mb-8">
            <h1 class="text-3xl font-bold text-gray-900 mb-4">AQE Database Viewer</h1>
            <p class="text-gray-600">View the SQLite database contents for Accessible Quality Education</p>
        </div>

        <!-- Database Status -->
        <div class="card mb-8">
            <h2 class="text-xl font-semibold text-gray-900 mb-4">Database Status</h2>
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div class="text-center">
                    <div class="text-2xl font-bold text-blue-600" id="userCount">-</div>
                    <div class="text-sm text-gray-600">Users</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-green-600" id="lessonCount">-</div>
                    <div class="text-sm text-gray-600">Lessons</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-purple-600" id="bookCount">-</div>
                    <div class="text-sm text-gray-600">Books</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-orange-600" id="conceptCount">-</div>
                    <div class="text-sm text-gray-600">Concepts</div>
                </div>
            </div>
        </div>

        <!-- Database Tables -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Users Table -->
            <div class="card">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Users</h3>
                <div class="overflow-x-auto">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Email</th>
                                <th>Role</th>
                                <th>Name</th>
                                <th>Language</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable">
                            <tr>
                                <td colspan="5" class="text-center text-gray-500">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Lessons Table -->
            <div class="card">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Lessons</h3>
                <div class="overflow-x-auto">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Title</th>
                                <th>Subject</th>
                                <th>Grade</th>
                                <th>Difficulty</th>
                            </tr>
                        </thead>
                        <tbody id="lessonsTable">
                            <tr>
                                <td colspan="5" class="text-center text-gray-500">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Books Table -->
            <div class="card">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Books</h3>
                <div class="overflow-x-auto">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Title</th>
                                <th>Author</th>
                                <th>Subject</th>
                                <th>Grade</th>
                            </tr>
                        </thead>
                        <tbody id="booksTable">
                            <tr>
                                <td colspan="5" class="text-center text-gray-500">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- Concepts Table -->
            <div class="card">
                <h3 class="text-lg font-semibold text-gray-900 mb-4">Concepts</h3>
                <div class="overflow-x-auto">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Subject</th>
                                <th>Grade</th>
                            </tr>
                        </thead>
                        <tbody id="conceptsTable">
                            <tr>
                                <td colspan="4" class="text-center text-gray-500">Loading...</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Database Actions -->
        <div class="card mt-8">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Database Actions</h3>
            <div class="flex flex-wrap gap-4">
                <button onclick="refreshData()" class="btn btn-primary">
                    Refresh Data
                </button>
                <button onclick="exportData()" class="btn btn-secondary">
                    Export Data
                </button>
                <button onclick="runMigration()" class="btn btn-secondary">
                    Run Migration
                </button>
                <button onclick="runSeeding()" class="btn btn-secondary">
                    Run Seeding
                </button>
            </div>
        </div>

        <!-- Database Info -->
        <div class="card mt-8">
            <h3 class="text-lg font-semibold text-gray-900 mb-4">Database Information</h3>
            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <div>
                    <h4 class="font-semibold text-gray-900 mb-2">Database Location</h4>
                    <p class="text-sm text-gray-600">./data/aqe.db</p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-900 mb-2">Database Type</h4>
                    <p class="text-sm text-gray-600">SQLite 3</p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-900 mb-2">Tables Created</h4>
                    <p class="text-sm text-gray-600">20+ tables including users, lessons, books, concepts, mastery, etc.</p>
                </div>
                <div>
                    <h4 class="font-semibold text-gray-900 mb-2">Features</h4>
                    <p class="text-sm text-gray-600">Foreign keys, indexes, timestamps, role-based access</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mock data for demonstration (in real app, this would fetch from the database)
        const mockData = {
            users: [
                { id: 1, email: 'student@demo.com', role: 'student', name: 'Alex Johnson', language: 'en' },
                { id: 2, email: 'teacher@demo.com', role: 'teacher', name: 'Sarah Williams', language: 'en' },
                { id: 3, email: 'parent@demo.com', role: 'parent', name: 'Michael Johnson', language: 'en' },
                { id: 4, email: 'admin@demo.com', role: 'admin', name: 'Admin User', language: 'en' }
            ],
            lessons: [
                { id: 1, title: 'Introduction to Addition', subject: 'Mathematics', grade: 1, difficulty: 1 },
                { id: 2, title: 'Understanding Fractions', subject: 'Mathematics', grade: 3, difficulty: 2 },
                { id: 3, title: 'Reading Comprehension Basics', subject: 'English', grade: 2, difficulty: 1 },
                { id: 4, title: 'Plant Life Cycle', subject: 'Science', grade: 2, difficulty: 2 }
            ],
            books: [
                { id: 1, title: 'The Magic Tree House', author: 'Mary Pope Osborne', subject: 'English', grade: 2 },
                { id: 2, title: "Charlotte's Web", author: 'E.B. White', subject: 'English', grade: 3 },
                { id: 3, title: 'The Very Hungry Caterpillar', author: 'Eric Carle', subject: 'Science', grade: 1 },
                { id: 4, title: 'Math Curse', author: 'Jon Scieszka', subject: 'Mathematics', grade: 2 }
            ],
            concepts: [
                { id: 1, name: 'Addition', subject: 'Mathematics', grade: 1 },
                { id: 2, name: 'Subtraction', subject: 'Mathematics', grade: 1 },
                { id: 3, name: 'Fractions', subject: 'Mathematics', grade: 3 },
                { id: 4, name: 'Reading Comprehension', subject: 'English', grade: 2 },
                { id: 5, name: 'Plants', subject: 'Science', grade: 2 },
                { id: 6, name: 'Animals', subject: 'Science', grade: 1 }
            ]
        };

        function loadData() {
            // Update counts
            document.getElementById('userCount').textContent = mockData.users.length;
            document.getElementById('lessonCount').textContent = mockData.lessons.length;
            document.getElementById('bookCount').textContent = mockData.books.length;
            document.getElementById('conceptCount').textContent = mockData.concepts.length;

            // Load users table
            const usersTable = document.getElementById('usersTable');
            usersTable.innerHTML = mockData.users.map(user => `
                <tr>
                    <td>${user.id}</td>
                    <td>${user.email}</td>
                    <td><span class="px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs">${user.role}</span></td>
                    <td>${user.name}</td>
                    <td>${user.language}</td>
                </tr>
            `).join('');

            // Load lessons table
            const lessonsTable = document.getElementById('lessonsTable');
            lessonsTable.innerHTML = mockData.lessons.map(lesson => `
                <tr>
                    <td>${lesson.id}</td>
                    <td>${lesson.title}</td>
                    <td>${lesson.subject}</td>
                    <td>Grade ${lesson.grade}</td>
                    <td>Level ${lesson.difficulty}</td>
                </tr>
            `).join('');

            // Load books table
            const booksTable = document.getElementById('booksTable');
            booksTable.innerHTML = mockData.books.map(book => `
                <tr>
                    <td>${book.id}</td>
                    <td>${book.title}</td>
                    <td>${book.author}</td>
                    <td>${book.subject}</td>
                    <td>Grade ${book.grade}</td>
                </tr>
            `).join('');

            // Load concepts table
            const conceptsTable = document.getElementById('conceptsTable');
            conceptsTable.innerHTML = mockData.concepts.map(concept => `
                <tr>
                    <td>${concept.id}</td>
                    <td>${concept.name}</td>
                    <td>${concept.subject}</td>
                    <td>Grade ${concept.grade}</td>
                </tr>
            `).join('');
        }

        function refreshData() {
            loadData();
            alert('Data refreshed!');
        }

        function exportData() {
            const dataStr = JSON.stringify(mockData, null, 2);
            const dataBlob = new Blob([dataStr], {type: 'application/json'});
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'aqe-database-export.json';
            link.click();
            URL.revokeObjectURL(url);
        }

        function runMigration() {
            alert('Migration would run: npm run db:migrate\n\nThis creates all database tables and indexes.');
        }

        function runSeeding() {
            alert('Seeding would run: npm run db:seed\n\nThis populates the database with sample data including demo users, lessons, books, and concepts.');
        }

        // Load data on page load
        document.addEventListener('DOMContentLoaded', loadData);
    </script>
</body>
</html>
